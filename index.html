<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows 10</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400..900&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
    <link rel="icon" href="assets/images/Window 10 Logo.ico" type="image/x-icon">
    <link rel="preload" href="assets/images/avatar.png" as="image">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
        rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Arimo:ital,wght@0,400..700;1,400..700&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@700&display=swap">
    <style>
        body {
            margin: 0;
            font-family: 'Segoe UI', sans-serif;
            height: 100vh;
            overflow: hidden;
            background-color: #111;
        }

        @font-face {
            font-family: 'Segoe UI';
            src: url('assets/fonts/segoeuithis.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        .background-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('assets/images/Default background.png') no-repeat center center;
            background-size: cover;
            display: none;
        }

        .taskbar {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 40px;
            background-color: #1b2d3c;
            display: none;
            align-items: center;
            padding: 0 10px;
            box-sizing: border-box;
            z-index: 10000; /* High value to stay above all windows */
            overflow: hidden;
        }

        .taskbar .windows-icon {
            width: 30px;
            height: 30px;
            background: url('assets/images/Window 10 Logo.svg') no-repeat center center;
            background-size: contain;
            margin-left: 10px;
            filter: invert(0);
            border-radius: 5px;
            cursor: default;
            z-index: 999999999999999999999999999999999;
            position: relative;
            transition: background-color 0.3s ease, width 0.3s ease, height 0.3s ease, padding 0.3s ease;
            box-sizing: border-box;
        }

        .taskbar .windows-icon.active {
            background-color: rgba(255, 255, 255, 0.150);
            padding: 3px;
            border-radius: 7px;
            width: 34px;
            height: 34px;
            background-size: 60%;
        }

        .taskbar .windows-icon:hover {
            filter: invert(42%) sepia(97%) saturate(5472%) hue-rotate(184deg) brightness(97%) contrast(106%);
        }

        .loader-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 99999;
            background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 25%, #0e4c6d 50%, #0078d7 100%);
            opacity: 1;
            transition: opacity 0.5s ease;
            overflow: hidden;
        }

        .loader-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(0, 120, 215, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 50%, rgba(0, 188, 242, 0.1) 0%, transparent 50%);
            animation: gradientShift 10s ease-in-out infinite;
        }

        @keyframes gradientShift {
            0%, 100% {
                opacity: 0.3;
                transform: scale(1);
            }
            50% {
                opacity: 0.6;
                transform: scale(1.1);
            }
        }

        /* Music Wave Curves */
        .music-waves {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.25;
            overflow: hidden;
        }

        .wave-svg {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .wave-path {
            fill: none;
            stroke-width: 2.5;
            opacity: 0.8;
            transform-origin: center;
        }

        .wave-path-1 {
            stroke: #0078d7;
            filter: blur(1px);
            animation: waveMove1 4s ease-in-out infinite;
        }

        .wave-path-2 {
            stroke: #00bcf2;
            filter: blur(1px);
            animation: waveMove2 5s ease-in-out infinite;
            animation-delay: 0.8s;
        }

        .wave-path-3 {
            stroke: #00d4ff;
            filter: blur(1px);
            animation: waveMove3 6s ease-in-out infinite;
            animation-delay: 1.5s;
        }

        @keyframes waveMove1 {
            0%, 100% {
                transform: translateY(0) scaleY(1);
            }
            50% {
                transform: translateY(-20px) scaleY(1.3);
            }
        }

        @keyframes waveMove2 {
            0%, 100% {
                transform: translateY(0) scaleY(1);
            }
            50% {
                transform: translateY(-15px) scaleY(1.2);
            }
        }

        @keyframes waveMove3 {
            0%, 100% {
                transform: translateY(0) scaleY(1);
            }
            50% {
                transform: translateY(-10px) scaleY(1.15);
            }
        }

        .loader-container.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        /* Screen Mode Dropdown */
        .screen-mode-selector {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 10;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .dropdown-container {
            position: relative;
            width: 180px;
        }

        .dropdown-selected {
            background-color: rgba(30, 30, 30, 0.9);
            color: #fff;
            padding: 10px 15px;
            border: 1px solid #444;
            border-radius: 4px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            transition: background-color 0.2s, border-color 0.2s;
        }

        .dropdown-selected:hover {
            background-color: rgba(45, 45, 45, 0.9);
            border-color: #0078d7;
        }

        .dropdown-selected i {
            font-size: 12px;
            transition: transform 0.2s;
        }

        .dropdown-container.active .dropdown-selected i {
            transform: rotate(180deg);
        }

        .dropdown-options {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background-color: rgba(30, 30, 30, 0.95);
            border: 1px solid #444;
            border-radius: 4px;
            margin-top: 5px;
            overflow: hidden;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: opacity 0.2s, transform 0.2s, visibility 0.2s;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
        }

        .dropdown-container.active .dropdown-options {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .dropdown-option {
            padding: 10px 15px;
            color: #fff;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .dropdown-option:hover {
            background-color: rgba(0, 120, 215, 0.8);
        }

        .dropdown-option i {
            font-size: 14px;
            width: 16px;
        }

        .avatar-container {
            text-align: center;
            margin-bottom: 30px;
            display: block;
            animation: slideInFromTop 0.8s ease-out forwards;
            opacity: 0;
            z-index: 1;
        }

        @keyframes slideInFromTop {
            0% {
                opacity: 0;
                transform: translateY(-50px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .avatar-image {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid transparent;
            background: linear-gradient(#0a0e27, #0a0e27) padding-box,
                        linear-gradient(135deg, #00bcf2, #0078d7, #00d4ff, #0078d7) border-box;
            box-shadow: 0 0 30px rgba(0, 188, 242, 0.6), 0 0 50px rgba(0, 120, 215, 0.4);
            animation: avatarPulse 2s ease-in-out infinite;
            opacity: 1;
            display: block;
        }

        @keyframes avatarPulse {
            0%, 100% {
                box-shadow: 0 0 30px rgba(0, 188, 242, 0.6), 0 0 50px rgba(0, 120, 215, 0.4);
                transform: scale(1);
            }
            50% {
                box-shadow: 0 0 50px rgba(0, 188, 242, 0.9), 0 0 70px rgba(0, 120, 215, 0.6);
                transform: scale(1.05);
            }
        }

        .greeting-text {
            font-size: 28px;
            color: #fff;
            font-weight: 300;
            margin-top: 20px;
            letter-spacing: 1.5px;
            display: block;
            opacity: 1;
            min-height: 40px;
            white-space: nowrap;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-shadow: 0 2px 10px rgba(0, 188, 242, 0.5);
            z-index: 1;
        }

        .greeting-text span {
            display: inline-block;
            opacity: 0;
            animation: slideInFromLeft 0.3s ease-out forwards;
            margin-right: 1px;
        }

        @keyframes slideInFromLeft {
            0% {
                opacity: 0;
                transform: translateX(-50px);
            }
            100% {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideInFromBottom {
            0% {
                opacity: 0;
                transform: translateY(30px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .loader {
            position: relative;
            width: 50px;
            height: 50px;
            margin: 30px auto 0;
            z-index: 1;
        }

        .loader .circle {
            position: absolute;
            width: 38px;
            height: 38px;
            opacity: 0;
            transform: rotate(225deg);
            animation: rotate 4.8s infinite;
            left: 6px;
            top: 6px;
        }

        .loader .circle:after {
            content: '';
            position: absolute;
            width: 3px;
            height: 3px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00d4ff, #00bcf2);
            border: 1px solid #00bcf2;
            box-shadow: 0 0 5px rgba(0, 212, 255, 0.8), 0 0 10px rgba(0, 188, 242, 0.5);
        }

        .loader .circle:nth-child(2) {
            animation-delay: 240ms;
        }

        .loader .circle:nth-child(3) {
            animation-delay: 480ms;
        }

        .loader .circle:nth-child(4) {
            animation-delay: 720ms;
        }

        .loader .circle:nth-child(5) {
            animation-delay: 960ms;
        }

        .loader .bg {
            position: absolute;
            width: 70px;
            height: 70px;
            margin-left: -10px;
            margin-top: -10px;
            border-radius: 13px;
            background-color: transparent;
        }

        @keyframes rotate {
            0% {
                transform: rotate(225deg);
                opacity: 1;
            }

            7% {
                transform: rotate(345deg);
            }

            30% {
                transform: rotate(455deg);
            }

            39% {
                transform: rotate(690deg);
            }

            70% {
                transform: rotate(815deg);
                opacity: 1;
            }

            75% {
                transform: rotate(945deg);
            }

            76% {
                transform: rotate(945deg);
                opacity: 0;
            }

            100% {
                transform: rotate(945deg);
                opacity: 0;
            }
        }

        /* Power Options Modal */
        .power-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }

        .power-modal.show {
            display: flex;
        }

        .power-options {
            background-color: #1e1e1e;
            border: 1px solid #444;
            border-radius: 4px;
            padding: 0;
            min-width: 200px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        .power-option {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px 20px;
            color: #fff;
            cursor: pointer;
            transition: background-color 0.2s;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 14px;
        }

        .power-option:hover {
            background-color: #2d2d2d;
        }

        .power-option i {
            font-size: 18px;
            width: 20px;
        }

        /* Sleep Screen */
        .sleep-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 99999;
            background: url('assets/images/sleep-background.jpg') no-repeat center center;
            background-size: cover;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .sleep-screen.show {
            display: flex;
            opacity: 1;
        }

        .sleep-avatar {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            border: 4px solid rgba(255, 255, 255, 0.3);
            margin-bottom: 30px;
            object-fit: cover;
        }

        .sleep-text {
            font-size: 32px;
            color: #fff;
            font-weight: 300;
            margin-bottom: 50px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .wake-button {
            padding: 12px 30px;
            background-color: rgba(0, 120, 212, 0.9);
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background-color 0.2s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .wake-button:hover {
            background-color: rgba(0, 120, 212, 1);
        }

        .copy {
            font-size: 18px;
            padding: 7px;
            color: #ccc;
            position: absolute;
            bottom: 0;
            left: 0;
        }

        .copy h6 {
            margin: 0;
        }

        .copy h6 a {
            color: #fff;
            text-decoration: underline;
        }

        .context-menu {
            display: none;
            position: absolute;
            background-color: #fff;
            color: #333;
            border-radius: 5px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.3);
            z-index: 10000;
            font-size: 12px;
            white-space: nowrap;
            width: 200px;
            height: auto;
            user-select: none;
        }

        .context-menu ul {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .context-menu ul li {
            position: relative;
            padding: 8px 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            box-sizing: border-box;
        }

        .context-menu ul li:hover {
            background-color: #f0f0f0;
        }

        .context-menu ul li:first-child {
            border-top-left-radius: 5px;
            border-top-right-radius: 5px;
        }

        .context-menu ul li:last-child {
            border-bottom-left-radius: 5px;
            border-bottom-right-radius: 5px;
        }

        .context-menu ul li a {
            text-decoration: none;
            color: #333;
            display: flex;
            align-items: center;
            width: auto;
        }

        .context-menu ul li a i {
            margin-right: 8px;
        }

        .context-menu ul li hr {
            border: 0;
            border-top: 1px solid #ddd;
            margin: 5px 0;
        }

        hr {
            border: 0;
            border-top: 1px solid #ddd;
            margin: 5px 0;
        }

        .context-menu ul .submenu {
            display: none;
            position: absolute;
            top: 0;
            left: 100%;
            margin-top: -8px;
            background-color: #fff;
            border-radius: 5px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            width: auto;
        }

        .context-menu ul .menu-item:hover>.submenu,
        .context-menu ul .submenu:hover {
            display: block;
        }

        .context-menu ul .submenu li {
            padding: 8px 12px;
            display: flex;
            align-items: center;
        }

        .context-menu ul .submenu ul {
            padding: 0;
        }

        .context-menu ul .submenu li:hover {
            background-color: #f0f0f0;
        }

        .context-menu ul .menu-item:hover>.submenu {
            display: block;
        }

        .context-menu ul li .checked::before {
            content: '\f00c';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            color: black;
            margin-right: 8px;
        }

        .context-menu ul .disabled {
            color: #888;
            cursor: not-allowed;
        }

        .context-menu ul .disabled:hover {
            background-color: transparent;
        }

        .context-menu ul li .arrow {
            margin-left: auto;
        }

        /* Start Menu Styles */
        .start-menu {
            display: none;
            position: absolute;
            bottom: 40px; 
            left: 0px;
            width: 800px;
            height: 590px;
            background-color: rgba(0, 0, 0, 0.85);
            color: #fff;
            border-radius: 0px;
            box-shadow: 2px -2px 10px rgba(0, 0, 0, 0.5);
            z-index: 9999; /* Above everything */
            overflow: hidden;
            user-select: none;
            transition: transform 0.3s ease-in-out, opacity 0.3s ease;
            transform: translateY(100%);
            opacity: 0;
            pointer-events: none;
        }

        .start-menu.show {
            pointer-events: auto;
        }

        .start-menu .menu-bar {
            display: flex;
            align-items: center;
            padding: 8px;
            background-color: #0078d7;
        }

        .start-menu .menu-bar .start-text {
            color: #fff;
            margin-left: -10px;
            font-size: 18px;
            font-weight: bold;
        }

        .start-menu .menu-bar .start-text,
        .start-menu .menu-bar .user-account .user-name {
            opacity: 0;
            transition: opacity 0.3s ease-in-out, margin-left 0.3s ease-in-out;
        }

        .start-menu .menu-bar .start-icon:hover+.start-text,
        .start-menu .menu-bar .user-account:hover .user-name {
            opacity: 1;
            margin-left: 10px;
        }

        .start-menu .menu-bar .start-icon:hover+.start-text {
            display: inline;
        }

        .start-menu .menu-bar .start-icon {
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 20px;
            color: #fff;
        }

        .start-menu .menu-bar .start-icon::before {
            content: "\f0c9";
            font-family: "Font Awesome 5 Free";
            font-weight: 900;
        }

        .start-menu .menu-bar .user-account {
            display: flex;
            align-items: center;
            margin-left: auto;
        }

        .start-menu .menu-bar .user-account .user-name {
            margin-left: -50px;
        }

        .start-menu .menu-bar .user-account .user-icon {
            width: 30px;
            height: 30px;
            background: url('assets/images/User.png') no-repeat center center;
            background-size: contain;
            border-radius: 50%;
            filter: invert(1);
        }

        .start-menu .sections {
            display: flex;
            flex-direction: row;
            width: 10px;
        }

        .start-menu .section {
            flex: 1;
            padding: 10px;
            border-right: 1px solid #444;
        }

        .start-menu .section:last-child {
            border-right: none;
        }

        .start-menu .section .icons-section {
            width: 10px;
            display: flex;
            flex-direction: column;
            justify-content: flex-end;
            align-items: flex-start;
            height: 520px;
            padding: 5px;
            transition: width 0.3s ease-in-out;
        }

        .start-menu .section .icons-section:hover {
            width: auto;
        }

        .start-menu .section .icons-section .icon {
            display: flex;
            align-items: center;
            padding: 8px;
            cursor: default;
            width: 100%;
            position: relative;
            right: 85%;
            margin-bottom: 10px;
        }

        .start-menu .section .icons-section:hover .icon {
            right: 0;
        }

        .start-menu .section .icons-section .icon:hover {
            background-color: rgba(255, 255, 255, 0.150);
        }

        .start-menu .section .icons-section .icon .icon-text {
            opacity: 0;
            margin-left: 5px;
            transition: all 0.2s ease-in-out;
            white-space: nowrap;
        }

        .start-menu .section .icons-section:hover .icon .icon-text {
            opacity: 1;
            margin-left: 10px;
        }

        .start-menu .section .apps-section {
            margin-left: 0;
            padding: 5px;
            height: 500px;
            overflow-y: auto;
            overflow-x: hidden;
            width: 290px;
            display: flex;
            flex-direction: column;
            align-items: center;
            scrollbar-width: thin;
            scrollbar-color: #888 #333;
        }

        .start-menu .section .apps-section::-webkit-scrollbar {
            width: 12px;
        }

        .start-menu .section .apps-section::-webkit-scrollbar-thumb {
            background-color: #888;
            border-radius: 6px;
            transition: background-color 0.3s ease;
        }

        .start-menu .section .apps-section::-webkit-scrollbar-thumb:hover {
            background-color: #555;
        }

        .start-menu .section .apps-section::-webkit-scrollbar-track {
            background-color: #333;
            border-radius: 6px;
        }

        .start-menu .section .apps-section .app {
            display: flex;
            align-items: center;
            padding: 5px;
            transition: all 0.3s ease-in-out;
            cursor: default;
            width: 100%;
            position: relative;
        }

        .start-menu .section .apps-section .app:hover {
            background-color: rgba(255, 255, 255, 0.150);
        }

        .start-menu .section .apps-section .app img {
            width: 30px;
            height: 30px;
            margin-right: 10px;
            user-select: none;
            pointer-events: none;
            user-select: none;
        }

        .start-menu .section .apps-section .app .app-info {
            display: flex;
            flex-direction: column;
        }

        .start-menu .section .apps-section .app .app-info .system-text {
            color: #c5c5c5;
        }

        .start-menu .section .pin-section {
            margin-left: 0;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            padding: 10px;
            height: 100%;
            width: 800px;
            overflow-y: scroll;
            transition: background-color 0.3s;
        }

        .start-menu .section .pin-section .pinned-app {
            display: flex;
            align-items: center;
            padding: 5px;
            cursor: default;
            width: calc(33.33% - 10px);
            box-sizing: border-box;
        }

        .start-menu .section .pin-section .pinned-app .app-name {
            flex: 1;
        }

        .start-menu .section .pin-section .group-name {
            font-size: 16px;
            margin-bottom: 10px;
        }

        .library-search {
            display: inline-block;
            padding: 5px;
            width: 100%;
            color: white;
            transition: background-color 0.3s ease-in-out;
            cursor: default;
        }

        .library-search:hover {
            background-color: rgba(255, 255, 255, 0.250);
        }

        .pin-section {
            display: flex;
            flex-direction: column;
            width: 100%;
        }

        .group {
            margin-bottom: 20px;
        }

        .group-name {
            font-size: 1.5rem;
            color: #fff;
            margin-bottom: 10px;
            text-align: left;
        }

        .app-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            width: 50%;
        }

        .pinned-app {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            transition: all 0.3s ease-in-out;
            border: 1px solid transparent;
            padding-top: 10px;
        }

        .pinned-app img {
            width: 40px;
            height: 40px;
            margin-bottom: 10px;
            pointer-events: none;
            user-select: none;
        }

        .app-name {
            color: #fff;
            text-align: center;
        }

        .pinned-app:hover {
            background-color: rgba(255, 255, 255, 0.2);
            border: 1px solid #B4B7B9;
        }

        .task-view-icon,
        .apps-icon {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: default;
            margin-left: 10px;
        }

        .task-view-icon img {
            width: 18px;
            height: 18px;
        }

        .apps-icon img {
            width: 24px;
            height: 24px;
            pointer-events: none;
            user-select: none;
        }

        .task-view-icon img {
            filter: invert(100%);
            pointer-events: none;
            user-select: none;
        }

        .task-view-icon:hover,
        .apps-icon:hover {
            background-color: rgba(255, 255, 255, 0.150);
        }

        .task-view-icon:active,
        .apps-icon:active {
            background-color: rgba(255, 255, 255, 0.050);
        }

        /* Multiple Instance Indicator */
        .apps-icon {
            position: relative;
        }

        .apps-icon.active::after {
            content: '';
            position: absolute;
            bottom: 2px;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 4px;
            background-color: #0078d7;
            border-radius: 50%;
        }

        .apps-icon.multiple-instances::after {
            width: 20px;
            height: 3px;
            border-radius: 2px;
        }

        .task-view-icon img.default-img {
            display: block;
        }

        .task-view-icon img.hover-img {
            display: none;
        }

        .task-view-icon:hover img.default-img {
            display: none;
        }

        .task-view-icon:hover img.hover-img {
            display: block;
        }

        .arrow {
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            font-size: 14px;
            margin-left: auto;
            transition: transform 0.3s ease, color 0.3s ease;
        }

        .arrow::before {
            content: '\f078';
        }

        .app.expanded .arrow {
            transform: rotate(360deg);
        }

        .app.expanded .arrow::before {
            content: '\f077';
        }

        .expandable-content {
            display: none;
            margin-top: 10px;
            width: 100%;
            position: relative;
        }

        .expandable-content.show {
            display: block;
        }

        .expandable-content .app {
            margin-bottom: 5px;
            border: none;
            cursor: default;
            width: 100%;
            position: relative;
            display: flex;
            margin-left: 15px;
        }

        .expandable-content .app img {
            width: 20px;
            height: 20px;
            margin-right: 10px;
        }

        .app.expanded {
            animation: zoomInOut 0.3s ease;
        }

        @keyframes zoomInOut {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
            }
        }

        .search-container {
            position: relative;
            display: flex;
            align-items: center;
            height: 100%;
            background-color: white;
            box-sizing: border-box;
            margin-left: 15px;
            border: 2px solid transparent;
        }

        .search-container:hover {
            border: 2px solid gray;
        }

        .search-container:focus-within {
            border-color: rgba(0, 47, 255, 0.733);
        }

        .search-box::placeholder {
            color: #2d2d2d;
            transition: color 0.2s ease-in-out;
        }

        .search-box:focus::placeholder {
            color: black;
        }

        .search-icon {
            width: 20px;
            height: 20px;
            margin-left: 5px;
            user-select: none;
            cursor: default;
            -webkit-user-drag: none;
            -webkit-user-drag: none;
        }

        .search-box {
            width: 250px;
            height: 100%;
            border: none;
            margin-left: 5px;
            outline: none;
            font-size: 14px;
            box-sizing: border-box;
            background-color: rgba(255, 255, 255, 0.725);
        }

        .search-panel-icon {
            width: 60px;
            height: 40px;
            user-select: none;
            box-sizing: border-box;
            height: 100%;
        }

        .search-panel-icon:hover {
            background-color: #B4B7B9;
        }

        .search-panel-icon img {
            width: 100%;
            height: 90%;
            object-fit: contain;
            display: block;
            -webkit-user-drag: none;
        }

        .search-panel {
            display: none;
            position: absolute;
            bottom: 40px;
            left: 63px;
            width: 800px;
            height: 595px;
            background-color: rgba(0, 0, 0, 0.85);
            border: 0.1px solid #cccccc70;
            border-bottom: none;
            border-radius: 0;
            box-shadow: -4px -4px 8px rgba(0, 0, 0, 0.1),
                4px -4px 8px rgba(0, 0, 0, 0.1),
                0px -4px 8px rgba(0, 0, 0, 0.1);
            z-index: 9999;
            color: white;
            padding: 20px;
            box-sizing: border-box;
            overflow: hidden;
        }

        .search-panel .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 0.1px solid rgba(0, 0, 0, 0.2);
            padding-bottom: 10px;
            margin-bottom: 10px;
            color: #7c7c7c;
        }

        .search-panel .top-bar .option:hover {
            color: white;
        }

        .search-panel .top-bar .options {
            display: flex;
            gap: 15px;
        }

        .search-panel .top-bar .options .option {
            position: relative;
            padding: 5px 10px;
            cursor: pointer;
            margin-bottom: 5px;
        }

        .search-panel .top-bar .options .option.selected {
            color: white;
            border-radius: 4px;
        }

        .search-panel .top-bar .options .option.selected::after {
            content: '';
            display: block;
            height: 2px;
            background-color: #0078d4;
            position: absolute;
            bottom: -10px;
            left: 0;
            right: 0;
        }

        .search-panel .top-bar .options .more-options {
            position: relative;
        }

        .dropdown .option {
            color: white;
            width: 100%;
        }

        .search-panel .top-bar .options .more-options .dropdown {
            display: none;
            position: absolute;
            top: 40px;
            left: 0;
            width: 100px;
            background-color: #2e2e2e;
            border: 0.1px solid #cccccc80;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
            padding: 10px;
            z-index: 1001;
        }

        .dropdown .option:hover {
            background-color: #ffffff57;
        }

        .more-options .dropdown {
            width: 100%;
        }

        .more-options .dropdown .option {
            margin-left: -10px;
        }

        .search-panel .top-bar .user-account .dots i:hover,
        .search-panel .top-bar .close-btn i:hover {
            color: white;
        }

        .search-panel .top-bar .options .more-options:hover .dropdown {
            display: block;
        }

        .search-panel .top-bar .user-account {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .search-panel .top-bar .user-account img {
            width: 30px;
            height: 30px;
            border-radius: 50%;
        }

        .search-panel .top-bar .user-account .dots {
            cursor: pointer;
            position: relative;
        }

        .search-panel .top-bar .user-account .dots .dropdown {
            display: none;
            position: absolute;
            top: 35px;
            left: -160px;
            background-color: #2e2e2e;
            border: 0.1px solid #cccccc80;
            box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.2);
            padding: 10px;
            z-index: 1001;
        }

        .user-account .dropdown .option {
            padding: 9px;
            width: 100%;
        }

        .user-account .dots .dropdown .option {
            left: -4.5%;
            position: relative;
        }

        .user-account .dropdown .option:hover {
            background-color: #dddddd80;
        }

        .user-account .dropdown .option img {
            width: 20px;
            height: 20px;
            margin-right: 10px;
        }

        .user-account .dropdown {
            width: 200px;
        }

        .search-panel .top-bar .user-account .dots:hover .dropdown {
            display: block;
        }

        .search-panel .top-bar .user-account .dropdown hr {
            margin: 10px 0;
            border: 0.5px solid #444;
        }

        /* Close button */
        .search-panel .top-bar .close-btn {
            cursor: pointer;
            font-size: 16px;
            margin-left: 10px;
        }

        .search-panel .suggested-title {
            margin-bottom: 10px;
            font-weight: bold;
        }

        .suggested-apps {
            float: left;
            width: 35%;
            box-sizing: border-box;
            margin-left: 10px;
        }

        .suggested-apps .suggested-app {
            display: flex;
            align-items: center;
            padding: 8px;
            gap: 3px;
            border-radius: 5px;
            font-size: 14px;
            margin: 0;
        }

        .suggested-apps .suggested-app img {
            width: 30px;
            height: 30px;
            object-fit: contain;
            pointer-events: none;
        }

        .suggested-apps hr {
            border: none;
            border-top: 1px solid #555;
            width: 90%;
            margin: auto;
            box-sizing: border-box;
        }

        .search-panel .suggested-app:hover {
            background-color: #6f6f6f;
        }

        .suggested-apps .suggested-app:hover+hr {
            border-top: 0;
        }

        .suggested-apps .suggested-app:hover~hr {
            border-bottom: 0;
        }

        .search-panel .suggested-app hr {
            border: 0.5px solid #444;
            margin: 5px 0;
        }

        .suggested-app .app-name {
            margin-left: 10px;
            cursor: default;
        }

        .search-panel .top-apps-title {
            margin-bottom: 10px;
            margin-top: -20px;
            font-weight: bold;
            margin-left: 50px;
        }

        .search-panel .top-apps-grid {
            width: 60%;
            margin: 0 auto;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            box-sizing: border-box;
        }

        .search-panel .top-apps-grid .app-container {
            width: calc(33.333% - 20px);
            text-align: center;
            padding: 8px;
            background-color: #2e2e2e81;
            border-radius: 4px;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .search-panel .top-apps-grid .app-container:hover {
            background-color: #4b5a627c;
        }

        .search-panel .top-apps-grid .app-container img {
            width: 40px;
            height: 40px;
            margin-bottom: 10px;
            display: block;
            pointer-events: none;
        }

        .search-panel .top-apps-grid .app-container .app-name {
            font-size: 14px;
            cursor: default;
        }

        .search-panel .quick-searches-title {
            margin-top: 2%;
            margin-bottom: 2%;
            font-weight: bold;
        }

        .search-panel .quick-searches {
            display: flex;
            flex-direction: column;
            gap: 0;
        }

        .search-panel .quick-search {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 5px;
            border-radius: 5px;
            width: 90%;
        }

        .search-panel .quick-search:hover {
            background-color: #6f6f6f;
        }

        .search-panel .quick-search img {
            width: 40px;
            height: 40px;
            pointer-events: none;
        }

        .search-panel .quick-search .search-title {
            margin-left: 10px;
            cursor: default;
        }

        .search-panel .quick-search+hr {
            border: 0.1px solid #444;
            width: 90%;
        }

        .search-panel .quick-search:last-child+hr {
            display: none;
        }

        .content-section {
            display: none;
            z-index: 9999;
        }

        .content-section h2 {
            font-size: 18px;
        }

        .apps-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }

        .app-item:hover {
            background-color: #4b5a627c;
        }

        .app-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            width: 100px;
            padding: 10px;
            border-radius: 5px;
            background-color: #2e2e2e81;
        }

        .app-icon {
            width: 30px;
            height: 30px;
            object-fit: cover;
            pointer-events: none;
        }

        .app-text {
            margin-top: 10px;
            font-size: 14px;
            white-space: nowrap;
            text-overflow: ellipsis;
            cursor: default;
        }

        #documents-content {
            text-align: center;
        }

        .image-container {
            display: flex;
            justify-content: center;
            margin-top: 30px;
        }

        .image-container img {
            width: 40%;
            filter: invert(1) brightness(0.9);
            height: auto;
            pointer-events: none;
        }

        #documents-content h2 {
            font-size: 24px;
            color: #858889;
            margin: 10px;
            cursor: default;
        }

        #documents-content p {
            font-size: 16px;
            color: #858889;
            margin: 0;
            cursor: default;
        }

        #web-content {
            text-align: center;
            padding: 20px;
        }

        #web-content h2 {
            font-size: 24px;
            color: #858889;
            margin: 10px;
            cursor: default;
        }

        #web-content p {
            font-size: 16px;
            color: #858889;
            margin: 0;
            cursor: default;
        }

        @keyframes zoom-in {
            from {
                transform: scale(0.8);
                opacity: 0;
            }

            to {
                transform: scale(1);
                opacity: 1;
            }
        }

        @keyframes zoom-out {
            from {
                transform: scale(1);
                opacity: 1;
            }

            to {
                transform: scale(0.8);
                opacity: 0;
            }
        }

        .plus-container.zoom-in {
            animation: zoom-in 0.5s ease-out forwards;
        }

        .plus-container.zoom-out {
            animation: zoom-out 0.5s ease-in forwards;
        }

        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .plus-container {
            position: absolute;
            top: 10px;
            left: 20px;
            display: flex;
            align-items: center;
            background: transparent;
            padding: 10px;
            border: 0.1px solid transparent;
        }

        .plus-container:hover {
            background: rgba(255, 255, 255, 0.2);
            border: 0.1px solid white;
        }

        .plus-container i {
            font-size: 24px;
            margin-right: 8px;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 300;
        }

        .plus-container span {
            font-size: 16px;
            color: white;
            cursor: default;
        }

        .bottom-text-container {
            text-align: left;
            margin-top: -400px;
            margin-left: 10px;
            width: 100%;
            padding-left: 10px;
            box-sizing: border-box;
        }

        .bottom-text {
            font-size: 14px;
            color: white;
            font-weight: bold;
        }

        .task-view-icon .default-img {
            display: block;
        }

        .task-view-icon .hover-img {
            display: none;
        }

        .task-view-icon.open .default-img {
            display: none;
        }

        .task-view-icon.open .hover-img {
            display: block;
        }

        .task-view-icon:hover .default-img {
            display: none;
        }

        .task-view-icon:hover .hover-img {
            display: block;
        }

        .taskbar-context-menu {
            position: absolute;
            display: none;
            background: #2b2b2b;
            border: 1px solid #ccc;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            width: 300px;
            font-size: 14px;
            color: white;
            z-index: 999999999999999999999999999999999999999999999999999;
        }

        .taskbar-context-menu ul {
            list-style: none;
            margin: 0;
            padding: 0;
            width: 100%;
        }

        .taskbar-context-menu ul li {
            padding: 8px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.2s;
            margin-left: 10px;
            position: relative;
        }

        .taskbar-context-menu ul li:hover {
            background-color: #414141;
        }

        .taskbar-context-menu ul li .left-icon {
            margin-right: 10px;
        }

        .taskbar-context-menu ul li .right-icon {
            font-size: 16px;
            margin-left: auto;
        }

        .taskbar-context-menu hr {
            border: 0;
            width: 90%;
            border-top: 1px solid #eee;
            margin: 4px auto;
        }

        .sub-menu {
            display: none;
            position: absolute;
            top: 0;
            left: 100%;
            background: #2b2b2b;
            border: 1px solid #ccc;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.1);
            width: 200px;
            font-size: 14px;
            color: white;
            z-index: 1001;
            padding: 0;
            margin: 0;
        }

        .sub-menu ul {
            padding: 0;
            margin: 0;
        }

        .sub-menu ul li {
            padding: 8px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.2s;
            margin-left: 0;
        }

        .sub-menu ul li:hover {
            background-color: #414141;
        }

        .sub-menu hr {
            border: 0;
            width: 90%;
            border-top: 1px solid #eee;
            margin: 4px auto;
        }

        .search-container .search-icon {
            display: block;
        }

        .search-container .search-box {
            display: block;
        }

        .search-container .search-panel-icon {
            display: block;
        }

        .search-container.transparent {
            background-color: transparent;
            width: 35px;
            border: none;
        }

        .search-container.transparent:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .search-container.transparent:active {
            background-color: rgba(255, 255, 255, 0.3);
        }

        .search-container.transparent .search-icon {
            filter: invert(1) brightness(2);
            border: none;
            align-items: center;
        }

        .search-container:hover .search-icon {
            border: none;
        }

        .show-desktop {
            width: 5px;
            height: 100%;
            background-color: #1d2e3e;
            display: flex;
            align-items: center;
            justify-content: center;
            border-left: 1px solid #ffffff83;
            cursor: pointer;
        }



        .show-desktop:hover {
            background-color: #303c54;
        }

        .show-desktop:active {
            background-color: #303c5485;
        }

        .notification-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            width: 35px;
            user-select: none;
            -webkit-user-drag: none;
        }

        .notification-icon:hover {
            background-color: rgba(255, 255, 255, 0.15);
        }

        .notification-icon:active {
            background-color: rgba(255, 255, 255, 0.3);
        }

        .notification-icon img {
            width: 20px;
            height: auto;
            pointer-events: none;
        }

        .notification-panel {
            position: fixed;
            top: 0;
            user-select: none;
            right: 8px;
            width: 350px;
            height: 100vh;
            background-color: #3a3b3cee;
            color: #fff;
            transform: translateX(100%);
            opacity: 0;
            transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out;
            visibility: hidden;
            display: none;
            pointer-events: none;
        }

        .notification-icon.active {
            background-color: rgba(255, 255, 255, 0.050);
        }

        .notification-panel.show {
            transform: translateX(0);
            opacity: 1;
            visibility: visible;
        }

        .notification-panel.hide {
            transform: translateX(100%);
            opacity: 0;
            visibility: hidden;
        }

        .notification-panel p {
            margin-top: 60%;
            font-size: 16px;
            text-align: center;
            color: #adadad;
            cursor: default;
        }

        .notification-panel .manage-notifications {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 14px;
            color: #94BFDF;
            cursor: default;
        }

        .notification-panel .manage-notifications:hover {
            color: #fff;
        }

        .notification-panel .manage-notifications:active {
            color: #aaaaaa;
        }

        .collapse-expand {
            margin-top: 10px;
            font-size: 15px;
            cursor: default;
            margin-left: 10px;
            color: #94BFDF;
            align-self: flex-start;
            position: relative;
            user-select: none;
        }

        .collapse-expand:hover {
            color: #fff;
        }

        .collapse-expand:active {
            color: #aaaaaa;
        }

        .buttons-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            padding: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out;
            max-height: 1000px;
            margin: 2px;
        }

        .button-item {
            width: 80px;
            height: 80px;
            background-color: #5a5a5a;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: #fff;
            padding: 0;
            margin: 2px;
            border: 0.1px solid transparent;
            transition: background-color 0.3s, transform 0.2s;
        }

        .button-item:active {
            transform: scale(0.95);
            filter: blur(1px);
        }

        .button-item.active {
            background-color: #0078d7;
            animation: zoomInOut 0.2s ease-in-out;
        }

        .button-item:not(.active):hover {
            background-color: #7a7a7a;
            border: 0.1px solid white;
        }

        .button-item.active:hover {
            border: 0.1px solid white;
            background-color: #0078d7;
        }

        @keyframes zoomInOut {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
            }
        }

        .button-item img {
            width: 20px;
            height: 20px;
            margin-bottom: 0;
            pointer-events: none;
        }

        .button-item p {
            margin-top: 10px;
            font-size: 12px;
            color: white;
            font-family: "Arimo", sans-serif;
            font-weight: normal;
        }

        .buttons-container.collapsed {
            max-height: 85.5px;
            overflow: hidden;
        }

        .brightness-control {
            display: flex;
            align-items: center;
            margin-top: 20px;
        }

        .brightness-icon {
            width: 25px;
            height: 25px;
            margin-left: 5px;
            margin-right: 10px;
            pointer-events: none;
        }

        .slider-container {
            position: relative;
            width: 100%;
            margin-right: 25px;
            margin-bottom: 6px;
        }

        .slider {
            width: 100%;
            appearance: none;
            height: 3px;
            background: linear-gradient(to right, #0078d7 30%, gray 30%);
            outline: none;
        }

        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 10px;
            height: 25px;
            border-radius: 20%;
            background-color: #0078d7;
        }

        .slider:hover::-webkit-slider-thumb {
            background-color: white;
        }

        .slider-percentage {
            position: absolute;
            top: -35px;
            left: 30%;
            transform: translateX(-50%);
            color: white;
            padding: 5px;
            border: 0.1px solid black;
            background-color: #2b2b2b;
            font-size: 14px;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
            opacity: 0;
        }

        .slider-container:hover .slider-percentage {
            visibility: visible;
            opacity: 1;
            transition-delay: 1s;
        }

        .slider-container:not(:hover) .slider-percentage {
            visibility: hidden;
            opacity: 0;
            transition-delay: 0s;
        }

        .time-date-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            cursor: default;
            font-size: 12px;
            height: 100%;
            padding: 0 8px;
            user-select: none;
            justify-content: center;
        }

        .time-date-container:hover {
            background-color: rgba(255, 255, 255, 0.15);
        }

        .time-date-container:active {
            background-color: rgba(255, 255, 255, 0.3);
        }

        .time {
            margin-top: 1px;
        }

        .calendar-panel {
            position: absolute;
            top: 5%;
            height: 100%;
            right: 6px;
            width: 350px;
            background-color: #222222ee;
            color: white;
            padding: 5px;
            box-shadow: -4px -4px 6px rgba(0, 0, 0, 0.1);
            transform: translateY(100%);
            border-top: 0.01px solid #aaaaaa;
            border-left: 0.01px solid #aaaaaa;
            transition: transform 0.5s ease, opacity 0.5s ease;
            z-index: 1000;
            user-select: none;
        }

        .calendar-panel.show {
            opacity: 1;
            transform: translateY(-20px);
        }

        .large-time {
            font-size: 50px;
            font-family: "Roboto", sans-serif;
            font-optical-sizing: auto;
            font-weight: 300;
            font-style: normal;
            color: white;
            display: inline;
            font-weight: 10;
            cursor: default;
        }

        .small-time {
            font-size: 14px;
            color: gray;
            display: inline;
            font-family: "Roboto", sans-serif;
            font-weight: bold;
            cursor: default;
        }

        .small-time .ampm {
            font-size: 14px;
            color: gray;
            font-weight: bold;
            text-transform: lowercase;
            cursor: default;
        }

        #calendarDate {
            font-size: 14px;
            color: #A6D8FF;
            cursor: pointer;
            user-select: none;
        }

        #calendarDate:hover {
            color: #a8a8a8;
        }

        #calendarDate:active {
            color: #7d7d7d;
        }

        .calendar-divider {
            width: 100%;
            height: 1px;
            background-color: #616161;
            border: none;
            margin-top: 10px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: default;
            margin-top: 10px;
        }

        .month-year {
            color: #cececedc;
            font-size: 16px;
            cursor: default;
        }

        .month-year:hover {
            color: white;
        }

        .month-year:active {
            color: #c4c4c48f;
        }

        .arrow-controls button {
            background: none;
            border: none;
            color: #cececedc;
            font-size: 20px;
            cursor: default;
            transition: transform 0.1s ease-in-out;
            font-weight: 1;
        }

        .arrow-controls button:hover {
            color: #eeeff1;
        }

        .arrow-controls button:active {
            color: #636363;
        }

        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            margin-top: 10px;
            color: white;
            font-size: 14px;
            text-align: center;
            cursor: default;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            grid-template-rows: repeat(6, 1fr);
            gap: 2px;
            margin-top: 10px;
            cursor: default;
        }

        .calendar-grid .day-cell {
            width: 75%;
            padding: 5px;
            text-align: center;
            color: white;
            cursor: default;
            border: 0.4px solid transparent;
            transition: background-color 0.2s ease-in-out;
        }

        .calendar-grid .day-cell:hover {
            border: 0.4px solid #cccccc80;
        }

        .calendar-grid .day-cell.selected {
            border: 0.4px solid #0c6cb8;
        }

        .calendar-grid .day-cell.inactive {
            color: gray;
        }

        .calendar-grid .day-cell.current-day {
            background-color: #0078d7;
            color: white;
            border: none;
            position: relative;
        }

        .calendar-grid .day-cell.current-day::before {
            content: "";
            position: absolute;
            top: 2px;
            left: 2px;
            right: 2px;
            bottom: 2px;
            border: 2px solid black;
            box-sizing: border-box;
        }

        .event-details {
            margin-top: 10px;
            text-align: left;
            color: white;
            padding: 0 10px;
            cursor: default;
        }

        .selected-date {
            font-size: 16px;
            cursor: default;
            margin-bottom: 10px;
        }

        .event-input {
            width: calc(100% - 20px);
            padding: 10px;
            border: 1px solid gray;
            background-color: transparent;
            color: white;
            margin-bottom: 10px;
            font-family: "Roboto";
        }

        .event-input:hover {
            background-color: #181818;
            border: 1px solid rgba(255, 255, 255, 0.8);
        }

        .event-input:focus {
            background-color: white;
            border-color: blue;
            color: black;
            outline: none;
        }

        .no-events {
            margin-top: 10px;
            font-size: 14px;
        }

        .toggle-agenda {
            display: flex;
            justify-content: flex-end;
            align-items: center;
            margin-top: 40px;
            cursor: pointer;
            color: #A6D8FF;
        }

        .toggle-agenda:hover {
            color: #cececedc;
        }

        .toggle-agenda:active {
            color: #cecece83;
        }

        .toggle-agenda span {
            font-size: 16px;
        }

        .toggle-agenda span.material-symbols-outlined {
            transition: transform 0.3s ease;
        }

        .toggle-agenda span.material-symbols-outlined.show {
            transform: rotate(180deg);
        }

        .fade {
            transition: opacity 0.3s ease, height 0.3s ease;
        }

        .fade-hide {
            opacity: 0;
            min-height: 0;
            max-height: 0;
        }

        .fade-show {
            opacity: 1;
            max-height: 100px;
        }

        .volume-icon-container {
            display: flex;
            align-items: center;
            cursor: default;
            background-color: transparent;
            height: 100%;
            padding: 0 8px;
            user-select: none;
        }

        .volume-icon-container:hover {
            background-color: rgba(255, 255, 255, 0.15);
        }

        .volume-icon-container:active {
            background-color: rgba(255, 255, 255, 0.3);
        }

        .volume-icon-container span {
            font-size: 25px;
            margin-right: -5px;
            color: white;
        }

        .volume-icon-container, .volume-control {
            display: flex;
            align-items: center;
        }

        .volume-svg {
            width: 24px;
            height: 24px;
            fill: none;
            stroke: white;
            stroke-width: 1.5;
            stroke-linecap: round;
            stroke-linejoin: round;
            margin-right: 2px;
        }

        .volume-svg .bar {
            transition: stroke 0.3s ease, opacity 0.3s ease;
        }

        .volume-svg .cross {
            display: none;
            stroke: white;
        }

        .volume-icon-container.muted .volume-svg .bar,
        .volume-control.muted .volume-svg .bar {
            opacity: 0;
        }

        .volume-icon-container.muted .volume-svg .cross,
        .volume-control.muted .volume-svg .cross {
            display: block;
        }

        .volume-panel {
            position: fixed;
            bottom: -300px;
            right: 0px;
            width: 300px;
            background-color: #222222ee;
            color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-top: 0.1px solid #aaaaaa;
            border-left: 0.1px solid #aaaaaa;
            padding: 15px;
            transition: bottom 0.3s ease;
            z-index: 1000;
            cursor: default;
            user-select: none;
            display: none;
            pointer-events: none;
        }

        .volume-panel.active {
            bottom: 40px;
        }

        .volume-header {
            font-size: 15px;
            margin-bottom: 20px;
        }

        .volume-control {
            display: flex;
            align-items: center;
        }

        .volume-control span {
            font-size: 30px;
            font-variation-settings: 'FILL' 0, 'wght' 300, 'grad' 0, 'opsz' 24;
        }

        .volume-control .volume-bars {
            margin-right: 15px;
        }

        .volume-slider {
            flex-grow: 1;
            margin-right: 10px;
        }

        .volume-slider {
            width: 100%;
            appearance: none;
            height: 3px;
            background: linear-gradient(to right, #0078d7 100%, gray 0%);
            outline: none;
        }

        .volume-slider::-webkit-slider-thumb {
            appearance: none;
            width: 10px;
            height: 25px;
            border-radius: 20%;
            background-color: #0078d7;
        }

        .volume-slider:hover::-webkit-slider-thumb {
            background-color: white;
        }

        .volume-icon-container .cross-icon {
            display: none;
            font-size: 14px;
            margin-left: -5px;
            padding: 1px;
        }

        .volume-control .cross-icon {
            font-size: 14px;
            color: white;
            margin-left: -7px;
            display: none;
        }

        .volume-control .volume-icon {
            display: inline;
        }

        .volume-control.muted .cross-icon {
            display: inline;
        }

        .volume-control.muted .volume-icon {
            display: none;
        }

        .volume-icon-container.show-cross .cross-icon {
            display: inline;
        }

        .volume-icon-container.show-cross .volume-bars {
            display: none;
        }

        .volume-panel .volume-icon {
            position: relative;
            cursor: default;
        }

        .volume-panel .volume-icon:hover::after {
            content: attr(title);
            position: absolute;
            top: -35px;
            left: 50%;
            transform: translateX(-50%);
            font-family: "Roboto";
            background-color: #2B2B2B;
            color: #fff;
            border: 0.1px solid #AAAAAA;
            padding: 8px;
            white-space: nowrap;
            font-size: 12px;
            z-index: 10;
        }

        .volume-panel .volume-icon:hover::after {
            visibility: visible;
            opacity: 1;
            transition: opacity 0.5s ease-in-out;
        }

        #volume-indicator {
            position: fixed;
            top: 20px;
            left: 40px;
            background-color: rgba(0, 0, 0, 0.7);
            padding: 15px;
            text-align: center;
            opacity: 0;
            transition: opacity 0.5s ease;
            z-index: 1000;
            cursor: default;
        }

        #volume-indicator.visible {
            opacity: 1;
        }

        #volume-indicator.hidden {
            opacity: 0;
        }

        .volume-bar {
            position: relative;
            width: 20px;
            height: 100px;
            background-color: gray;
            overflow: hidden;
        }

        .gray-background {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 100%;
            background-color: gray;
            z-index: 1;
        }

        .blue-bar {
            position: absolute;
            bottom: 0;
            width: 100%;
            background-color: blue;
            z-index: 2;
        }

        .white-box {
            position: absolute;
            width: 100%;
            height: 15px;
            background-color: white;
            z-index: 3;
            box-sizing: border-box;
        }

        .volume-percentage {
            color: white;
            font-size: 14px;
            font-family: "Arial", sans-serif;
            margin-top: 5px;
            cursor: default;
        }

        .volume-percentage.cross {
            font-family: "Arial", sans-serif;
            font-weight: bold;
            font-size: 18px;
            cursor: default;
        }

        .wifi-icon-container {
            display: flex;
            align-items: center;
            cursor: default;
            background-color: transparent;
            height: 100%;
            padding: 0 8px;
            user-select: none;
        }

        .wifi-icon-container:hover {
            background-color: rgba(255, 255, 255, 0.15);
        }

        .wifi-icon-container:active {
            background-color: rgba(255, 255, 255, 0.3);
        }

        .wifi-icon {
            width: 15px;
            height: auto;
            cursor: default;
            -webkit-user-drag: none;
            transform: scaleX(-1);
            filter: invert(1);
        }

        .wifi-panel {
            position: fixed;
            bottom: 40px;
            right: 0.5px;
            width: 380px;
            height: 530px;
            background-color: #222222fd;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-top: 0.1px solid #aaaaaa80;
            border-left: 0.1px solid #aaaaaa80;
            transform: translateY(100%);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: 9999;
            user-select: none;
            display: none;
            pointer-events: none;
        }

        @keyframes swipeUp {
            from {
                transform: translateY(100%);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes swipeDown {
            from {
                transform: translateY(0);
                opacity: 1;
            }

            to {
                transform: translateY(100%);
                opacity: 0;
            }
        }

        .wifi-panel.active {
            animation: swipeUp 0.3s ease forwards;
        }

        .wifi-panel.hide {
            animation: swipeDown 0.3s ease forwards;
        }

        #wifi-panel .wifi-panel-content {
            display: flex;
            align-items: center;
            background-color: #0767b3;
            justify-content: space-between;
            padding-bottom: 50px;
        }

        #wifi-panel .wifi-panel-content:hover {
            background-color: #0560aa;
        }

        .wifi-icon.my-image {
            filter: invert(1);
            transform: scaleX(-1);
            width: 24px;
            height: auto;
            -webkit-user-drag: none;
            pointer-events: none;
            margin-left: 8px;
        }

        .lock-icon.my-image {
            position: absolute;
            top: -8px;
            left: 5px;
            width: 12px;
            height: auto;
            filter: invert(1);
            -webkit-user-drag: none;
            pointer-events: none;
        }

        #wifi-panel .wifi-info {
            flex-grow: 1;
            padding-left: 10px;
            color: white;
        }

        .wifi-info .wifi-name {
            font-weight: lighter;
        }

        .connected-secured {
            color: #ffffffbb;
            font-weight: normal;
        }

        .wifi-info .status {
            margin-top: 15px;
            font-size: 12px;
            margin-left: 5px;
            color: #ffffffbb;
            text-decoration: underline;
            cursor: pointer;
            font-size: unset;
        }

        .wifi-info .status:hover {
            color: white;
        }

        .wifi-info .status:active {
            color: #ffffffbb;
            text-decoration: underline;
        }

        #wifi-panel button {
            background-color: rgba(255, 255, 255, 0.350);
            color: rgba(255, 255, 255, 0.8);
            border: 2px solid transparent;
            padding: 5px 25px;
            cursor: default;
            position: absolute;
            margin-top: 100px;
            margin-left: 66%;
            font-weight: lighter;
            font-family: 'Segoe UI', sans-serif;
        }

        #wifi-panel button:hover {
            border: 2px solid rgba(255, 255, 255, 0.5);
        }

        #wifi-panel button:active {
            transform: scale(0.95);
            filter: blur(1px);
        }

        .additional-info {
            position: absolute;
            bottom: 0px;
            width: 100%;
            padding: 20px;
            box-sizing: border-box;
            color: white;
            background-color: transparent;
        }

        .text-title {
            color: #81c6ff;
            font-size: unset;
            margin-bottom: 5px;
            cursor: pointer;
        }

        .text-title:hover {
            color: #a8a8a8;
        }

        .text-title:active {
            color: gray;
        }

        .text-subtitle {
            font-size: 12px;
            margin-bottom: 10px;
            color: #a8a8a8;
        }

        .interactive-icon {
            width: 80px;
            height: 80px;
            background-color: #5a5a5a;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            justify-content: space-between;
            text-align: left;
            color: #fff;
            padding: 2px;
            border: 0.1px solid transparent;
            transition: background-color 0.3s, transform 0.2s;
        }

        .interactive-icon:active {
            transform: scale(0.95);
            filter: blur(1px);
        }

        .interactive-icon.selected {
            background-color: #0078d7;
            animation: scaleUpDown 0.2s ease-in-out;
        }

        .interactive-icon:not(.selected):hover {
            background-color: #7a7a7a;
            border: 0.1px solid white;
        }

        .interactive-icon.selected:hover {
            border: 0.1px solid white;
            background-color: #0078d7;
        }

        @keyframes scaleUpDown {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
            }
        }

        .interactive-icon img {
            width: 20px;
            height: 20px;
            margin-bottom: 0;
            pointer-events: none;
            margin-left: 5px;
            align-self: flex-start;
        }

        .interactive-icon p {
            margin-top: 0;
            font-size: 12px;
            color: white;
            font-family: "Arimo", sans-serif;
            font-weight: normal;
            margin-left: 5px;
            align-self: flex-start;
        }

        .additional-info .interactive-icon {
            display: inline-flex;
            gap: 1px;
        }

        .wifi-panel-new-content {
            display: none;
            position: relative;
            padding: 20px;
            background-color: #333;
            color: white;
            text-align: center;
        }

        .no-wifi-content h3 {
            font-size: 18px;
            margin-bottom: 10px;
        }

        .no-wifi-content p {
            font-size: 14px;
            margin-bottom: 20px;
        }

        .no-wifi-content button {
            background-color: #0078d7;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 5px;
            font-family: 'Segoe UI', sans-serif;
        }

        .no-wifi-content button:hover {
            background-color: #005a9e;
        }

        .loading-animation {
            display: none;
            position: absolute;
            top: 10px;
            left: 10px;
            width: calc(100% - 20px);
            height: 20px;
            overflow: hidden;
            display: flex;
            align-items: center;
        }

        .loading-animation .dots-wrapper {
            display: flex;
            width: fit-content;
            animation: moveLeftRight 3s linear infinite;
        }

        .loading-animation .dot {
            width: 10px;
            height: 10px;
            background-color: white;
            border-radius: 50%;
            margin: 0 5px;
        }

        @keyframes moveLeftRight {
            0% {
                transform: translateX(0);
            }

            100% {
                transform: translateX(calc(-100% + 100vw));
            }
        }

        .wifi-panel-new-content {
            display: none;
        }

        .loading {
            display: none;
            font-size: 14px;
            color: #666;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top: 4px solid #3498db;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-right: 30px;
            margin-top: 10px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        #wifi-panel button.connecting {
            margin-left: 65%;
            padding: 5px 10px;
            cursor: not-allowed;
        }

        .battery-icon-container {
            display: flex;
            align-items: center;
            cursor: default;
            background-color: transparent;
            height: 100%;
            padding: 0 8px;
            user-select: none;
        }

        .battery-icon-container:hover {
            background-color: rgba(255, 255, 255, 0.15);
        }

        .battery-icon-container:active {
            background-color: rgba(255, 255, 255, 0.3);
        }

        .battery-icon {
            width: 20px;
            height: auto;
            cursor: default;
            -webkit-user-drag: none;
            user-select: none;
        }

        .battery-panel {
            position: fixed;
            bottom: 39.51px;
            right: 5px;
            width: 350px;
            height: 270px;
            padding: 15px;
            border: 0.1px solid #aaaaaa80;
            color: white;
            background-color: #222222fd;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transform: translateY(100%);
            opacity: 0;
            transition: opacity 0.3s ease, transform 0.3s ease;
            z-index: 9999;
            user-select: none;
            display: none;
            pointer-events: none;
        }

        .battery-panel.active {
            transform: translateY(0);
            opacity: 1;
        }

        .battery-panel-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .battery-panel-title {
            font-size: 40px;
            font-family: 'Astrid Grotesk Light', sans-serif;
            margin-left: 20px;
        }

        .battery-panel-content p {
            margin: 0;
            padding: 5px 0;
            color: #b1b1b1;
            font-size: 16px;
        }

        .battery-panel-content p:last-of-type {
            margin-top: 20px;
            color: rgb(140, 207, 229);
            cursor: pointer;
        }

        .battery-panel-content p:last-of-type:hover {
            color: #a8a8a8;
        }

        .battery-panel-content p:last-of-type:active {
            color: gray;
        }

        .battery-button-icon {
            width: 80px;
            height: 80px;
            background-color: #5a5a5a;
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            justify-content: space-between;
            text-align: left;
            color: #fff;
            padding: 2px;
            border: 0.1px solid transparent;
            transition: background-color 0.3s, transform 0.2s;
        }

        .battery-button-icon:active {
            transform: scale(0.95);
            filter: blur(1px);
        }

        .battery-button-icon.selected {
            background-color: #0078d7;
            animation: scaleUpDown 0.2s ease-in-out;
        }

        .battery-button-icon:not(.selected):hover {
            background-color: #7a7a7a;
            border: 0.1px solid white;
        }

        .battery-button-icon.selected:hover {
            border: 0.1px solid white;
            background-color: #0078d7;
        }

        @keyframes scaleUpDown {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.1);
            }

            100% {
                transform: scale(1);
            }
        }

        .battery-button-icon img {
            width: 20px;
            height: 20px;
            margin-bottom: 0;
            pointer-events: none;
            margin-left: 5px;
            align-self: flex-start;
        }

        .battery-button-icon p {
            margin-top: 0;
            font-size: 12px;
            color: white;
            font-family: "Arimo", sans-serif;
            font-weight: normal;
            margin-left: 5px;
            align-self: flex-start;
        }

        .battery-panel-header img.battery-saver {
            filter: invert(1);
        }

        .up-icon-container {
            margin-left: auto;
            display: flex;
            align-items: center;
            cursor: default;
            background-color: transparent;
            height: 100%;
            padding: 0 8px;
            user-select: none;
        }

        .up-icon-container:hover {
            background-color: rgba(255, 255, 255, 0.15);
        }

        .up-icon-container:active {
            background-color: rgba(255, 255, 255, 0.3);
        }

        .up-icon {
            width: 30px;
            height: auto;
            cursor: default;
            -webkit-user-drag: none;
            user-select: none;
        }

        .hidden-icons-panel {
            position: fixed;
            bottom: 39.5px;
            right: 200px;
            width: 80px;
            height: 80px;
            padding: 10px;
            background-color: #222222fd;
            color: white;
            border: 0.1px solid #aaaaaa80;
            box-shadow: -2px -2px 10px rgba(0, 0, 0, 0.1),
                2px -2px 10px rgba(0, 0, 0, 0.1),
                0 -2px 10px rgba(0, 0, 0, 0.1);
            transform: translateY(100%);
            opacity: 0;
            transition: opacity 0.3s ease, transform 0.3s ease;
            z-index: 10000;
            font-size: 12px;
            display: none;
            user-select: none;
        }

        .hidden-icons-panel.active {
            transform: translateY(0);
            opacity: 1;
            display: block;
        }

        .icon-box {
            padding: 0px;
        }

        .icon-row {
            display: flex;
            justify-content: space-between;
        }

        .hidden-icon {
            width: 35px;
            height: 35px;
        }

        .hidden-icon:hover {
            background-color: rgba(255, 255, 255, 0.15);
        }

        .hidden-icon:active {
            background-color: rgba(255, 255, 255, 0.3);
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        @keyframes refreshFlash {
            0% { 
                opacity: 0;
            }
            50% { 
                opacity: 0.3;
            }
            100% { 
                opacity: 0;
            }
        }
        
        .refresh-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: white;
            pointer-events: none;
            opacity: 0;
            z-index: 99999;
        }
        
        .refresh-overlay.flash {
            animation: refreshFlash 200ms ease-in-out;
        }
        
        .selection-box {
            position: absolute;
            border: 2px solid #1e73bc;
            background-color: #0084ff85;
            pointer-events: none;
            display: none;
        }

        .desktop-shortcut {
            position: absolute;
            width: 90px;
            height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            cursor: default;
            padding: 8px;
            border: 1px solid transparent;
            user-select: none;
            z-index: 10;
        }

        .desktop-shortcut:hover {
            background-color: rgba(255, 255, 255, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .desktop-shortcut.dragging {
            opacity: 0.8;
            z-index: 100;
        }

        .desktop-shortcut img {
            width: 40px;
            height: 40px;
            margin-bottom: 5px;
            -webkit-user-drag: none;
            user-select: none;
        }

        .desktop-shortcut i {
            font-size: 35px;
            margin-bottom: 8px;
        }

        .desktop-shortcut span {
            font-size: 11px;
            text-align: center;
            text-shadow: 1px 1px 2px black;
            width: 100%;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Window System Styles */
        .window {
            position: absolute;
            top: 50px;
            left: 100px;
            width: 900px;
            height: 600px;
            background-color: #1e1e1e;
            border: 1px solid #444;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: none;
            flex-direction: column;
            z-index: 1000;
            overflow: hidden;
            border-radius: 4px;
        }

        .window.active {
            display: flex;
        }

        .window-header {
            height: 35px;
            background-color: #323233;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 0 0 10px;
            cursor: move;
            user-select: none;
        }

        .window-title {
            color: #ccc;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .window-title img {
            width: 16px;
            height: 16px;
        }

        .window-controls {
            display: flex;
            height: 100%;
        }

        .control-btn {
            width: 45px;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 12px;
            transition: background-color 0.2s;
            cursor: pointer;
        }

        .control-btn:hover {
            background-color: rgba(255,255,255,0.1);
        }

        .control-btn.close:hover {
            background-color: #e81123;
        }

        .window-body {
            flex: 1;
            display: flex;
            background-color: #1e1e1e;
        }

        .vscode-sidebar {
            width: 50px;
            background-color: #333333;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 10px;
            gap: 20px;
            color: #858585;
        }

        .vscode-sidebar i {
            font-size: 20px;
            cursor: pointer;
        }

        .vscode-sidebar i:hover {
            color: #fff;
        }

        .vscode-explorer {
            width: 200px;
            background-color: #252526;
            color: #cccccc;
            padding: 10px;
            font-size: 11px;
            border-right: 1px solid #333;
        }

        .vscode-editor {
            flex: 1;
            padding: 10px;
            background-color: #1e1e1e;
            overflow: auto;
            position: relative;
        }

        .vscode-editor textarea {
            width: 100%;
            height: 100%;
            background: transparent;
            border: none;
            color: #d4d4d4;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            outline: none;
            resize: none;
            padding: 10px;
            box-sizing: border-box;
        }

        /* VS Code Syntax Highlighting */
        .vscode-code {
            width: 100%;
            height: 100%;
            background: transparent;
            border: none;
            color: #d4d4d4;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            outline: none;
            padding: 10px;
            box-sizing: border-box;
            white-space: pre;
            overflow: auto;
        }

        .vscode-code[contenteditable="true"]:empty:before {
            content: attr(placeholder);
            color: #666;
        }

        /* Syntax Colors */
        .syntax-comment { color: #6a9955; font-style: italic; }
        .syntax-tag { color: #569cd6; }
        .syntax-bracket { color: #808080; }
        .syntax-attribute { color: #9cdcfe; }
        .syntax-string { color: #ce9178; }
        .syntax-text { color: #d4d4d4; }

        .window.maximized {
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: calc(100% - 40px) !important;
            border-radius: 0;
            border: none;
        }

        /* Sticky Notes specific styles */
        .window.sticky-note {
            width: 300px;
            height: 300px;
            background-color: #fff7d1;
            border: none;
            box-shadow: 2px 2px 10px rgba(0,0,0,0.2);
        }

        .window.sticky-note .window-header {
            background-color: #fff2ab;
            height: 30px;
        }

        .window.sticky-note .window-title {
            color: #666;
        }

        .window.sticky-note .control-btn {
            color: #666;
        }

        .window.sticky-note .control-btn:hover {
            background-color: rgba(0,0,0,0.05);
        }

        .window.sticky-note .vscode-editor {
            background-color: #fff7d1;
        }

        .window.sticky-note .vscode-editor textarea {
            background-color: #fff7d1;
            color: #000;
            font-family: 'Segoe UI', sans-serif;
            font-size: 16px;
        }

        /* Sticky Note Color Picker */
        .sticky-color-picker {
            position: absolute;
            top: 35px;
            left: 10px;
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 4px;
            padding: 8px;
            display: none;
            z-index: 10000;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .sticky-color-picker.show {
            display: flex;
            gap: 8px;
        }

        .color-option {
            width: 30px;
            height: 30px;
            border-radius: 4px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: border 0.2s, transform 0.1s;
        }

        .color-option:hover {
            border: 2px solid #666;
            transform: scale(1.1);
        }

        .color-yellow { background-color: #fff7d1; }
        .color-blue { background-color: #d1e7ff; }
        .color-green { background-color: #d1ffd7; }
        .color-pink { background-color: #ffd1e7; }
        .color-purple { background-color: #e7d1ff; }
        .color-orange { background-color: #ffe7d1; }

        /* Browser Window Styles */
        .browser-toolbar {
            height: 40px;
            background-color: #f1f3f4;
            display: flex;
            align-items: center;
            padding: 0 10px;
            gap: 10px;
            border-bottom: 1px solid #ddd;
        }

        .browser-nav-btns {
            display: flex;
            gap: 8px;
            color: #5f6368;
        }

        .browser-nav-btns i {
            padding: 8px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 14px;
        }

        .browser-nav-btns i:hover {
            background-color: rgba(0,0,0,0.1);
        }

        .browser-address-bar {
            flex: 1;
            background-color: #fff;
            height: 28px;
            border-radius: 14px;
            display: flex;
            align-items: center;
            padding: 0 15px;
            border: 1px solid #dfe1e5;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
        }

        .browser-address-bar input {
            width: 100%;
            border: none;
            outline: none;
            font-size: 13px;
            color: #3c4043;
        }

        .browser-content {
            flex: 1;
            background-color: #fff;
            position: relative;
        }

        .browser-content iframe {
            width: 100%;
            height: 100%;
            border: none;
            background-color: #fff;
        }

        /* File Explorer Styles */
        .explorer-container {
            display: flex;
            width: 100%;
            height: 100%;
            background-color: #fff;
            color: #333;
        }

        .explorer-sidebar {
            width: 200px;
            background-color: #f0f0f0;
            border-right: 1px solid #ddd;
            padding: 10px 0;
            font-size: 13px;
            overflow-y: auto;
        }

        .sidebar-item {
            padding: 5px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
        }

        .sidebar-item:hover {
            background-color: #e5e5e5;
        }

        .sidebar-item.active {
            background-color: #cce8ff;
        }

        .sidebar-header {
            padding: 10px 20px 5px 20px;
            font-weight: bold;
            color: #666;
            font-size: 11px;
            text-transform: uppercase;
        }

        .explorer-main {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .explorer-nav {
            height: 40px;
            border-bottom: 1px solid #ddd;
            display: flex;
            align-items: center;
            padding: 0 10px;
            gap: 15px;
        }

        .path-bar {
            flex: 1;
            height: 25px;
            border: 1px solid #ddd;
            display: flex;
            align-items: center;
            padding: 0 10px;
            font-size: 13px;
            background: #fff;
        }

        .explorer-content-area {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .explorer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 20px;
        }

        .explorer-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            gap: 5px;
            cursor: pointer;
            padding: 10px;
            border: 1px solid transparent;
        }

        .explorer-item:hover {
            background-color: #e5f3ff;
            border-color: #cce8ff;
        }

        .explorer-item img {
            width: 48px;
            height: 48px;
        }

        .explorer-item span {
            font-size: 12px;
            word-wrap: break-word;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            line-height: 1.2;
            max-height: 2.4em;
        }


        /* Recycle Bin Window */
        .recycle-bin-content {
            display: flex;
            flex-direction: column;
            width: 100%;
            height: 100%;
            background-color: white;
        }

        .recycle-bin-toolbar {
            height: 40px;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            padding: 0 10px;
            border-bottom: 1px solid #ccc;
            gap: 20px;
        }

        .toolbar-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 3px;
        }

        .toolbar-item:hover {
            background-color: #e5e5e5;
        }

        .recycle-bin-grid {
            flex: 1;
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            grid-auto-rows: min-content;
            gap: 20px;
            overflow-y: auto;
            align-items: start;
        }

        .deleted-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            border: 1px solid transparent;
            cursor: default;
            height: fit-content;
        }

        .deleted-item:hover {
            background-color: #e5f3ff;
            border: 1px solid #cce8ff;
        }

        .deleted-item img {
            width: 40px;
            height: 40px;
            margin-bottom: 5px;
        }

        .deleted-item span {
            font-size: 12px;
            text-align: center;
            color: #333;
        }
    </style>
</head>

<body>
    <!-- Refresh overlay -->
    <div class="refresh-overlay" id="refreshOverlay"></div>
    
    <div class="context-menu" id="contextMenu">
        <ul>
            <li class="menu-item">View <i class="fa-solid fa-chevron-right arrow"></i>
                <ul class="submenu">
                    <li><a href="#">Large icons</a></li>
                    <li><a href="#"><i class="fa-solid fa-circle" style="font-size: 5px;"></i> Medium icons</a></li>
                    <li><a href="#">Small icons</a></li>
                    <hr>
                    <li><a href="#">Auto arrange icons</a></li>
                    <li><a href="#" class="checked">Align icons to grid</a></li>
                    <hr>
                    <li><a href="#" class="checked">Show desktop icons</a></li>
                </ul>
            </li>
            <li class="menu-item">Sort by <i class="fa-solid fa-chevron-right arrow"></i>
                <ul class="submenu">
                    <li><a href="#">Name</a></li>
                    <li><a href="#">Size</a></li>
                    <li><a href="#">Item type</a></li>
                    <li><a href="#">Date Modified</a></li>
                </ul>
            </li>
            <li><a href="#">Refresh</a></li>
            <hr>
            <li class="disabled">Paste</li>
            <li class="disabled">Paste shortcut</li>
            <hr>
            <li><a href="#">Graphics Properties...</a></li>
            <li class="menu-item">Graphics Options <i class="fa-solid fa-chevron-right arrow"></i>
                <ul class="submenu">
                    <li class="menu-item">Panel Fit <i class="fa-solid fa-chevron-right arrow"></i>
                        <ul class="submenu">
                            <li><a href="#" class="checked">Maintain Display Scaling</a></li>
                        </ul>
                    </li>
                    <li class="menu-item">Hot Keys <i class="fa-solid fa-chevron-right arrow"></i>
                        <ul class="submenu">
                            <li><a href="#" class="checked">Enable</a></li>
                            <li><a href="#">Disable</a></li>
                        </ul>
                    </li>
                    <li class="menu-item">Tray Icon <i class="fa-solid fa-chevron-right arrow"></i>
                        <ul class="submenu">
                            <li><a href="#" class="checked">Enable</a></li>
                            <li><a href="#">Disable</a></li>
                        </ul>
                    </li>
                    <li class="menu-item">Balloon Notification&nbsp; <i class="fa-solid fa-chevron-right arrow"></i>
                        <ul class="submenu">
                            <li class="menu-item">Graphics Properties Notification&nbsp; <i
                                    class="fa-solid fa-chevron-right arrow"></i>
                                <ul class="submenu">
                                    <li><a href="#">Enable</a></li>
                                    <li><a href="#" class="checked">Disable</a></li>
                                </ul>
                            </li>
                            <li class="menu-item">Optimal Resolution Notification&nbsp; <i
                                    class="fa-solid fa-chevron-right arrow"></i>
                                <ul class="submenu">
                                    <li><a href="#" class="checked">Enable</a></li>
                                    <li><a href="#">Disable</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li class="menu-item">Rotation <i class="fa-solid fa-chevron-right arrow"></i>
                        <ul class="submenu">
                            <li><a href="#" class="checked">Rotate To Normal</a></li>
                            <li><a href="#">Rotate To 90 Degrees</a></li>
                            <li><a href="#">Rotate To 180 Degrees</a></li>
                            <li><a href="#">Rotate To 270 Degrees</a></li>
                        </ul>
                    </li>
                </ul>
            </li>
            <hr>
            <li class="menu-item">New <i class="fa-solid fa-chevron-right arrow"></i>
                <ul class="submenu">
                    <li id="menu-new-folder"><a href="#"><img src="assets/images/Folder.png"
                                style="width: 16px; height: 16px; margin-right: 8px; pointer-events: none; user-select: none;"
                                alt="Folder Icon"> Folder</a></li>
                    <li id="menu-new-shortcut"><a href="#"><img src="assets/images/Shortcut.png"
                                style="width: 16px; height: 16px; margin-right: 8px; pointer-events: none; user-select: none;"
                                alt="Folder Icon"> Shortcut</a></li>
                    <hr>
                    <li><img src="assets/images/Bitmap image.png"
                            style="width: 16px; height: 16px; margin-right: 8px; pointer-events: none; user-select: none;"
                            alt="Folder Icon"> Bitmap image</li>
                    <li><img src="assets/images/WinRAR archive.png"
                            style="width: 16px; height: 16px; margin-right: 8px; pointer-events: none; user-select: none;"
                            alt="Folder Icon"> WinRAR archive</li>
                    <li><img src="assets/images/Rich Text Document.png"
                            style="width: 16px; height: 16px; margin-right: 8px; pointer-events: none; user-select: none;"
                            alt="Folder Icon"> Rich Text Document</li>
                    <li><img src="assets/images/Text Document.png"
                            style="width: 16px; height: 16px; margin-right: 8px; pointer-events: none; user-select: none;"
                            alt="Folder Icon"> Text Document</li>
                    <li><img src="assets/images/WinRAR archive.png"
                            style="width: 16px; height: 16px; margin-right: 8px; pointer-events: none; user-select: none;"
                            alt="Folder Icon"> WinRAR ZIP archive</li>
                </ul>
            </li>
            <hr>
            <li><a href="#">Display settings</a></li>
            <li id="menu-personalize"><a href="#">Personalize</a></li>
        </ul>
    </div>
    <input type="file" id="bg-input" accept="image/*" style="display: none;">

    <!-- Loading Screen -->
    <div class="loader-container" id="loaderContainer">
        <!-- Screen Mode Selector -->
        <div class="screen-mode-selector">
            <div class="dropdown-container" id="screenModeDropdown">
                <div class="dropdown-selected">
                    <span id="selectedMode">Normal Mode</span>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="dropdown-options">
                    <div class="dropdown-option" data-mode="normal">
                        <i class="fas fa-window-restore"></i>
                        <span>Normal Mode</span>
                    </div>
                    <div class="dropdown-option" data-mode="fullscreen">
                        <i class="fas fa-expand"></i>
                        <span>Full Screen</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="music-waves">
            <svg class="wave-svg" viewBox="0 0 2000 200" preserveAspectRatio="none">
                <path class="wave-path wave-path-1" d="M 0 100 Q 250 80, 500 100 T 1000 100 T 1500 100 T 2000 100" />
                <path class="wave-path wave-path-2" d="M 0 120 Q 250 100, 500 120 T 1000 120 T 1500 120 T 2000 120" />
                <path class="wave-path wave-path-3" d="M 0 140 Q 250 120, 500 140 T 1000 140 T 1500 140 T 2000 140" />
            </svg>
        </div>
        <div class="avatar-container">
            <img src="assets/images/avatar.png" alt="Avatar" class="avatar-image" 
                 onerror="console.error('Avatar image failed to load:', this.src); this.style.border='4px solid red';">
        </div>
        <div class="greeting-text"></div>
        <div class="loader">
            <div class="bg"></div>
            <div class="circle"></div>
            <div class="circle"></div>
            <div class="circle"></div>
            <div class="circle"></div>
            <div class="circle"></div>
        </div>
    </div>

    <!-- Power Options Modal -->
    <div class="power-modal" id="powerModal">
        <div class="power-options">
            <div class="power-option" id="sleepOption">
                <i class="fas fa-moon"></i>
                <span>Sleep</span>
            </div>
            <div class="power-option" id="shutdownOption">
                <i class="fas fa-power-off"></i>
                <span>Shut down</span>
            </div>
            <div class="power-option" id="restartOption">
                <i class="fas fa-redo"></i>
                <span>Restart</span>
            </div>
        </div>
    </div>

    <!-- Sleep Screen -->
    <div class="sleep-screen" id="sleepScreen">
        <img src="assets/images/avatar.png" alt="Avatar" class="sleep-avatar">
        <div class="sleep-text">Your PC is sleeping</div>
        <button class="wake-button" id="wakeButton">Wake up</button>
    </div>

    <div class="background-image">
        <div class="desktop-shortcut" id="shortcut-trash" style="top: 20px; left: 20px;">
            <img src="assets/images/recycle-bin.png" alt="Recycle Bin" id="trash-icon" draggable="false">
            <span>Recycle Bin</span>
        </div>
        <div class="desktop-shortcut" id="shortcut-pc" style="top: 120px; left: 20px;">
            <img src="assets/images/This PC.png" alt="This PC" draggable="false">
            <span>This PC</span>
        </div>
        <div class="desktop-shortcut" id="shortcut-chrome" style="top: 220px; left: 20px;">
            <img src="assets/images/Chrome.png" alt="Chrome" draggable="false">
            <span>Google Chrome</span>
        </div>
        <div class="desktop-shortcut" id="shortcut-notepad" style="top: 320px; left: 20px;">
            <img src="assets/images/Notepad.webp" alt="Notepad" draggable="false">
            <span>Notepad</span>
        </div>
        <div class="desktop-shortcut" id="shortcut-sticky" style="top: 420px; left: 20px;">
            <img src="assets/images/Sticky Notes.png" alt="Sticky Notes" draggable="false">
            <span>Sticky Notes</span>
        </div>
        <div class="desktop-shortcut" id="shortcut-cmd" style="top: 520px; left: 20px;">
            <img src="assets/images/Command Prompt.png" alt="Command Prompt" draggable="false">
            <span>Command Prompt</span>
        </div>
        <div class="desktop-shortcut" id="shortcut-vscode" style="top: 20px; left: 120px;">
            <img src="assets/images/Visual Studio Code.svg" alt="Visual Studio Code" draggable="false">
            <span>Visual Studio Code</span>
        </div>
        <div class="desktop-shortcut" id="shortcut-paint" style="top: 120px; left: 120px;">
            <img src="assets/images/Paint.png" alt="Paint" draggable="false">
            <span>Paint</span>
        </div>
    </div>

    <div class="search-panel">
        <div class="top-bar">
            <div class="options">
                <div title="Find the most relevant results on this PC and the web" class="option selected">All</div>
                <div title="Find results in Apps" class="option">Apps</div>
                <div title="Find results in Documents" class="option">Documents</div>
                <div title="Find results in Web" class="option">Web</div>
                <div class="more-options">
                    <div class="option" title="More filters">More <i class="fas fa-chevron-down"></i></div>
                    <div class="dropdown">
                        <div class="option">Folders</div>
                        <div class="option">Music</div>
                        <div class="option">Photos</div>
                        <div class="option">Settings</div>
                        <div class="option">Videos</div>
                    </div>
                </div>
            </div>
            <div class="user-account">
                <img title="Account" style="filter: invert(1) brightness(2);" src="assets/images/User.png" alt="User Avatar">
                <div class="dots">
                    <i title="Options" class="fas fa-ellipsis-h"></i>
                    <div class="dropdown">
                        <div class="option">
                            <img style="filter: invert(1) brightness(2);" src="assets/images/Search Setting.png"
                                alt="Search Settings Icon"> Search settings
                        </div>
                        <div class="option">
                            <img style="filter: invert(1) brightness(2);" src="assets/images/Indexing Options.png"
                                alt="Indexing Options Icon"> Indexing options
                        </div>
                        <hr>
                        <div class="option">
                            <img style="border-radius: 0%;" src="assets/images/FeedBack.svg" alt="Feedback Icon"> Feedback
                        </div>
                    </div>
                </div>
                <div title="Close Windows Search" class="close-btn"><i class="fas fa-times"></i></div>
            </div>
        </div>

        <div class="search-content">
            <!-- Content sections -->
            <div id="apps-content" class="content-section" style="display: none;">
                <h2>Frequent</h2>
                <div class="apps-container">
                    <div class="app-item" title="File Explorer">
                        <img src="assets/images/File Explorer.png" alt="File Explorer" class="app-icon">
                        <div class="app-text">File Explorer</div>
                    </div>
                    <div class="app-item" title="Google Chrome">
                        <img src="assets/images/Chrome.png" alt="Google Chrome" class="app-icon">
                        <div class="app-text">Google Chrome</div>
                    </div>
                    <div class="app-item" title="WhatsApp">
                        <img src="assets/images/WhatsApp.svg" alt="WhatsApp" class="app-icon">
                        <div class="app-text">WhatsApp</div>
                    </div>
                    <div class="app-item" title="Microsoft Edge">
                        <img src="assets/images/Microsoft Edge.png" alt="Microsoft Edge" class="app-icon">
                        <div class="app-text">Microsoft Edge</div>
                    </div>
                    <div class="app-item" title="Photos">
                        <img src="assets/images/Photos.png" alt="Photos" class="app-icon">
                        <div class="app-text">Photos</div>
                    </div>
                </div>
            </div>

            <!-- Content sections -->
            <div id="documents-content" class="content-section" style="display: none;">
                <div class="image-container">
                    <img src="assets/images/File.svg" alt="Search Image">
                </div>
                <h2>Search documents</h2>
                <p>Start typing to search for documents</p>
            </div>

            <div id="web-content" class="content-section" style="display: none;">
                <div class="image-container">
                    <img src="assets/images/Web.png" alt="Web">
                </div>
                <h2>Search the web</h2>
                <p>Start typing to search the web</p>
            </div>
        </div>

        <div class="suggested-title">Suggested</div>
        <div class="suggested-apps">
            <div class="suggested-app" id="search-app-calculator" title="Calculator">
                <img src="assets/images/Calculator.png" alt="Calculator">
                <div class="app-name">Calculator</div>
            </div>
            <hr>
            <div class="suggested-app" id="search-app-calendar" title="Calendar">
                <img src="assets/images/Calendar.png" alt="Calendar">
                <div class="app-name">Calendar</div>
            </div>
            <hr>
            <div class="suggested-app" title="Microsoft Edge">
                <img src="assets/images/Microsoft Edge.png" alt="Microsoft Edge">
                <div class="app-name">Microsoft Edge</div>
            </div>
            <hr>
            <div class="suggested-app" title="Tips">
                <img src="assets/images/Tips.png" alt="Tips">
                <div class="app-name">Tips</div>
            </div>
            <hr>
            <div class="suggested-app" title="Email and accounts">
                <img src="assets/images/Email and accounts.png" alt="Email and accounts">
                <div class="app-name">Email and accounts</div>
            </div>
            <hr>
            <div class="suggested-app" title="Snipping Tool">
                <img src="assets/images/Snipping Tool.svg" alt="Snipping Tool">
                <div class="app-name">Snipping Tool</div>
            </div>
            <hr>
            <div class="suggested-app" title="Check for updates">
                <img style="filter: invert(1) brightness(2);" src="assets/images/Check for updates.svg" alt="Check for updates">
                <div class="app-name">Check for updates</div>
            </div>
            <hr>
            <div class="suggested-app" title="This PC">
                <img src="assets/images/This PC.png" alt="This PC">
                <div class="app-name">This PC</div>
            </div>
            <hr>
            <div class="suggested-app" title="Paint">
                <img src="assets/images/Paint.png" alt="Paint">
                <div class="app-name">Paint</div>
            </div>
            <hr>
            <div class="suggested-app" title="Themes and related settings">
                <img src="assets/images/Themes and related settings.png" alt="Themes and related settings">
                <div class="app-name">Themes and related settings</div>
            </div>
            <hr>
            <div class="suggested-app" title="Notepad">
                <img src="assets/images/Notepad.webp" alt="Notepad">
                <div class="app-name">Notepad</div>
            </div>
            <hr>
            <div class="suggested-app" title="File Explorer">
                <img src="assets/images/File Explorer.png" alt="File Explorer">
                <div class="app-name">File Explorer</div>
            </div>
        </div>

        <!-- Top Apps -->
        <div class="top-apps-title">Top Apps</div>
        <div class="top-apps-grid">
            <div class="app-container" title="File Explorer">
                <img src="assets/images/File Explorer.png" alt="File Explorer">
                <div class="app-name">File Explorer</div>
            </div>
            <div class="app-container" title="Google Chrome">
                <img src="assets/images/Chrome.png" alt="Google Chrome">
                <div class="app-name">Google Chrome</div>
            </div>
            <div class="app-container" title="WhatsApp">
                <img src="assets/images/WhatsApp.svg" alt="WhatsApp">
                <div class="app-name">WhatsApp</div>
            </div>
            <div class="app-container" title="Microsoft Edge">
                <img src="assets/images/Microsoft Edge.png" alt="Microsoft Edge">
                <div class="app-name">Microsoft Edge</div>
            </div>
            <div class="app-container" title="Photos">
                <img src="assets/images/Photos.png" alt="Photos">
                <div class="app-name">Photos</div>
            </div>
            <div class="app-container" title="Visual Studio Code">
                <img src="assets/images/Visual Studio Code.svg" alt="Visual Studio Code">
                <div class="app-name"
                    style="display: inline-block; width: 100px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; transition: width 0.3s ease;"
                    onmouseover="this.style.width='auto'; this.style.overflow='visible';"
                    onmouseout="this.style.width='100px'; this.style.overflow='hidden';">Visual Studio Code</div>
            </div>
            <div class="app-container" id="top-app-calculator" title="Calculator">
                <img src="assets/images/Calculator.png" alt="Calculator">
                <div class="app-name">Calculator</div>
            </div>
            <div class="app-container" id="top-app-calendar" title="Calendar">
                <img src="assets/images/Calendar.png" alt="Calendar">
                <div class="app-name">Calendar</div>
            </div>
        </div>

        <!-- Quick Searches -->
        <div class="quick-searches-title">Quick Searches</div>
        <div class="quick-searches">
            <div class="quick-search" title="Web search for weather">
                <img src="assets/images/Weather Search.png" alt="Weather">
                <div class="search-title">Weather</div>
            </div>
            <hr>
            <div class="quick-search" title="Web search for news">
                <img style="filter: invert(1) brightness(2);" src="assets/images/News.png" alt="Top News">
                <div class="search-title">Top News</div>
            </div>
            <hr>
            <div class="quick-search" title="Web search for history">
                <img style="filter: invert(1) brightness(2);" src="assets/images/History.svg" alt="Today in History">
                <div class="search-title">Today in History</div>
            </div>
        </div>
    </div>

    <!-- Shortcut Context Menu -->
    <div id="shortcutContextMenu" class="context-menu">
        <ul>
            <li id="menu-shortcut-open">
                <i class="fas fa-folder-open"></i>
                <span>Open</span>
            </li>
            <hr>
            <li id="menu-shortcut-pin">
                <i class="fas fa-thumbtack"></i>
                <span>Pin to taskbar</span>
            </li>
            <hr>
            <li id="menu-shortcut-delete">
                <i class="fas fa-trash"></i>
                <span>Delete</span>
            </li>
            <li id="menu-shortcut-rename">
                <i class="fas fa-edit"></i>
                <span>Rename</span>
            </li>
            <hr>
            <li id="menu-shortcut-properties">
                <i class="fas fa-cog"></i>
                <span>Properties</span>
            </li>
        </ul>
    </div>

    <!-- Taskbar Icon Context Menu -->
    <div id="taskbarIconContextMenu" class="context-menu">
        <ul>
            <li id="menu-taskbar-close">
                <i class="fas fa-times"></i>
                <span>Close window</span>
            </li>
            <hr>
            <li id="menu-taskbar-unpin">
                <i class="fas fa-thumbtack"></i>
                <span>Unpin from taskbar</span>
            </li>
        </ul>
    </div>

    <!-- Context Menu -->
    <div id="taskbarContextMenu" class="taskbar-context-menu">
        <ul>
            <li>
                <span>Toolbars</span>
                <i class="fas fa-chevron-right right-icon"></i>
                <div class="sub-menu">
                    <ul>
                        <li>Address</li>
                        <li>Links</li>
                        <li>Desktop</li>
                        <hr>
                        <li>New toolbar...</li>
                    </ul>
                </div>
            </li>
            <hr>
            <li>
                <span>Search</span>
                <i class="fas fa-chevron-right right-icon"></i>
                <div class="sub-menu">
                    <ul>
                        <li>Hidden</li>
                        <li><span>Show search icon</span></li>
                        <li><i class="fa-solid fa-check left-icon"></i><span>Show search box</span></li>
                        <hr>
                        <li><i class="fa-solid fa-check left-icon"></i><span>Show search highlights</span></li>
                        <li><i class="fa-solid fa-check left-icon"></i>Open on hover</li>
                    </ul>
                </div>
            </li>
            <li>
                <span>News and interests</span>
                <i class="fas fa-chevron-right right-icon"></i>
                <div class="sub-menu">
                    <ul>
                        <li>Show icon and text</li>
                        <li>Show icon only</li>
                        <li><i class="fa-solid fa-check left-icon"></i>Turn off</li>
                        <hr>
                        <li>Reduce taskbar updates</li>
                        <li><i class="fa-solid fa-check left-icon"></i>Open on hover</li>
                    </ul>
                </div>
            </li>
            <li>
                <i class="fa-solid fa-check left-icon"></i>
                <span>Show Task View button</span>
            </li>
            <li>Show People on the taskbar</li>
            <li>Show Windows Ink Workspace button</li>
            <li>Show touch keyboard button</li>
            <hr>
            <li>Cascade windows</li>
            <li>Show windows stacked</li>
            <li>Show windows side by side</li>
            <li>Show the desktop</li>
            <hr>
            <li>Task Manager</li>
            <hr>
            <li>
                <i class="fa-solid fa-check left-icon"></i>
                <span>Lock the taskbar</span>
            </li>
            <li>
                <i class="fa-solid fa-gear left-icon"></i>
                <span>Taskbar settings</span>
            </li>
        </ul>
    </div>

    <div class="taskbar">
        <div title="Start" class="windows-icon"></div>
        <div class="search-container">
            <img src="assets/images/Search.svg" alt="Search Icon" class="search-icon" id="searchIcon">
            <input type="text" class="search-box" placeholder="Type here to search">
            <img src="assets/images/Cave.png" alt="Search Panel" class="search-panel-icon" title="Search highlights">
        </div>
        <div class="task-view-icon" title="Task View">
            <img src="assets/images/Task View.svg" class="default-img" alt="Task View">
            <img style="width: 30px; height: auto;" src="assets/images/Task View Open.svg" class="hover-img" alt="Task View Open">
        </div>
        <!-- App icons -->
        <div class="apps-icon" title="File Explorer" id="explorer-taskbar-icon">
            <img src="assets/images/File Explorer.png" alt="File Explorer">
        </div>
        <div class="apps-icon" title="Microsoft Store">
            <img src="assets/images/Microsoft Store.svg" alt="Microsoft Store">
        </div>
        <div class="apps-icon" title="Microsoft Edge">
            <img src="assets/images/Microsoft Edge.png" alt="Microsoft Edge">
        </div>
        <div class="apps-icon" title="Google Chrome" id="chrome-taskbar-icon">
            <img src="assets/images/Chrome.png" alt="Google Chrome">
        </div>
        <div class="apps-icon" title="Visual Studio Code" id="vscode-taskbar-icon">
            <img src="assets/images/Visual Studio Code.svg" alt="Visual Studio Code">
        </div>
        <div class="up-icon-container" title="Show hidden icons">
            <img src="assets/images/Up.svg" alt="Up Icon" class="up-icon">
        </div>
        <div class="battery-icon-container" title="100% remaining">
            <img src="assets/images/Battery.png" alt="Battery Icon" class="battery-icon">
        </div>
        <div class="wifi-icon-container" title="Storm-Fiber
Internet access">
            <img src="assets/images/Wi-Fi.png" alt="Wi-Fi Icon" class="wifi-icon">
        </div>
        <div class="volume-icon-container" title="Speakers: 100%">
            <svg class="volume-svg" viewBox="0 0 24 24">
                <path class="speaker" d="M4 9H7L12 4V20L7 15H4V9Z" />
                <path class="bar bar-1" d="M15 8.5C15.8 9.3 16.3 10.5 16.3 11.7C16.3 13 15.8 14.1 15 15" />
                <path class="bar bar-2" d="M17.7 6C19.1 7.4 20 9.4 20 11.6C20 13.8 19.1 15.8 17.7 17.3" />
                <path class="bar bar-3" d="M20.3 3.5C22.4 5.6 23.7 8.4 23.7 11.6C23.7 14.7 22.4 17.6 20.3 19.6" />
                <path class="cross" d="M15 9l6 6M21 9l-6 6" />
            </svg>
        </div>
        <div class="time-date-container">
            <div class="time" id="time"></div>
            <div class="date" id="date"></div>
        </div>
        <div class="notification-icon" title="No new notifications">
            <img src="assets/images/Notification.svg" alt="Notification Icon">
        </div>
    </div>

    <!-- File Explorer Window -->
    <div class="window" id="explorer-window" style="width: 850px; height: 550px; left: 130px; top: 100px; display: none;">
        <div class="window-header" style="background-color: #fff; border-bottom: 1px solid #ddd;">
            <div class="window-title" style="color: #333;">
                <img src="assets/images/File Explorer.png" alt="Explorer">
                <span>File Explorer</span>
            </div>
            <div class="window-controls">
                <div class="control-btn minimize" id="explorer-minimize" style="color: #333;"><i class="fas fa-minus"></i></div>
                <div class="control-btn maximize" id="explorer-maximize" style="color: #333;"><i class="far fa-square"></i></div>
                <div class="control-btn close" id="explorer-close" style="color: #333;"><i class="fas fa-times"></i></div>
            </div>
        </div>
        <div class="window-body">
            <div class="explorer-container">
                <div class="explorer-sidebar">
                    <div class="sidebar-header">Quick access</div>
                    <div class="sidebar-item active"><i class="fas fa-star" style="color: #ffc107;"></i> Desktop</div>
                    <div class="sidebar-item"><i class="fas fa-download" style="color: #0078d7;"></i> Downloads</div>
                    <div class="sidebar-item"><i class="fas fa-file-alt" style="color: #0078d7;"></i> Documents</div>
                    <div class="sidebar-item"><i class="fas fa-image" style="color: #0078d7;"></i> Pictures</div>
                    <div class="sidebar-header">This PC</div>
                    <div class="sidebar-item"><i class="fas fa-desktop" style="color: #0078d7;"></i> Desktop</div>
                    <div class="sidebar-item"><i class="fas fa-hdd" style="color: #0078d7;"></i> Local Disk (C:)</div>
                    <div class="sidebar-item"><i class="fas fa-hdd" style="color: #0078d7;"></i> Local Disk (D:)</div>
                </div>
                <div class="explorer-main">
                    <div class="explorer-nav">
                        <div class="browser-nav-btns">
                            <i class="fas fa-arrow-left"></i>
                            <i class="fas fa-arrow-right"></i>
                            <i class="fas fa-chevron-up"></i>
                        </div>
                        <div class="path-bar">
                            <i class="fas fa-desktop" style="margin-right: 8px; font-size: 14px; color: #0078d7;"></i>
                            <span>This PC > Desktop</span>
                        </div>
                        <div class="browser-address-bar" style="max-width: 200px;">
                            <i class="fas fa-search" style="color: #666; font-size: 12px; margin-right: 5px;"></i>
                            <input type="text" placeholder="Search Desktop">
                        </div>
                    </div>
                    <div class="explorer-content-area">
                        <div class="explorer-grid">
                            <div class="explorer-item">
                                <img src="assets/images/Folder.png" alt="Folder">
                                <span>Projects</span>
                            </div>
                            <div class="explorer-item">
                                <img src="assets/images/Folder.png" alt="Folder">
                                <span>Downloads</span>
                            </div>
                            <div class="explorer-item">
                                <img src="assets/images/Shortcut.png" alt="File">
                                <span>Readme.txt</span>
                            </div>
                            <div class="explorer-item">
                                <img src="assets/images/Chrome.png" alt="Chrome">
                                <span>Google Chrome</span>
                            </div>
                            <div class="explorer-item">
                                <img src="assets/images/Notepad.webp" alt="Notepad">
                                <span>New Document</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- VS Code Window (Hidden - instances created dynamically) -->

    <div class="window" id="vscode-window" style="display: none;">
        <!-- ... existing VS Code content ... -->
        <div class="window-header" id="vscode-header">
            <div class="window-title">
                <img src="assets/images/Visual Studio Code.svg" alt="VS Code">
                <span>index.html - Visual Studio Code</span>
            </div>
            <div class="window-controls">
                <div class="control-btn minimize" id="vscode-minimize"><i class="fas fa-minus"></i></div>
                <div class="control-btn maximize" id="vscode-maximize"><i class="far fa-square"></i></div>
                <div class="control-btn close" id="vscode-close"><i class="fas fa-times"></i></div>
            </div>
        </div>
        <div class="window-body">
            <div class="vscode-sidebar">
                <i class="far fa-copy" style="color: #fff;"></i>
                <i class="fas fa-search"></i>
                <i class="fas fa-code-branch"></i>
                <i class="fas fa-th-large"></i>
            </div>
            <div class="vscode-explorer">
                <div style="font-weight: bold; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px;">Explorer</div>
                <div style="display: flex; align-items: center; gap: 5px;">
                    <i class="fas fa-chevron-down"></i>
                    <span style="font-weight: bold;">WINDOWS 10</span>
                </div>
                <div style="padding-left: 20px; margin-top: 5px; color: #51a147;">
                    <i class="fab fa-html5" style="margin-right: 5px; color: #e34c26;"></i> index.html
                </div>
                <div style="padding-left: 20px; margin-top: 5px;">
                    <i class="fas fa-folder" style="margin-right: 5px; color: #dcb67a;"></i> assets
                </div>
            </div>
            <div class="vscode-editor">
                <div class="vscode-code" contenteditable="true" spellcheck="false"><span class="syntax-comment">&lt;!-- Welcome to VS Code Simulator --&gt;</span>
<span class="syntax-bracket">&lt;</span><span class="syntax-tag">html</span><span class="syntax-bracket">&gt;</span>
  <span class="syntax-bracket">&lt;</span><span class="syntax-tag">body</span><span class="syntax-bracket">&gt;</span>
    <span class="syntax-bracket">&lt;</span><span class="syntax-tag">h1</span><span class="syntax-bracket">&gt;</span><span class="syntax-text">Hello, World!</span><span class="syntax-bracket">&lt;/</span><span class="syntax-tag">h1</span><span class="syntax-bracket">&gt;</span>
  <span class="syntax-bracket">&lt;/</span><span class="syntax-tag">body</span><span class="syntax-bracket">&gt;</span>
<span class="syntax-bracket">&lt;/</span><span class="syntax-tag">html</span><span class="syntax-bracket">&gt;</span></div>
            </div>
        </div>
    </div>

    <!-- Notepad Window (Hidden - instances created dynamically) -->
    <div class="window" id="notepad-window" style="width: 600px; height: 400px; left: 150px; top: 80px; background-color: #fff; display: none;">
        <div class="window-header" style="background-color: #f0f0f0; border-bottom: 1px solid #ccc;">
            <div class="window-title" style="color: #333;">
                <img src="assets/images/Notepad.webp" alt="Notepad">
                <span>Untitled - Notepad</span>
            </div>
            <div class="window-controls">
                <div class="control-btn minimize" id="notepad-minimize" style="color: #333;"><i class="fas fa-minus"></i></div>
                <div class="control-btn maximize" id="notepad-maximize" style="color: #333;"><i class="far fa-square"></i></div>
                <div class="control-btn close" id="notepad-close" style="color: #333;"><i class="fas fa-times"></i></div>
            </div>
        </div>
        <div class="window-body">
            <div class="vscode-editor" style="background-color: #fff;">
                <textarea spellcheck="false" style="color: #000; font-family: 'Consolas', sans-serif;"></textarea>
            </div>
        </div>
    </div>

    <!-- Sticky Notes Window (Hidden - instances created dynamically) -->
    <div class="window sticky-note" id="sticky-window" style="left: 200px; top: 120px; display: none;">
        <div class="window-header">
            <div class="window-title">
                <i class="fas fa-plus" style="margin-right: 15px; cursor: pointer;"></i>
                <span>Sticky Notes</span>
            </div>
            <div class="window-controls">
                <div class="control-btn close" id="sticky-close"><i class="fas fa-times"></i></div>
            </div>
        </div>
        <div class="window-body">
            <div class="vscode-editor">
                <textarea spellcheck="false" placeholder="Take a note..."></textarea>
            </div>
        </div>
    </div>

    <!-- Command Prompt Window -->
    <div class="window" id="cmd-window" style="width: 700px; height: 500px; left: 250px; top: 150px; background-color: #0c0c0c; display: none;">
        <div class="window-header" style="background-color: #2d2d30;">
            <div class="window-title">
                <img src="assets/images/Command Prompt.png" alt="Command Prompt" style="width: 16px; height: 16px;">
                <span>Command Prompt</span>
            </div>
            <div class="window-controls">
                <div class="control-btn" id="cmd-minimize">&#8212;</div>
                <div class="control-btn" id="cmd-maximize">&#9744;</div>
                <div class="control-btn close" id="cmd-close">&#10005;</div>
            </div>
        </div>
        <div class="window-body" style="padding: 15px; background-color: #0c0c0c; color: #fff; font-family: 'Consolas', 'Courier New', monospace; font-size: 16px; line-height: 1.8; overflow-y: auto;">
            <pre style="margin: 0; font-family: inherit; font-size: inherit; color: inherit;">Microsoft Windows [Version 10.0.19044.1234]
(c) Microsoft Corporation. All rights reserved.

C:\Users\boss><span class="cmd-cursor" style="background-color: #fff; color: #0c0c0c; padding: 0 4px; margin-left: 2px; animation: blink 1s infinite;">_</span></pre>
        </div>
    </div>

    <!-- Paint Window -->
    <div class="window" id="paint-window" style="width: 900px; height: 700px; left: 200px; top: 50px; display: none;">
        <div class="window-header" style="background-color: #fff; border-bottom: 1px solid #ddd;">
            <div class="window-title" style="color: #000;">
                <img src="assets/images/Paint.png" alt="Paint" style="width: 16px; height: 16px;">
                <span>Paint</span>
            </div>
            <div class="window-controls">
                <div class="control-btn minimize" id="paint-minimize" style="color: #000;"><i class="fas fa-minus"></i></div>
                <div class="control-btn maximize" id="paint-maximize" style="color: #000;"><i class="far fa-square"></i></div>
                <div class="control-btn close" id="paint-close" style="color: #000;"><i class="fas fa-times"></i></div>
            </div>
        </div>
        <div class="window-body" style="padding: 0; overflow: hidden;">
            <iframe src="paint.html" style="width: 100%; height: 100%; border: none;"></iframe>
        </div>
    </div>

    <!-- Calculator Window -->
    <div class="window" id="calculator-window" style="width: 320px; height: 520px; left: 300px; top: 150px; background-color: #f3f3f3; display: none; resize: none;">
        <div class="window-header" style="background-color: #f3f3f3; border-bottom: 1px solid #ddd;">
            <div class="window-title" style="color: #000;">
                <img src="assets/images/Calculator.png" alt="Calculator" style="width: 16px; height: 16px;">
                <span>Calculator</span>
            </div>
            <div class="window-controls">
                <div class="control-btn" id="calculator-minimize" style="color: #000;">&#8212;</div>
                <div class="control-btn close" id="calculator-close" style="color: #000;">&#10005;</div>
            </div>
        </div>
        <div class="window-body" style="padding: 0; background-color: #f3f3f3; display: flex; flex-direction: column;">
            <div class="calculator-display" style="background-color: #f3f3f3; padding: 20px; text-align: right; font-size: 48px; font-weight: 300; color: #000; min-height: 100px; display: flex; flex-direction: column; justify-content: flex-end; font-family: 'Segoe UI', Arial, sans-serif;">
                <div style="font-size: 14px; color: #666; min-height: 20px;" id="calc-expression"></div>
                <div id="calc-display">0</div>
            </div>
            <div class="calculator-buttons" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1px; background-color: #ddd; flex: 1;">
                <button class="calc-btn calc-func" style="background-color: #f3f3f3; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; transition: background-color 0.1s;" data-action="clear">C</button>
                <button class="calc-btn calc-func" style="background-color: #f3f3f3; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; transition: background-color 0.1s;" data-action="backspace">⌫</button>
                <button class="calc-btn calc-operator" style="background-color: #f3f3f3; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; transition: background-color 0.1s;" data-operator="/">÷</button>
                <button class="calc-btn calc-operator" style="background-color: #f3f3f3; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; transition: background-color 0.1s;" data-operator="*">×</button>
                
                <button class="calc-btn calc-number" style="background-color: #fff; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; transition: background-color 0.1s;" data-number="7">7</button>
                <button class="calc-btn calc-number" style="background-color: #fff; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; transition: background-color 0.1s;" data-number="8">8</button>
                <button class="calc-btn calc-number" style="background-color: #fff; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; transition: background-color 0.1s;" data-number="9">9</button>
                <button class="calc-btn calc-operator" style="background-color: #f3f3f3; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; transition: background-color 0.1s;" data-operator="-">−</button>
                
                <button class="calc-btn calc-number" style="background-color: #fff; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; transition: background-color 0.1s;" data-number="4">4</button>
                <button class="calc-btn calc-number" style="background-color: #fff; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; transition: background-color 0.1s;" data-number="5">5</button>
                <button class="calc-btn calc-number" style="background-color: #fff; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; transition: background-color 0.1s;" data-number="6">6</button>
                <button class="calc-btn calc-operator" style="background-color: #f3f3f3; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; transition: background-color 0.1s;" data-operator="+">+</button>
                
                <button class="calc-btn calc-number" style="background-color: #fff; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; transition: background-color 0.1s;" data-number="1">1</button>
                <button class="calc-btn calc-number" style="background-color: #fff; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; transition: background-color 0.1s;" data-number="2">2</button>
                <button class="calc-btn calc-number" style="background-color: #fff; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; transition: background-color 0.1s;" data-number="3">3</button>
                <button class="calc-btn calc-equals" style="background-color: #0078d4; color: #fff; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; grid-row: span 2; transition: background-color 0.1s;" data-action="equals">=</button>
                
                <button class="calc-btn calc-number" style="background-color: #fff; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; grid-column: span 2; transition: background-color 0.1s;" data-number="0">0</button>
                <button class="calc-btn calc-number" style="background-color: #fff; border: none; font-size: 18px; cursor: pointer; font-family: 'Segoe UI', Arial, sans-serif; transition: background-color 0.1s;" data-number=".">.</button>
            </div>
        </div>
    </div>

    <!-- Chrome Browser Window -->
    <div class="window" id="chrome-window" style="width: 1000px; height: 650px; left: 100px; top: 50px; display: none;">
        <div class="window-header" style="background-color: #fff; border-bottom: 1px solid #ddd;">
            <div class="window-title" style="color: #3c4043;">
                <img src="assets/images/Chrome.png" alt="Chrome">
                <span>Google Chrome</span>
            </div>
            <div class="window-controls">
                <div class="control-btn minimize" id="chrome-minimize" style="color: #5f6368;"><i class="fas fa-minus"></i></div>
                <div class="control-btn maximize" id="chrome-maximize" style="color: #5f6368;"><i class="far fa-square"></i></div>
                <div class="control-btn close" id="chrome-close" style="color: #5f6368;"><i class="fas fa-times"></i></div>
            </div>
        </div>
        <div class="window-body" style="display: flex; flex-direction: column;">
            <div class="browser-toolbar">
                <div class="browser-nav-btns">
                    <i class="fas fa-arrow-left" title="Back"></i>
                    <i class="fas fa-arrow-right" title="Forward"></i>
                    <i class="fas fa-redo" title="Reload"></i>
                </div>
                <div class="browser-address-bar">
                    <input type="text" id="chrome-address-input" value="https://www.google.com" placeholder="Search Google or type a URL">
                </div>
                <div class="browser-nav-btns">
                    <i class="fas fa-user-circle" title="User"></i>
                    <i class="fas fa-ellipsis-v" title="Menu"></i>
                </div>
            </div>
            <div class="browser-content">
                <iframe id="chrome-iframe" src="https://www.google.com/search?igu=1" allowfullscreen></iframe>
            </div>
        </div>
    </div>


    <!-- Recycle Bin Window -->
    <div class="window" id="trash-window" style="width: 800px; height: 500px; left: 120px; top: 60px; display: none;">
        <div class="window-header" style="background-color: #f0f0f0; border-bottom: 1px solid #ccc;">
            <div class="window-title" style="color: #333;">
                <img src="assets/images/recycle-bin.png" alt="Recycle Bin">
                <span>Recycle Bin</span>
            </div>
            <div class="window-controls">
                <div class="control-btn minimize" id="trash-minimize" style="color: #333;"><i class="fas fa-minus"></i></div>
                <div class="control-btn maximize" id="trash-maximize" style="color: #333;"><i class="far fa-square"></i></div>
                <div class="control-btn close" id="trash-close" style="color: #333;"><i class="fas fa-times"></i></div>
            </div>
        </div>
        <div class="window-body">
            <div class="recycle-bin-content">
                <div class="recycle-bin-toolbar">
                    <div class="toolbar-item" id="empty-trash-btn">
                        <i class="fas fa-trash-alt"></i>
                        <span>Empty Recycle Bin</span>
                    </div>
                    <div class="toolbar-item" id="restore-all-btn">
                        <i class="fas fa-undo"></i>
                        <span>Restore all items</span>
                    </div>
                </div>
                <div class="recycle-bin-grid" id="trash-grid">
                    <!-- Deleted items will be added here -->
                </div>
            </div>
        </div>
    </div>

    <div class="hidden-icons-panel">
        <div class="icon-box">
            <div class="icon-row">
                <img src="assets/images/Safely Remove Hardware and Eject Media.png" alt="Safely Remove Hardware and Eject Media"
                    title="Safely Remove Hardware and Eject Media" class="hidden-icon">
                <img src="assets/images/Windows Security No Action needed.png" alt="Windows Security - No Action needed"
                    title="Windows Security - No Action needed" class="hidden-icon">
            </div>
        </div>
        <div class="icon-box">
            <div class="icon-row">
                <img src="assets/images/Intel(R) HD Graphics.png" alt="Intel(R) HD Graphics" title="Intel(R) HD Graphics"
                    class="hidden-icon">
                <img src="assets/images/IDM.png" alt="Internet Download Manager" title="Internet Download Manager"
                    class="hidden-icon">
            </div>
        </div>
    </div>

    <div class="battery-panel" id="battery-panel">
        <div class="battery-panel-header">
            <img id="battery-header-icon" src="assets/images/Battery.png" class="battery-default"
                style="margin-right: 5px; pointer-events: none; width: 60px; height: auto;" alt="Battery Icon">
            <div class="battery-panel-title">100%</div>
        </div>
        <div class="battery-panel-content">
            <p>Battery 1: 100% and in use</p>
            <p style="margin-top: 10px;">Battery 2: Not present</p>
            <p>Battery settings</p>
        </div>
        <div class="battery-button-icon" id="battery-button">
            <img style="filter: invert(1);" src="assets/images/Battery Saver.svg" alt="Battery Icon">
            <p>Battery saver</p>
        </div>
    </div>

    <div class="wifi-panel" id="wifi-panel">
        <div class="wifi-panel-content">
            <div style="position: relative;">
                <img src="assets/images/Wi-Fi.png" class="wifi-icon my-image">
                <img src="assets/images/Lock.svg" class="lock-icon my-image">
            </div>
            <div class="wifi-info">
                <div class="wifi-name">Mainer-Z</div>
                <div class="connected-secured">Connected, secured</div>
                <div class="status">Properties</div>
            </div>
            <button onclick="
    var button = this;
    var connectedSecured = document.querySelector('.connected-secured');
    var status = document.querySelector('.status');
    var loading = document.querySelector('.loading');

    if (button.textContent === 'Disconnect') {
        button.textContent = 'Connect';
        connectedSecured.textContent = 'Secured';
        status.style.display = 'none';
    } else {
        button.textContent = 'Connecting...';
        button.classList.add('connecting');
        connectedSecured.textContent = '';
        status.style.display = 'none';
        loading.classList.add('show');

        setTimeout(function() {
            button.textContent = 'Disconnect';
            button.classList.remove('connecting');
            connectedSecured.textContent = 'Connected, secured';
            status.style.display = 'block';
            loading.classList.remove('show');
        }, 2000);
    }
">Disconnect</button>
            <div class="loading">
                <div class="spinner"></div>
            </div>
        </div>
        <div class="wifi-panel-new-content" id="wifi-panel-new-content">
            <div class="no-wifi-content">
                <h3>No Wi-Fi Connection</h3>
                <p>Wi-Fi is turned off or Airplane Mode is enabled. Please check your settings.</p>
                <button onclick="window.location.reload();">Retry</button>
            </div>
        </div>
        <div class="loading-animation">
            <div class="dots-wrapper">
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
                <div class="dot"></div>
            </div>
        </div>
        <div class="additional-info">
            <div class="text-title">Network & Internet settings</div>
            <div class="text-subtitle">Change settings, such as making a connection metered.</div>
            <div class="interactive-icon hidden-item">
                <img src="assets/images/Wi-Fi.png"
                    style="filter: invert(1); transform: scaleX(-1); margin-left: 1px; width: 20px; height: auto;"
                    alt="Wi-Fi">
                <p>Wi-Fi</p>
            </div>
            <div class="interactive-icon hidden-item">
                <img src="assets/images/Airplane mode.png" alt="Airplane mode">
                <p>Airplane mode</p>
            </div>
            <div class="interactive-icon">
                <img style="filter: invert(1);" src="assets/images/Mobile Hotspot.png" alt="Mobile Hotspot">
                <p>Mobile hotspot</p>
            </div>
        </div>
    </div>

    <div class="volume-panel">
        <div class="volume-header">Speakers (2- High Definition Audio Device)</div>
        <div class="volume-control">
            <svg class="volume-svg" viewBox="0 0 24 24">
                <path class="speaker" d="M4 9H7L12 4V20L7 15H4V9Z" />
                <path class="bar bar-1" d="M15 8.5C15.8 9.3 16.3 10.5 16.3 11.7C16.3 13 15.8 14.1 15 15" />
                <path class="bar bar-2" d="M17.7 6C19.1 7.4 20 9.4 20 11.6C20 13.8 19.1 15.8 17.7 17.3" />
                <path class="bar bar-3" d="M20.3 3.5C22.4 5.6 23.7 8.4 23.7 11.6C23.7 14.7 22.4 17.6 20.3 19.6" />
                <path class="cross" d="M15 9l6 6M21 9l-6 6" />
            </svg>
            <input type="range" min="0" max="100" value="100" class="volume-slider" id="volumeSlider">
            <div class="volume-percentage">100</div>
        </div>
    </div>

    <div id="volume-indicator" class="hidden">
        <div class="volume-bar">
            <div class="gray-background"></div>
            <div class="blue-bar"></div>
            <div class="white-box"></div>
        </div>
        <div class="volume-percentage">100</div>
    </div>

    <div class="calendar-panel" id="calendarPanel">
        <div class="time-display" id="calendarTimeDisplay">
            <div class="large-time" id="calendarTime">12:34</div>
            <div class="small-time" id="calendarSecondsAMPM">56 pm</div>
            <div id="calendarDate">Friday, 23 August 2024</div>
        </div>
        <hr class="calendar-divider">
        <div class="calendar-header">
            <div class="month-year" id="calendarMonthYear">August 2024</div>
            <div class="arrow-controls">
                <button id="prevMonth"><span class="material-symbols-outlined">keyboard_arrow_up</span></button>
                <button id="nextMonth"><span class="material-symbols-outlined">keyboard_arrow_down</span></button>
            </div>
        </div>
        <div class="calendar-days">
            <div class="day">Su</div>
            <div class="day">Mo</div>
            <div class="day">Tu</div>
            <div class="day">We</div>
            <div class="day">Th</div>
            <div class="day">Fr</div>
            <div class="day">Sa</div>
        </div>
        <div class="calendar-grid" id="calendarGrid"></div>
        <hr class="calendar-divider">
        <div id="eventDetails" class="event-details">
            <div id="selectedDate" class="selected-date">Today</div>
            <input id="eventInput" class="event-input" type="text" placeholder="Add an event or reminder">
            <div id="noEvents" class="no-events">No events</div>
            <div id="toggleAgenda" class="toggle-agenda">
                <span id="toggleText">Hide agenda</span>
                <span id="toggleArrow" class="material-symbols-outlined">keyboard_arrow_down</span>
            </div>
        </div>
    </div>

    <!-- Notification panel -->
    <div class="notification-panel">
        <p>No new notifications</p>
        <div class="manage-notifications">Manage notifications</div>
        <div class="collapse-expand" id="collapseExpandText">Collapse</div>
        <div class="buttons-container" id="buttonsContainer">
            <!-- Button 1 -->
            <div class="button-item">
                <img style="filter: invert(1);" src="assets/images/Pin Location.png" alt="Location">
                <p>Location</p>
            </div>
            <!-- Button 2 -->
            <div class="button-item">
                <img src="assets/images/Battery Saver.png" alt="Battery Saver">
                <p>Battery saver</p>
            </div>
            <!-- Button 3 -->
            <div class="button-item">
                <img style="filter: invert(1); width: 70px; height: 50px;" src="assets/images/Night Light.png" alt="Night Light">
                <p>Night light</p>
            </div>
            <!-- Button 4 -->
            <div class="button-item">
                <img style="filter: invert(1);" src="assets/images/Mobile Hotspot.png" alt="Mobile Hotspot">
                <p>Mobile hotspot</p>
            </div>
            <!-- Button 5 -->
            <div class="button-item hidden">
                <img src="assets/images/Airplane mode.png" alt="Airplane mode">
                <p>Airplane mode</p>
            </div>
            <!-- Button 6 -->
            <div class="button-item hidden">
                <img src="assets/images/All settings.svg" alt="Settings">
                <p>All settings</p>
            </div>
            <!-- Button 7 -->
            <div class="button-item hidden">
                <img src="assets/images/Network.png" alt="Network">
                <p>Network</p>
            </div>
            <!-- Button 8 -->
            <div class="button-item hidden">
                <img style="width: 40px; height: 40px;" src="assets/images/Connect.png" alt="Connect">
                <p>Connect</p>
            </div>
            <!-- Button 9 -->
            <div class="button-item hidden">
                <img src="assets/images/Project.png" alt="Project">
                <p>Project</p>
            </div>
            <!-- Button 10 -->
            <div class="button-item hidden">
                <img style="width: 30px; height: auto;" src="assets/images/VPN.png" alt="VPN">
                <p>VPN</p>
            </div>
            <!-- Button 11 -->
            <div class="button-item hidden">
                <img style="transform: scaleX(-1); filter: invert(1);" src="assets/images/Focus assist.png" alt="Focus assist">
                <p>Focus assist</p>
            </div>
            <!-- Button 12 -->
            <div class="button-item hidden">
                <img style="filter: invert(1);" src="assets/images/Screen snip.svg" alt="Screen snip">
                <p>Screen snip</p>
            </div>
        </div>
        <div class="brightness-control">
            <img src="assets/images/Brightness.svg" alt="Brightness Icon" class="brightness-icon">
            <div class="slider-container">
                <input type="range" min="0" max="100" value="30" class="slider" id="brightnessSlider">
                <div class="slider-percentage" id="sliderPercentage">30</div>
            </div>
        </div>
    </div>

    <div class="overlay">
        <div class="plus-container">
            <i class="fas fa-plus"></i>
            <span class="title">New Desktop</span>
        </div>
        <div class="bottom-text-container">
            <span class="bottom-text">Use your PC more to see your activities here.</span>
        </div>
    </div>

    <div class="start-menu" id="startMenu">
        <div class="menu-bar">
            <div class="start-icon"></div>
            <div class="start-text">START</div>
            <div class="user-account">
                <div class="user-icon"></div>
                <div class="user-name">Master Root</div>
            </div>
        </div>
        <div class="sections">
            <div class="section">
                <div class="icons-section">
                    <div class="icon">
                        <i class="fa-regular fa-file"></i>
                        <span class="icon-text">Document</span>
                    </div>
                    <div class="icon">
                        <i class="fa-regular fa-image"></i>
                        <span class="icon-text">Pictures</span>
                    </div>
                    <div class="icon">
                        <i class="fa-solid fa-gear"></i>
                        <span class="icon-text">Settings</span>
                    </div>
                    <div class="icon" id="power-icon">
                        <i class="fa-solid fa-power-off"></i>
                        <span class="icon-text">Power</span>
                    </div>
                </div>
            </div>
            <div class="section">
                <div class="section-title">Apps</div>
                <div class="apps-section">
                    <div class="library-search">#</div>
                    <div class="app"><img style="transform: scale(1.5);" src="assets/images/3D Viewer.png" alt="3D Viewer"> 3D Viewer
                    </div>
                    <div class="library-search">C</div>
                    <div class="app" id="app-library-calculator"><img src="assets/images/Calculator.png" alt="Calculator"> Calculator</div>
                    <div class="app"><img src="assets/images/Calendar.png" alt="Calendar"> Calendar</div>
                    <div class="app"><img src="assets/images/Camera.webp" alt="Camera"> Camera</div>
                    <div class="app"><img src="assets/images/Clock.png" alt="Clock"> Clock</div>
                    <div class="library-search">F</div>
                    <div class="app"><img src="assets/images/Feedback Hub.png" alt="Feedback Hub"> Feedback Hub</div>
                    <div class="app"><img src="assets/images/Feem.png" alt="Feem"> Feem</div>
                    <div class="app"><img style="transform: scale(2.9);" src="assets/images/Films & TV.png" alt="Films & TV"> Films &
                        TV</div>
                    <div class="app"><img src="assets/images/FDM.svg" alt="Free Download Manager"> Free Download Manager</div>
                    <div class="library-search">G</div>
                    <div class="app">
                        <img src="assets/images/Game Bar.webp" alt="Game Bar">
                        <div class="app-info">
                            <span class="app-name">Game Bar</span>
                            <span class="system-text">System</span>
                        </div>
                    </div>
                    <div class="app">
                        <img style="transform: scale(2.9);" src="assets/images/Get Help.png" alt="Get Help">
                        <div class="app-info">
                            <span class="app-name">Get Help</span>
                            <span class="system-text">System</span>
                        </div>
                    </div>
                    <div class="app"><img src="assets/images/Chrome.png" alt="Google Chrome"> Google Chrome</div>
                    <div class="library-search">I</div>
                    <div class="app"><img style="transform: scale(2.0);" src="assets/images/Image Color Summarizer.png"
                            alt="Image Color Summarizer"> Image Color Summarizer</div>
                    <div class="app"><img src="assets/images/IDM.png" alt="Internet Download Manager"> Internet
                        Download Manager</div>
                    <div class="library-search">M</div>
                    <div class="app"><img src="assets/images/Mail.png" alt="Mail"> Mail</div>
                    <div class="app"><img src="assets/images/Maps.png" alt="Maps"> Maps</div>
                    <div class="app"><img src="assets/images/Media Player.png" alt="Media Player"> Media Player</div>
                    <div class="app"><img src="assets/images/Microsoft 365.svg" alt="Microsoft 365"> Microsoft 365 (Office)</div>
                    <div class="app"><img src="assets/images/Microsoft Edge.png" alt="Microsoft Edge"> Microsoft Edge</div>
                    <div class="app"><img src="assets/images/Microsoft Store.svg" alt="Microsoft Store">
                        <div class="app-info">
                            <span class="app-name">Microsoft Store</span>
                            <span class="system-text">System</span>
                        </div>
                    </div>
                    <div class="app"><img src="assets/images/Mixed Reality Portal.png" alt="Mixed Reality Portal">
                        <div class="app-info">
                            <span class="app-name">Mixed Reality Portal</span>
                            <span class="system-text">System</span>
                        </div>
                    </div>
                    <div class="library-search">P</div>
                    <div class="app"><img src="assets/images/Paint 3d.svg" alt="Paint 3D"> Paint 3D</div>
                    <div class="app"><img src="assets/images/Phone Link.svg" alt="Phone Link">
                        <div class="app-info">
                            <span class="app-name">Phone Link</span>
                            <span class="system-text">System</span>
                        </div>
                    </div>
                    <div class="app"><img src="assets/images/Photos.png" alt="Photos"> Photos</div>
                    <div class="app"><img src="assets/images/Proton VPN.png" alt="Proton"> Proton</div>
                    <div class="library-search">S</div>
                    <div class="app"><img style="transform: scale(1.3);" src="assets/images/Settings.svg" alt="Settings System">
                        <div class="app-info">
                            <span class="app-name">Settings</span>
                            <span class="system-text">System</span>
                        </div>
                    </div>
                    <div class="app"><img src="assets/images/Snip Sketch.svg" alt="Snip & Sketch"> Snip & Sketch</div>
                    <div class="app"><img src="assets/images/Sticky Notes.png" alt="Sticky Notes"> Sticky Notes</div>
                    <div class="library-search">T</div>
                    <div class="app"><img src="assets/images/Tips.png" alt="Tips">
                        <div class="app-info"><span class="app-name">Tips</span><span class="system-text">System</span>
                        </div>
                    </div>
                    <div class="library-search">V</div>
                    <div class="app"><img src="assets/images/VidJuice UniTube.png" alt="VidJuice UniTube"> VidJuice UniTube</div>
                    <div class="app"><img src="assets/images/VLC Media Player.png" alt="VLC Media Player"> VLC Media Player</div>
                    <div class="app"><img src="assets/images/Visual Studio Code.svg" alt="Visual Studio Code"> Visual Studio Code
                    </div>
                    <div class="app"><img src="assets/images/Voice Recorder.svg" alt="Voice Recorder"> Voice Recorder</div>
                    <div class="library-search">W</div>
                    <div class="app"><img src="assets/images/Weather.png" alt="Weather"> Weather</div>
                    <div class="app"><img src="assets/images/WhatsApp.svg" alt="WhatsApp"> WhatsApp</div>
                    <div class="app" id="appContainer">
                        <img src="assets/images/Folder.svg" alt="Windows Accessories">
                        Windows Accessories
                        <div class="arrow" id="toggleArrow"></div>
                    </div>
                    <div class="expandable-content" id="expandableContent">
                        <div class="app">
                            <img src="assets/images/Character Map.png" alt="Character Map">
                            <div class="app-info"><span class="app-name">Character Map</span><span
                                    class="system-text">System</span>
                            </div>
                        </div>
                        <div class="app">
                            <img style="transform: scale(2.0);" src="assets/images/Dev Home (Preview).png" alt="Dev Home (Preview)">
                            <div class="app-info"><span class="app-name">Dev Home (Preview)</span><span
                                    class="system-text">System</span>
                            </div>
                        </div>
                        <div class="app">
                            <img src="assets/images/Internet Explorer.png" alt="Internet Explorer">
                            Internet Explorer
                        </div>
                        <div class="app">
                            <img src="assets/images/Math Input Panel.webp" alt="Math Input Panel">
                            <div class="app-info"><span class="app-name">Math Input Panel</span><span
                                    class="system-text">System</span>
                            </div>
                        </div>
                        <div class="app">
                            <img src="assets/images/Notepad.webp" alt="Notepad">
                            <div class="app-info"><span class="app-name">Notepad</span><span
                                    class="system-text">System</span>
                            </div>
                        </div>
                        <div class="app">
                            <img src="assets/images/Paint.png" alt="Paint">
                            Paint
                        </div>
                        <div class="app">
                            <img src="assets/images/Quick Assist.svg" alt="Quick Assist">
                            Quick Assist
                        </div>
                        <div class="app">
                            <img src="assets/images/Remote Desktop Connection.avif" alt="Remote Desktop Connection">
                            Remote Desktop Connection
                        </div>
                        <div class="app">
                            <img src="assets/images/Snipping Tool.svg" alt="Snipping Tool">
                            Snipping Tool
                        </div>
                        <div class="app">
                            <img src="assets/images/Steps Recorder.webp" alt="Steps Recorder">
                            <div class="app-info"><span class="app-name">Steps Recorder</span><span
                                    class="system-text">System</span>
                            </div>
                        </div>
                        <div class="app">
                            <img src="assets/images/Windows Fax And Scan.ico" alt="Windows Fax And Scan">
                            <div class="app-info"><span class="app-name">Windows Fax And Scan</span><span
                                    class="system-text">System</span>
                            </div>
                        </div>
                        <div class="app">
                            <img src="assets/images/Windows Media Player.png" alt="Windows Media Player">
                            Windows Media Player
                        </div>
                        <div class="app">
                            <img src="assets/images/WordPad.png" alt="WordPad">
                            <div class="app-info"><span class="app-name">WordPad</span><span
                                    class="system-text">System</span>
                            </div>
                        </div>
                    </div>
                    <div class="app"><img src="assets/images/Folder.svg" alt="Windows Administrative Tools">
                        Windows Administrative Tools</div>
                    <div class="app"><img src="assets/images/Windows Backup.png" alt="Windows Backup"> Windows Backup</div>
                    <div class="app"><img src="assets/images/Folder.svg" alt="Windows Ease of Access"> Windows Ease of
                        Access</div>
                    <div class="app"><img src="assets/images/Folder.svg" alt="Windows PowerShell"> Windows PowerShell
                    </div>
                    <div class="app"><img src="assets/images/Windows Security.png" alt="Windows Security"> Windows Security</div>
                    <div class="app"><img src="assets/images/Folder.svg" alt="Windows System">
                        <div class="app-info">
                            <span class="app-name">Windows System</span>
                            <span class="system-text">System</span>
                        </div>
                    </div>
                    <div class="app"><img src="assets/images/WinRAR archive.png" alt="WinRAR"> WinRAR</div>
                    <div class="library-search">X</div>
                    <div class="app"><img src="assets/images/Xbox Console Companion.png" alt="Xbox Console Companion"> Xbox Console
                        Companion</div>
                </div>
            </div>
            <div class="section">
                <div class="pin-section">
                    <div class="group">
                        <div class="group-name">Productivity</div>
                        <div class="app-container">
                            <div class="pinned-app" title="Microsoft 365 (Office)">
                                <img src="assets/images/Microsoft 365.svg" alt="MS 365">
                                <div class="app-name"
                                    style="display: inline-block; width: 110px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; transition: width 0.3s ease; transition: all 0.3s ease-in-out; box-sizing: border-box;">
                                    Microsoft 365 (Office)</div>
                            </div>
                            <div class="pinned-app" title="Microsoft Edge">
                                <img src="assets/images/Microsoft Edge.png" alt="Edge">
                                <div class="app-name">Microsoft Edge</div>
                            </div>
                            <div class="pinned-app" title="Microsoft Store">
                                <img src="assets/images/Microsoft Store.svg" alt="Store">
                                <div class="app-name">Microsoft Store</div>
                            </div>
                        </div>
                    </div>

                    <div class="group">
                        <div class="group-name">Shortcuts</div>
                        <div class="app-container">
                            <div class="pinned-app" title="Control Panel">
                                <img src="assets/images/Control Panel.png" alt="Control Panel">
                                <div class="app-name">Control Panel</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <script src="https://kit.fontawesome.com/ba2000386c.js"></script>
            <script>
// Screen Mode Dropdown Handler
const screenModeDropdown = document.getElementById('screenModeDropdown');
const selectedModeSpan = document.getElementById('selectedMode');
const dropdownOptions = document.querySelectorAll('.dropdown-option');

// Always start with normal mode on page load
let currentMode = 'normal';

// Update selected mode display
function updateModeDisplay(mode) {
    if (mode === 'fullscreen') {
        selectedModeSpan.textContent = 'Full Screen';
    } else {
        selectedModeSpan.textContent = 'Normal Mode';
    }
}

// Toggle dropdown
screenModeDropdown.addEventListener('click', function(e) {
    if (!e.target.closest('.dropdown-option')) {
        screenModeDropdown.classList.toggle('active');
    }
});

// Close dropdown when clicking outside
document.addEventListener('click', function(e) {
    if (!screenModeDropdown.contains(e.target)) {
        screenModeDropdown.classList.remove('active');
    }
});

// Handle option selection
dropdownOptions.forEach(option => {
    option.addEventListener('click', function() {
        const mode = this.getAttribute('data-mode');
        currentMode = mode;
        localStorage.setItem('screenMode', mode);
        updateModeDisplay(mode);
        screenModeDropdown.classList.remove('active');
        
        // Apply fullscreen mode immediately
        if (mode === 'fullscreen') {
            enterFullscreen();
        } else {
            exitFullscreen();
        }
    });
});

// Fullscreen functions
function enterFullscreen() {
    const elem = document.documentElement;
    if (elem.requestFullscreen) {
        elem.requestFullscreen();
    } else if (elem.webkitRequestFullscreen) {
        elem.webkitRequestFullscreen();
    } else if (elem.msRequestFullscreen) {
        elem.msRequestFullscreen();
    }
}

function exitFullscreen() {
    if (document.exitFullscreen) {
        document.exitFullscreen();
    } else if (document.webkitExitFullscreen) {
        document.webkitExitFullscreen();
    } else if (document.msExitFullscreen) {
        document.msExitFullscreen();
    }
}

// Initialize mode display
updateModeDisplay(currentMode);

// Slide-in effect for greeting text
function slideInText(element, text) {
    element.innerHTML = '';
    const chars = Array.from(text); // Use Array.from to handle emoji correctly
    
    chars.forEach((char, index) => {
        const span = document.createElement('span');
        span.textContent = char;
        span.style.animationDelay = `${index * 0.04}s`;
        element.appendChild(span);
    });
}

window.addEventListener('load', function () {
    // Start slide-in effect for greeting text
    const greetingText = document.querySelector('.greeting-text');
    if (greetingText) {
        setTimeout(function() {
            slideInText(greetingText, 'Welcome 👑');
        }, 800); // Start after avatar appears
    }
    
    setTimeout(function () {
        document.getElementById('loaderContainer').style.display = 'none';
        document.querySelector('.background-image').style.display = 'block';
        document.querySelector('.taskbar').style.display = 'flex';
    }, 3500); // Show the loader for 3.5 seconds

    // Create the selection box element only once
    const selectionBox = document.createElement('div');
    selectionBox.classList.add('selection-box');
    document.querySelector('.background-image').appendChild(selectionBox);

    let isMouseDown = false;
    let startX = 0;
    let startY = 0;

    // Start the selection when the left mouse button is pressed down
    document.querySelector('.background-image').addEventListener('mousedown', function (e) {
        if (e.button === 0) { // Ensure it's the left mouse button (button 0)
            // Hide the previous selection box before starting a new selection
            selectionBox.style.display = 'block';  // Show the box if it was hidden before

            // Reset starting coordinates for the selection box
            isMouseDown = true;
            startX = e.clientX;
            startY = e.clientY;

            // Ensure the selection box starts from the mouse position
            selectionBox.style.left = `${startX}px`;
            selectionBox.style.top = `${startY}px`;
        }
    });

    // Track mouse movement to update the selection box size and position
    document.querySelector('.background-image').addEventListener('mousemove', function (e) {
        if (isMouseDown) {
            // Calculate width and height based on mouse drag
            const width = e.clientX - startX;
            const height = e.clientY - startY;

            // Update the position and size of the selection box
            selectionBox.style.left = `${Math.min(startX, e.clientX)}px`;
            selectionBox.style.top = `${Math.min(startY, e.clientY)}px`;
            selectionBox.style.width = `${Math.abs(width)}px`;
            selectionBox.style.height = `${Math.abs(height)}px`;
        }
    });

    // Stop the selection and hide the selection box when the left mouse button is released
    document.querySelector('.background-image').addEventListener('mouseup', function () {
        if (isMouseDown) {
            selectionBox.style.display = 'none'; // Hide the box instantly
            isMouseDown = false;
        }
    });

    // Hide the selection box when the mouse leaves the area
    document.querySelector('.background-image').addEventListener('mouseleave', function () {
        if (isMouseDown) {
            selectionBox.style.display = 'none'; // Hide the box if mouse leaves area
            isMouseDown = false;
        }
    });
});

                document.addEventListener('keydown', function (e) {
                    if ((e.key === 's' || e.key === 'q') && (e.metaKey || e.ctrlKey)) { // Windows key + S or Q
                        e.preventDefault();
                        const searchInput = document.querySelector('.search-box');
                        searchInput.focus();
                    }
                });

                document.addEventListener('DOMContentLoaded', function () {
                    const contextMenu = document.getElementById('contextMenu');
                    const taskbar = document.querySelector('.taskbar');
                    const windowsIcon = document.querySelector('.taskbar .windows-icon');
                    const backgroundImage = document.querySelector('.background-image');
                    const startMenu = document.getElementById('startMenu');
                    const searchPanel = document.querySelector('.search-panel');
                    const searchPanelIcon = document.querySelector('.search-panel-icon');
                    const searchInput = document.querySelector('.search-box');
                    const searchContainer = document.querySelector('.search-container');
                    const moreOptions = document.querySelector('.search-panel .top-bar .more-options');
                    const userDropdown = document.querySelector('.search-panel .top-bar .user-account .dots');
                    const closeButton = document.querySelector('.search-panel .top-bar .close-btn');
                    const startIcon = document.querySelector('.start-icon');
                    const iconsSection = document.querySelector('.start-menu .section .icons-section');
                    const appContainer = document.getElementById('appContainer');
                    const expandableContent = document.getElementById('expandableContent');

                    let isIconsSectionExpanded = false;
                    let isMoreDropdownOpen = false;
                    let isUserDropdownOpen = false;
                    let showPanelTimeout;

                    // Disable the default context menu on the entire page
                    document.addEventListener('contextmenu', function (e) {
                        e.preventDefault();
                    });

                    // Show context menu on right-click only on background image
                    backgroundImage.addEventListener('contextmenu', function (e) {
                        e.preventDefault();

                        let menuX = e.pageX;
                        let menuY = e.pageY;

                        const viewportWidth = window.innerWidth;
                        const viewportHeight = window.innerHeight;
                        const contextMenuWidth = contextMenu.offsetWidth;
                        const contextMenuHeight = contextMenu.offsetHeight;
                        const taskbarRect = taskbar.getBoundingClientRect();

                        if (menuX + contextMenuWidth > viewportWidth) {
                            menuX = viewportWidth - contextMenuWidth;
                        }

                        if (menuY + contextMenuHeight > taskbarRect.top) {
                            menuY = taskbarRect.top - contextMenuHeight;
                        }

                        contextMenu.style.left = `${menuX}px`;
                        contextMenu.style.top = `${menuY}px`;
                        contextMenu.style.display = 'block';
                    });

                    // Define the initial styles for animation
                    startMenu.style.overflow = 'hidden';

                    // Show/hide start menu on Windows icon click
                    windowsIcon.addEventListener('click', function () {
                        toggleStartMenu();
                    });

                    // Hide start menu on click outside
                    document.addEventListener('click', function (e) {
                        if (!startMenu.contains(e.target) && !e.target.closest('.taskbar') && startMenu.classList.contains('show')) {
                            hideStartMenu();
                        }
                    });

                    // Toggle start menu when the Windows key is pressed
                    document.addEventListener('keydown', function (e) {
                        if (e.key === 'Meta' || e.key === 'Control' || e.key === 'OS') {
                            toggleStartMenu();
                        }
                    });

                    function toggleStartMenu() {
                        if (startMenu.classList.contains('show')) {
                            hideStartMenu();
                        } else {
                            showStartMenu();
                        }
                    }

                    function showStartMenu() {
                        startMenu.style.display = 'block';
                        setTimeout(() => {
                            startMenu.style.transform = 'translateY(0)';
                            startMenu.style.opacity = '1';
                        }, 10);
                        windowsIcon.classList.add('active');
                        startMenu.classList.add('show');

                        // Ensure search panel is hidden when showing the start menu
                        if (searchPanel.style.display === 'block') {
                            searchPanel.style.display = 'none';
                        }
                    }

                    function hideStartMenu() {
                        startMenu.style.transform = 'translateY(100%)';
                        startMenu.style.opacity = '0';
                        setTimeout(() => {
                            startMenu.style.display = 'none';
                        }, 300);
                        windowsIcon.classList.remove('active');
                        startMenu.classList.remove('show');
                    }

                    // Hide context menu on click outside
                    document.addEventListener('click', function (e) {
                        if (!contextMenu.contains(e.target)) {
                            contextMenu.style.display = 'none';
                        }
                    });

                    // Handle submenu toggling
                    document.querySelectorAll('.menu-item').forEach(item => {
                        item.addEventListener('click', function (e) {
                            e.stopPropagation();

                            // Hide all submenus except the current one
                            document.querySelectorAll('.submenu').forEach(submenu => {
                                if (submenu !== this.querySelector('.submenu')) {
                                    submenu.style.display = 'none';
                                }
                            });

                            const submenu = this.querySelector('.submenu');
                            if (submenu) {
                                submenu.style.display = submenu.style.display === 'block' ? 'none' : 'block';

                                const submenuRect = submenu.getBoundingClientRect();
                                const viewportWidth = window.innerWidth;
                                const viewportHeight = window.innerHeight;
                                const marginLeft = 200; // 200px margin

                                // Calculate space on the right considering the margin
                                const spaceOnRight = viewportWidth - (submenuRect.left + submenuRect.width + marginLeft);

                                if (spaceOnRight < 0) {
                                    // Not enough space on the right, show submenu on the left
                                    submenu.style.left = `-${submenuRect.width + marginLeft}px`;
                                } else {
                                    // Enough space on the right, position normally with margin
                                    submenu.style.left = `${marginLeft}px`;
                                }

                                // Calculate space on the bottom
                                const spaceOnBottom = viewportHeight - submenuRect.bottom;

                                if (spaceOnBottom < 0) {
                                    // Not enough space on the bottom, show submenu on the top
                                    submenu.style.top = `-${submenuRect.height}px`;
                                } else {
                                    // Enough space on the bottom, position normally
                                    submenu.style.top = `0px`;
                                }

                                // Additional checks to ensure the submenu is fully visible within viewport
                                if (submenuRect.left < 0) {
                                    submenu.style.left = `${marginLeft}px`;
                                }
                                if (submenuRect.top < 0) {
                                    submenu.style.top = `0px`;
                                }
                            }
                        });
                    });

                    // Handle refresh menu item click
                    document.addEventListener('click', function(e) {
                        // Check if clicked element or parent contains "Refresh" text
                        const target = e.target.closest('li');
                        if (target && target.textContent.trim() === 'Refresh') {
                            const overlay = document.getElementById('refreshOverlay');
                            overlay.classList.add('flash');
                            
                            // Remove the class after animation completes
                            setTimeout(() => {
                                overlay.classList.remove('flash');
                            }, 200);
                            
                            // Hide context menu
                            contextMenu.style.display = 'none';
                        }
                    });

                    // Switchable options with swipe animations
                    document.querySelectorAll('.search-panel .top-bar .options .option:not(.more-options .option)').forEach((option, index, options) => {
                        option.addEventListener('click', function () {
                            // Remove 'selected' class from all options except 'More'
                            options.forEach(opt => {
                                if (!opt.parentElement.classList.contains('more-options')) {
                                    opt.classList.remove('selected');
                                }
                            });

                            // Add 'selected' class to the clicked option
                            this.classList.add('selected');

                            // Hide the title and content under the "All" option
                            document.querySelector('.suggested-title').style.display = 'none';
                            document.querySelector('.suggested-apps').style.display = 'none';
                            document.querySelector('.top-apps-title').style.display = 'none';
                            document.querySelector('.top-apps-grid').style.display = 'none';
                            document.querySelector('.quick-searches-title').style.display = 'none';
                            document.querySelector('.quick-searches').style.display = 'none';

                            // Hide other content sections inside the search panel
                            document.querySelectorAll('.search-content .content-section').forEach(section => section.style.display = 'none');

                            // Determine which content to show based on the selected option
                            const optionText = this.textContent.trim().toLowerCase();
                            const contentId = optionText === 'all' ? 'all' : optionText;
                            const contentSection = document.getElementById(contentId + '-content');

                            if (contentId === 'all') {
                                // Show "All" content and titles again
                                document.querySelector('.suggested-title').style.display = 'block';
                                document.querySelector('.suggested-apps').style.display = 'block';
                                document.querySelector('.top-apps-title').style.display = 'block';
                                document.querySelector('.top-apps-grid').style.display = 'flex';
                                document.querySelector('.quick-searches-title').style.display = 'block';
                                document.querySelector('.quick-searches').style.display = 'flex';
                            } else if (contentSection) {
                                // Show content based on selected option
                                contentSection.style.display = 'block';

                                // Apply swipe animation
                                const direction = index > 0 ? 'left' : 'right';
                                contentSection.classList.add(`swipe-${direction}`);
                            }
                        });
                    });

                    // Swipe animation CSS
                    document.querySelector('head').insertAdjacentHTML('beforeend', `
<style>
    .swipe-left {
        animation: swipe-left 0.5s ease-out forwards;
    }
    .swipe-right {
        animation: swipe-right 0.5s ease-out forwards;
    }
    @keyframes swipe-left {
        from { transform: translateX(0%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
    }
    @keyframes swipe-right {
        from { transform: translateX(-100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
    }
</style>
`);

                    // Ensure submenus remain open on hover
                    document.querySelectorAll('.submenu').forEach(submenu => {
                        submenu.addEventListener('mouseenter', function () {
                            this.style.display = 'block';
                        });

                        submenu.addEventListener('mouseleave', function () {
                            this.style.display = 'none';
                        });
                    });

                    // Manage icons section in the start menu
                    startIcon.addEventListener('click', function () {
                        if (!isIconsSectionExpanded) {
                            iconsSection.style.width = '100%';

                            document.querySelectorAll('.start-menu .section .icons-section .icon-text').forEach(text => {
                                text.style.opacity = '1';
                                text.style.marginLeft = '10px';
                            });

                            document.querySelectorAll('.start-menu .section .icons-section .icon').forEach(icon => {
                                icon.style.display = 'flex';
                                icon.style.alignItems = 'center';
                                icon.style.padding = '8px';
                                icon.style.cursor = 'pointer';
                                icon.style.width = '100%';
                                icon.style.position = 'relative';
                                icon.style.right = '0';
                                icon.style.marginBottom = '10px';
                            });
                        } else {
                            iconsSection.style.width = '10px';

                            document.querySelectorAll('.start-menu .section .icons-section .icon-text').forEach(text => {
                                text.style.opacity = '0';
                                text.style.marginLeft = '5px';
                            });

                            document.querySelectorAll('.start-menu .section .icons-section .icon').forEach(icon => {
                                icon.style.display = 'flex';
                                icon.style.alignItems = 'center';
                                icon.style.padding = '8px';
                                icon.style.cursor = 'pointer';
                                icon.style.width = '100%';
                                icon.style.position = 'relative';
                                icon.style.right = '85%';
                                icon.style.marginBottom = '10px';
                            });
                        }
                        isIconsSectionExpanded = !isIconsSectionExpanded;
                    });

                    // Expand/collapse content on click
                    appContainer.addEventListener('click', function () {
                        if (expandableContent.style.maxHeight) {
                            expandableContent.style.maxHeight = null;
                            expandableContent.style.opacity = '0';
                            appContainer.classList.remove('expanded');

                            setTimeout(function () {
                                expandableContent.classList.remove('show');
                            }, 300);
                        } else {
                            expandableContent.classList.add('show');
                            expandableContent.style.maxHeight = expandableContent.scrollHeight + 'px';
                            expandableContent.style.opacity = '1';
                            appContainer.classList.add('expanded');
                        }
                    });

                    // Show search panel with a delay
                    function showSearchPanelWithDelay() {
                        showPanelTimeout = setTimeout(() => {
                            searchPanel.style.display = 'block';
                        }, 800);
                    }

                    searchPanelIcon.addEventListener('mouseenter', showSearchPanelWithDelay);
                    searchInput.addEventListener('focus', showSearchPanelWithDelay);

                    // Hide the search panel on click outside
                    document.addEventListener('click', (event) => {
                        if (!searchContainer.contains(event.target) && !searchPanel.contains(event.target)) {
                            searchPanel.style.display = 'none';
                            clearTimeout(showPanelTimeout);
                        }
                    });

                    // Clear timeout if user leaves the "Cave" image or search input
                    searchPanelIcon.addEventListener('mouseleave', () => {
                        clearTimeout(showPanelTimeout);
                    });

                    searchInput.addEventListener('blur', () => {
                        clearTimeout(showPanelTimeout);
                    });

                    // Handle dropdowns
                    function hideAllDropdowns() {
                        document.querySelectorAll('.search-panel .dropdown').forEach(dropdown => {
                            dropdown.style.display = 'none';
                        });
                        isMoreDropdownOpen = false;
                        isUserDropdownOpen = false;
                    }

                    moreOptions.addEventListener('click', function (event) {
                        event.stopPropagation();
                        const dropdown = moreOptions.querySelector('.dropdown');
                        if (isMoreDropdownOpen) {
                            dropdown.style.display = 'none';
                        } else {
                            hideAllDropdowns();
                            dropdown.style.display = 'block';
                        }
                        isMoreDropdownOpen = !isMoreDropdownOpen;
                    });

                    moreOptions.addEventListener('mouseenter', function () {
                        if (!isMoreDropdownOpen) {
                            const dropdown = moreOptions.querySelector('.dropdown');
                            dropdown.style.display = 'block';
                        }
                    });

                    moreOptions.addEventListener('mouseleave', function () {
                        if (!isMoreDropdownOpen) {
                            const dropdown = moreOptions.querySelector('.dropdown');
                            dropdown.style.display = 'none';
                        }
                    });

                    userDropdown.addEventListener('click', function (event) {
                        event.stopPropagation();
                        const dropdown = userDropdown.querySelector('.dropdown');
                        if (isUserDropdownOpen) {
                            dropdown.style.display = 'none';
                        } else {
                            hideAllDropdowns();
                            dropdown.style.display = 'block';
                        }
                        isUserDropdownOpen = !isUserDropdownOpen;
                    });

                    document.addEventListener('click', function () {
                        hideAllDropdowns();
                    });

                    document.querySelectorAll('.search-panel .dropdown').forEach(dropdown => {
                        dropdown.addEventListener('click', function (event) {
                            event.stopPropagation();
                        });
                    });

                    closeButton.addEventListener('click', function () {
                        searchPanel.style.display = 'none';
                        hideAllDropdowns();
                    });
                });

                document.addEventListener('DOMContentLoaded', function () {
                    const userAccountImage = document.querySelector('.search-panel .top-bar .user-account img');

                    if (userAccountImage) {
                        // Disable right-click context menu
                        userAccountImage.addEventListener('contextmenu', function (e) {
                            e.preventDefault();
                        });

                        // Disable left-click
                        userAccountImage.addEventListener('mousedown', function (e) {
                            if (e.button === 0) { // Left-click button
                                e.preventDefault();
                            }
                        });

                        // Disable tap-and-hold (touch devices)
                        userAccountImage.addEventListener('touchstart', function (e) {
                            e.preventDefault();
                        });

                        // Optionally disable drag (to prevent dragging)
                        userAccountImage.addEventListener('dragstart', function (e) {
                            e.preventDefault();
                        });
                    }
                });

                document.addEventListener('DOMContentLoaded', function () {
                    const taskViewIcon = document.querySelector('.task-view-icon');
                    const overlay = document.querySelector('.overlay');
                    const plusContainer = document.querySelector('.plus-container');
                    const taskbar = document.querySelector('.taskbar');
                    const startMenu = document.getElementById('startMenu');
                    const searchPanel = document.querySelector('.search-panel');
                    const searchIcon = document.querySelector('.search-icon');

                    let isOverlayVisible = false;
                    let isSearchIconVisible = false;

                    function toggleOverlay() {
                        if (isOverlayVisible) {
                            overlay.style.display = 'none';
                            taskViewIcon.querySelector('.default-img').style.display = 'block';
                            taskViewIcon.querySelector('.hover-img').style.display = 'none';
                            plusContainer.classList.remove('zoom-in');
                            plusContainer.classList.add('zoom-out');
                            // Show Start Menu and Search Panel if they were hidden
                            if (startMenu.classList.contains('show')) {
                                startMenu.style.display = 'block';
                            }
                            if (searchPanel.style.display === 'none') {
                                searchPanel.style.display = 'block';
                            }
                        } else {
                            overlay.style.display = 'flex';
                            taskViewIcon.querySelector('.default-img').style.display = 'none';
                            taskViewIcon.querySelector('.hover-img').style.display = 'block';
                            plusContainer.classList.remove('zoom-out');
                            plusContainer.classList.add('zoom-in');
                            // Hide Start Menu and Search Panel
                            startMenu.style.display = 'none';
                            searchPanel.style.display = 'none';
                        }
                        isOverlayVisible = !isOverlayVisible;
                    }

                    taskViewIcon.addEventListener('click', function (event) {
                        event.stopPropagation();
                        toggleOverlay();
                    });

                    document.addEventListener('click', function (event) {
                        if (isOverlayVisible && !overlay.contains(event.target) && event.target !== taskViewIcon) {
                            toggleOverlay();
                        }
                    });

                    overlay.addEventListener('click', function (event) {
                        if (isOverlayVisible) {
                            toggleOverlay();
                        }
                    });

                    plusContainer.addEventListener('click', function (event) {
                        event.stopPropagation();
                    });

                    document.addEventListener('keydown', function (event) {
                        // Check for Window + Tab
                        if (event.key === 'Tab' && (event.metaKey || event.ctrlKey)) {
                            event.preventDefault(); // Prevent default behavior of the shortcut
                            toggleOverlay(); // Toggle the overlay state
                        }
                    });

                    const contextMenu = document.getElementById('taskbarContextMenu');

                    // Show context menu on right-click on the taskbar
                    taskbar.addEventListener('contextmenu', function (e) {
                        e.preventDefault();
                        if (e.target.classList.contains('taskbar')) {
                            let menuX = e.pageX;
                            let menuY = e.pageY - contextMenu.offsetHeight; // Position above the taskbar

                            const viewportWidth = window.innerWidth;
                            const contextMenuWidth = contextMenu.offsetWidth;

                            if (menuX + contextMenuWidth > viewportWidth) {
                                menuX = viewportWidth - contextMenuWidth;
                            }

                            if (menuY < 0) { // Ensure menu is within viewport bounds
                                menuY = 0;
                            }

                            contextMenu.style.left = `${menuX}px`;
                            contextMenu.style.top = `${menuY}px`;
                            contextMenu.style.display = 'block';
                        }
                    });

                    // Hide context menu on click outside
                    document.addEventListener('click', function (e) {
                        if (!contextMenu.contains(e.target) && !taskbar.contains(e.target)) {
                            contextMenu.style.display = 'none';
                        }
                    });

                    // Show sub-menus on hover
                    contextMenu.querySelectorAll('li').forEach(item => {
                        item.addEventListener('mouseover', function () {
                            const subMenu = this.querySelector('.sub-menu');
                            if (subMenu) {
                                subMenu.style.display = 'block';

                                // Adjust sub-menu position if it goes beyond the viewport
                                const itemRect = this.getBoundingClientRect();
                                const subMenuRect = subMenu.getBoundingClientRect();
                                const viewportWidth = window.innerWidth;

                                // Check if there's enough space on the right
                                const spaceOnRight = viewportWidth - itemRect.right;
                                if (spaceOnRight < subMenuRect.width) {
                                    // Not enough space on the right, position sub-menu to the left
                                    subMenu.style.left = `${-subMenuRect.width}px`; // Position sub-menu to the left of the parent
                                } else {
                                    // Enough space on the right, reset to default positioning
                                    subMenu.style.left = '100%';
                                }
                            }
                        });

                        item.addEventListener('mouseout', function () {
                            const subMenu = this.querySelector('.sub-menu');
                            if (subMenu) {
                                subMenu.style.display = 'none';
                            }
                        });
                    });

                    // Handle clicks in the Search sub-menu
                    contextMenu.querySelectorAll('.sub-menu').forEach(subMenu => {
                        subMenu.addEventListener('click', function (e) {
                            const clickedItem = e.target.closest('li');
                            if (!clickedItem) return;

                            if (clickedItem.textContent.includes('Show search icon')) {
                                updateCheckMarks(clickedItem, 'Show search icon', 'Show search box');
                            } else if (clickedItem.textContent.includes('Show search box')) {
                                updateCheckMarks(clickedItem, 'Show search box', 'Show search icon');
                            }
                        });
                    });

                    function updateCheckMarks(selectedItem, addItemText, removeItemText) {
                        const subMenu = selectedItem.closest('.sub-menu');
                        const allItems = subMenu.querySelectorAll('li');
                        const checkMarkIcon = '<i class="fa-solid fa-check left-icon"></i>';

                        allItems.forEach(item => {
                            const checkMark = item.querySelector('.fa-check');
                            if (item.textContent.includes(addItemText)) {
                                if (!checkMark) item.insertAdjacentHTML('afterbegin', checkMarkIcon);
                                if (addItemText === 'Show search icon') {
                                    document.querySelector('.search-container').classList.add('transparent');
                                    document.querySelector('.search-box').style.display = 'none';
                                    document.querySelector('.search-panel-icon').style.display = 'none';
                                    updateSearchIconVisibility(true);
                                } else if (addItemText === 'Show search box') {
                                    document.querySelector('.search-container').classList.remove('transparent');
                                    document.querySelector('.search-box').style.display = 'block';
                                    document.querySelector('.search-panel-icon').style.display = 'block';
                                    updateSearchIconVisibility(true);
                                }
                            } else if (item.textContent.includes(removeItemText)) {
                                if (checkMark) checkMark.remove();
                                if (removeItemText === 'Show search icon') {
                                    document.querySelector('.search-container').classList.remove('transparent');
                                    document.querySelector('.search-box').style.display = 'block';
                                    document.querySelector('.search-panel-icon').style.display = 'block';
                                    updateSearchIconVisibility(false);
                                } else if (removeItemText === 'Show search box') {
                                    document.querySelector('.search-container').classList.add('transparent');
                                    document.querySelector('.search-box').style.display = 'none';
                                    document.querySelector('.search-panel-icon').style.display = 'none';
                                    updateSearchIconVisibility(true);
                                }
                            }
                        });

                        // Hide the context menu after selection
                        contextMenu.style.display = 'none';
                    }

                    function updateSearchIconVisibility(showSearchIcon) {
                        if (showSearchIcon) {
                            searchIcon.style.display = 'block';
                            searchIcon.setAttribute('title', 'Type here to search');
                            isSearchIconVisible = true;
                        } else {
                            searchIcon.style.display = 'none';
                            searchIcon.removeAttribute('title');
                            isSearchIconVisible = false;
                        }
                    }

                    // Add event listener for showing/hiding the search panel when the search icon is clicked
                    searchIcon.addEventListener('click', function () {
                        if (isSearchIconVisible) {
                            // Toggle the search panel visibility
                            if (searchPanel.style.display === 'block') {
                                searchPanel.style.display = 'none'; // Hide the search panel
                            } else {
                                searchPanel.style.display = 'block'; // Show the search panel
                                // Hide start menu when showing search panel
                                const startMenu = document.getElementById('startMenu');
                                if (startMenu && startMenu.classList.contains('show')) {
                                    startMenu.style.transform = 'translateY(100%)';
                                    startMenu.style.opacity = '0';
                                    setTimeout(() => { startMenu.style.display = 'none'; }, 300);
                                    startMenu.classList.remove('show');
                                    const windowsIcon = document.querySelector('.windows-icon');
                                    if (windowsIcon) windowsIcon.classList.remove('active');
                                }
                            }
                        }
                    });
                });

                document.addEventListener('DOMContentLoaded', function () {
                    const wifiIconContainer = document.querySelector('.wifi-icon-container');
                    const wifiPanel = document.querySelector('.wifi-panel');
                    const notificationIcon = document.querySelector('.notification-icon');
                    const notificationPanel = document.querySelector('.notification-panel');
                    const calendarPanel = document.getElementById('calendarPanel');
                    const timeDateContainer = document.querySelector('.time-date-container');
                    const volumeIconContainer = document.querySelector('.volume-icon-container');
                    const volumePanel = document.querySelector('.volume-panel');
                    const volumeSlider = document.querySelector('#volumeSlider');
                    const batteryIconContainer = document.querySelector('.battery-icon-container');
                    const batteryPanel = document.getElementById('battery-panel');
                    const upIconContainer = document.querySelector('.up-icon-container');
                    const hiddenIconsPanel = document.querySelector('.hidden-icons-panel');

                    function hideAllPanels(except = null) {
                        const panels = [
                            { el: wifiPanel, active: 'active', hide: 'hide' },
                            { el: notificationPanel, active: 'show', hide: 'hide' },
                            { el: calendarPanel, active: 'show', hide: 'hide' },
                            { el: volumePanel, active: 'active' },
                            { el: batteryPanel, active: 'active' },
                            { el: hiddenIconsPanel, active: 'active' }
                        ];

                        panels.forEach(p => {
                            if (!p.el || p.el === except) return;

                            if (p.el.classList.contains(p.active)) {
                                p.el.classList.remove(p.active);
                                if (p.hide) p.el.classList.add(p.hide);
                                setTimeout(() => {
                                    if (!p.el.classList.contains(p.active)) {
                                        p.el.style.display = 'none';
                                        p.el.style.pointerEvents = 'none';
                                    }
                                }, 300);
                            } else {
                                p.el.style.display = 'none';
                                p.el.style.pointerEvents = 'none';
                            }
                        });

                        if (upIconContainer && except !== hiddenIconsPanel) {
                            upIconContainer.setAttribute('title', 'Show hidden icons');
                        }
                    }

                    function toggleWifiPanel() {
                        if (wifiPanel.classList.contains('active')) {
                            hideAllPanels();
                        } else {
                            hideAllPanels(wifiPanel);
                            wifiPanel.style.display = 'block';
                            wifiPanel.style.pointerEvents = 'auto';
                            setTimeout(() => {
                                wifiPanel.classList.remove('hide');
                                wifiPanel.classList.add('active');
                            }, 10);
                        }
                    }

                    function toggleNotificationPanel() {
                        if (notificationPanel.classList.contains('show')) {
                            hideAllPanels();
                        } else {
                            hideAllPanels(notificationPanel);
                            notificationPanel.style.display = 'block';
                            notificationPanel.style.pointerEvents = 'auto';
                            setTimeout(() => {
                                notificationPanel.classList.remove('hide');
                                notificationPanel.classList.add('show');
                                if (notificationIcon) notificationIcon.classList.add('active');
                            }, 10);
                        }
                    }

                    function toggleCalendarPanel() {
                        if (calendarPanel.classList.contains('show')) {
                            hideAllPanels();
                        } else {
                            hideAllPanels(calendarPanel);
                            calendarPanel.style.display = 'block';
                            calendarPanel.style.pointerEvents = 'auto';
                            setTimeout(() => {
                                calendarPanel.classList.remove('hide');
                                calendarPanel.classList.add('show');
                            }, 10);
                        }
                    }

                    function toggleVolumePanel() {
                        if (volumePanel.classList.contains('active')) {
                            hideAllPanels();
                        } else {
                            hideAllPanels(volumePanel);
                            volumePanel.style.display = 'block';
                            volumePanel.style.pointerEvents = 'auto';
                            setTimeout(() => {
                                volumePanel.classList.add('active');
                            }, 10);
                        }
                        updateMuteIconState(volumeSlider.value);
                    }

                    function toggleBatteryPanel() {
                        if (batteryPanel.classList.contains('active')) {
                            hideAllPanels();
                        } else {
                            hideAllPanels(batteryPanel);
                            batteryPanel.style.display = 'block';
                            batteryPanel.style.pointerEvents = 'auto';
                            setTimeout(() => {
                                batteryPanel.classList.add('active');
                            }, 10);
                        }
                    }

                    function toggleUpIconPanel() {
                        if (hiddenIconsPanel.classList.contains('active')) {
                            hideAllPanels();
                        } else {
                            hideAllPanels(hiddenIconsPanel);
                            hiddenIconsPanel.style.display = 'block';
                            hiddenIconsPanel.style.pointerEvents = 'auto';
                            setTimeout(() => {
                                hiddenIconsPanel.classList.add('active');
                                upIconContainer.setAttribute('title', 'Hide');
                            }, 10);
                        }
                    }

                    if (wifiIconContainer) {
                        wifiIconContainer.addEventListener('click', function (event) {
                            event.stopPropagation();
                            toggleWifiPanel();
                        });
                    }

                    if (notificationIcon) {
                        notificationIcon.addEventListener('click', function (event) {
                            event.stopPropagation();
                            toggleNotificationPanel();
                        });
                    }

                    if (timeDateContainer) {
                        timeDateContainer.addEventListener('click', function (event) {
                            event.stopPropagation();
                            toggleCalendarPanel();
                        });
                    }

                    if (volumeIconContainer) {
                        volumeIconContainer.addEventListener('click', function (event) {
                            event.stopPropagation();
                            toggleVolumePanel();
                        });
                    }

                    if (batteryIconContainer) {
                        batteryIconContainer.addEventListener('click', function (event) {
                            event.stopPropagation();
                            toggleBatteryPanel();
                        });
                    }

                    if (upIconContainer) {
                        upIconContainer.addEventListener('click', function (event) {
                            event.stopPropagation();
                            toggleUpIconPanel();
                        });
                    }

                    document.addEventListener('click', function (event) {
                        if (!wifiPanel.contains(event.target) && !wifiIconContainer.contains(event.target) &&
                            !notificationPanel.contains(event.target) && !notificationIcon.contains(event.target) &&
                            !calendarPanel.contains(event.target) && !timeDateContainer.contains(event.target) &&
                            !volumePanel.contains(event.target) && !volumeIconContainer.contains(event.target) &&
                            !batteryPanel.contains(event.target) && !batteryIconContainer.contains(event.target) &&
                            !hiddenIconsPanel.contains(event.target) && !upIconContainer.contains(event.target)) {
                            hideAllPanels();
                        }
                    });

                    document.addEventListener('keydown', function (event) {
                        if (event.metaKey && event.key === 'a') {
                            event.preventDefault();
                            toggleNotificationPanel();
                        }
                    });

                    // Function to update mute icon state
                    function updateMuteIconState(volume) {
                        if (volume == 0) {
                            volumeIconContainer.classList.add('muted');
                            volumePanel.classList.add('muted');
                        } else {
                            volumeIconContainer.classList.remove('muted');
                            volumePanel.classList.remove('muted');
                        }
                    }

                    // Handle volume slider input
                    volumeSlider.addEventListener('input', function (e) {
                        const volume = e.target.value;
                        const volumeBars = document.querySelectorAll('.volume-control .volume-svg .bar');
                        const volumeContainerBars = document.querySelectorAll('.volume-icon-container .volume-svg .bar');
                        const volumePercentage = document.querySelector('.volume-percentage');

                        volumePercentage.textContent = volume;

                        e.target.style.background = `linear-gradient(to right, #0078d7 ${volume}%, gray ${volume}%)`;

                        updateMuteIconState(volume);

                        function updateBarColors(bars) {
                            bars.forEach((bar, index) => {
                                if (volume >= 66) {
                                    bar.style.stroke = '#fff';
                                } else if (volume >= 33) {
                                    bar.style.stroke = index < 2 ? '#fff' : '#898989';
                                } else if (volume >= 1) {
                                    bar.style.stroke = index < 1 ? '#fff' : '#898989';
                                } else {
                                    bar.style.stroke = '#898989';
                                }
                            });
                        }

                        // Apply color changes to both sets of bars
                        updateBarColors(volumeBars);
                        updateBarColors(volumeContainerBars);

                        // Update title attribute
                        volumeIconContainer.setAttribute('title', `Speakers: ${volume == 0 ? 'Muted' : volume + '%'}`);

                        // Ensure mute icon state is preserved in the volume container
                        updateMuteIconState(volume);
                    });

                    // Store the last non-zero volume level
                    let lastVolume = 50;

                    // Handle volume icon click to mute/unmute
                    const volumeSvgs = document.querySelectorAll('.volume-svg');
                    volumeSvgs.forEach(svg => {
                        svg.addEventListener('click', function () {
                            if (volumeSlider.value > 0) {
                                lastVolume = volumeSlider.value;
                                volumeSlider.value = 0;
                            } else {
                                volumeSlider.value = lastVolume;
                            }
                            volumeSlider.dispatchEvent(new Event('input'));
                        });
                    });

                    // Update lastVolume whenever the user changes the volume using the slider
                    volumeSlider.addEventListener('input', function () {
                        if (volumeSlider.value > 0) {
                            lastVolume = volumeSlider.value;
                        }
                    });

                    // Tooltip update on hover
                    volumeSvgs.forEach(svg => {
                        svg.addEventListener('mouseover', function () {
                            if (volumeSlider.value > 0) {
                                svg.setAttribute('title', 'Toggle mute');
                            } else {
                                svg.setAttribute('title', 'Toggle unmute');
                            }
                        });
                    });
                });

                document.addEventListener('DOMContentLoaded', function () {
                    const volumeSlider = document.querySelector('#volumeSlider');
                    const volumeIndicator = document.getElementById('volume-indicator');
                    const volumePercentageText = volumeIndicator.querySelector('.volume-percentage');
                    const blueBar = volumeIndicator.querySelector('.blue-bar');
                    const whiteBox = volumeIndicator.querySelector('.white-box');

                    let fadeTimeout;

                    // Load the sound effect
                    const sliderSound = new Audio('assets/audio/Background Error.mp3');

                    function updateVolumeIndicator(volume) {
                        if (volume == 0) {
                            volumePercentageText.textContent = 'âœ–';
                            volumePercentageText.classList.add('cross');
                        } else {
                            volumePercentageText.textContent = volume;
                            volumePercentageText.classList.remove('cross');
                        }

                        blueBar.style.height = `${volume}%`;
                        whiteBox.style.bottom = `calc(${volume}% - 15px)`;

                        volumeIndicator.classList.remove('hidden');
                        volumeIndicator.classList.add('visible');

                        clearTimeout(fadeTimeout);

                        fadeTimeout = setTimeout(() => {
                            volumeIndicator.classList.remove('visible');
                            volumeIndicator.classList.add('hidden');
                        }, 2000);
                    }

                    function playSliderSound() {
                        sliderSound.currentTime = 0; // Reset to the start
                        sliderSound.volume = volumeSlider.value / 100; // Adjust volume based on slider
                        sliderSound.play().catch(() => { }); // Handle autoplay restrictions silently
                    }

                    function stopSliderSound() {
                        sliderSound.pause(); // Stop the sound
                        sliderSound.currentTime = 0; // Reset to the start
                    }

                    // Handle volume slider input
                    volumeSlider.addEventListener('input', function () {
                        const volume = volumeSlider.value;

                        // Play the sound effect when interacting
                        playSliderSound();

                        updateVolumeIndicator(volume);
                    });

                    // Stop sound effect when interaction ends
                    volumeSlider.addEventListener('mouseup', stopSliderSound);
                    volumeSlider.addEventListener('touchend', stopSliderSound);
                    volumeSlider.addEventListener('change', stopSliderSound);

                    // Handle volume up and down keys on keyboard
                    document.addEventListener('keydown', function (event) {
                        if (event.code === 'AudioVolumeUp') {
                            volumeSlider.value = Math.min(100, parseInt(volumeSlider.value) + 2); // Increase volume by 2%
                            volumeSlider.dispatchEvent(new Event('input')); // Trigger input event to update UI
                        } else if (event.code === 'AudioVolumeDown') {
                            volumeSlider.value = Math.max(0, parseInt(volumeSlider.value) - 2); // Decrease volume by 2%
                            volumeSlider.dispatchEvent(new Event('input')); // Trigger input event to update UI
                        }
                    });
                });

                // Disable right-click
                const searchIconElement = document.getElementById('searchIcon');
                if (searchIconElement) {
                    searchIconElement.addEventListener('contextmenu', function (e) {
                        e.preventDefault();
                    });

                    // Disable drag and drop
                    searchIconElement.addEventListener('dragstart', function (e) {
                        e.preventDefault();
                    });
                }
            </script>
            <script>
                // Loading Screen Logic
                (function() {
                    const loadingScreen = document.getElementById('loaderContainer');
                    const backgroundImage = document.querySelector('.background-image');
                    const taskbar = document.querySelector('.taskbar');
                    const avatarImg = document.querySelector('.avatar-image');
                    
                    console.log('Loading screen element:', loadingScreen);
                    console.log('Background image element:', backgroundImage);
                    console.log('Taskbar element:', taskbar);
                    console.log('Avatar image:', avatarImg);
                    console.log('Avatar src:', avatarImg ? avatarImg.src : 'not found');
                    
                    // Show desktop after 4 seconds (increased from 2)
                    setTimeout(function() {
                        console.log('Starting fade out...');
                        if (loadingScreen) {
                            loadingScreen.classList.add('fade-out');
                            
                            setTimeout(function() {
                                console.log('Hiding loading screen and showing desktop...');
                                loadingScreen.style.display = 'none';
                                if (backgroundImage) backgroundImage.style.display = 'block';
                                if (taskbar) taskbar.style.display = 'flex';
                            }, 500);
                        }
                    }, 4000);
                })();

                // Context Menu
                document.addEventListener('DOMContentLoaded', function () {
                    const collapseExpandText = document.getElementById('collapseExpandText');
                    const buttonsContainer = document.getElementById('buttonsContainer');
                    const brightnessSlider = document.getElementById('brightnessSlider');
                    const sliderPercentage = document.getElementById('sliderPercentage');

                    // Collapse/Expand functionality
                    collapseExpandText.addEventListener('click', function () {
                        if (buttonsContainer.classList.contains('collapsed')) {
                            buttonsContainer.classList.remove('collapsed');
                            collapseExpandText.textContent = 'Collapse';
                        } else {
                            buttonsContainer.classList.add('collapsed');
                            collapseExpandText.textContent = 'Expand';
                        }
                    });

                    // Brightness slider functionality
                    brightnessSlider.addEventListener('input', function () {
                        const value = this.value;
                        const percentagePosition = (this.clientWidth * value) / 100;

                        // Update the slider percentage display
                        sliderPercentage.textContent = `${value}`;
                        sliderPercentage.style.left = `${percentagePosition}px`;
                        this.style.background = `linear-gradient(to right, #0078d7 ${value}%, gray ${value}%)`;

                        // Adjust page brightness
                        const brightnessValue = value / 100; // Convert percentage to a 0-1 scale
                        document.body.style.filter = `brightness(${brightnessValue})`;
                    });

                    document.querySelectorAll('.button-item').forEach(function (button) {
                        button.addEventListener('click', function () {
                            // Toggle the 'active' class on the clicked button
                            this.classList.toggle('active');
                        });
                    });
                });

                document.addEventListener('DOMContentLoaded', () => {
                    const image = document.querySelector('.search-panel-icon');

                    // Disable dragging
                    image.addEventListener('dragstart', (event) => {
                        event.preventDefault();
                    });

                    // Disable right-click (context menu) and holding
                    image.addEventListener('contextmenu', (event) => {
                        event.preventDefault();
                    });

                    image.addEventListener('mousedown', (event) => {
                        if (event.button === 1) { // Middle mouse button
                            event.preventDefault();
                        }
                    });
                });

                // Keyboard shortcut for opening calendar panel
                document.addEventListener('keydown', function (event) {
                    if (event.metaKey && event.altKey && event.key === 'd') {
                        event.preventDefault();
                        toggleCalendarPanel();
                    }
                });

                // Update time and date function
                function updateTimeAndDate() {
                    const timeElement = document.getElementById('time');
                    const dateElement = document.getElementById('date');
                    const now = new Date();

                    let hours = now.getHours();
                    const minutes = now.getMinutes();
                    const ampm = hours >= 12 ? 'PM' : 'AM';
                    hours = hours % 12;
                    hours = hours ? hours : 12;
                    const formattedTime = `${hours}:${minutes.toString().padStart(2, '0')} ${ampm}`;

                    const day = now.getDate().toString().padStart(2, '0');
                    const month = (now.getMonth() + 1).toString().padStart(2, '0');
                    const year = now.getFullYear();
                    const formattedDate = `${day}/${month}/${year}`;

                    timeElement.textContent = formattedTime;
                    dateElement.textContent = formattedDate;

                    const dayName = now.toLocaleDateString('en-US', { weekday: 'long' });
                    const monthName = now.toLocaleDateString('en-US', { month: 'long' });
                    const fullDate = `${dayName}, ${day} ${monthName} ${year}`;
                    dateElement.title = fullDate;
                }

                updateTimeAndDate();
                setInterval(updateTimeAndDate, 1);

                function updateCalendarTime() {
                    const timeElement = document.getElementById('calendarTime');
                    const secondsAMPMElement = document.getElementById('calendarSecondsAMPM');
                    const dateElement = document.getElementById('calendarDate');
                    const now = new Date();

                    let hours = now.getHours();
                    const minutes = now.getMinutes();
                    const seconds = now.getSeconds();
                    const ampm = hours >= 12 ? 'pm' : 'am';

                    hours = hours % 12;
                    hours = hours ? hours : 12;
                    const formattedTime = `${hours}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    const formattedSecondsAMPM = `${ampm}`;

                    const dayName = now.toLocaleDateString('en-US', { weekday: 'long' });
                    const day = now.getDate().toString().padStart(2, '0');
                    const monthName = now.toLocaleDateString('en-US', { month: 'long' });
                    const year = now.getFullYear();
                    const formattedDate = `${dayName}, ${day} ${monthName} ${year}`;

                    timeElement.textContent = formattedTime;
                    secondsAMPMElement.textContent = formattedSecondsAMPM;
                    dateElement.textContent = formattedDate;
                }

                updateCalendarTime();
                setInterval(updateCalendarTime, 1);

                document.addEventListener('DOMContentLoaded', function () {
                    const calendarGrid = document.getElementById('calendarGrid');
                    const calendarMonthYear = document.getElementById('calendarMonthYear');
                    const prevMonthButton = document.getElementById('prevMonth');
                    const nextMonthButton = document.getElementById('nextMonth');
                    const calendarDate = document.getElementById('calendarDate');
                    let currentMonth = new Date().getMonth();
                    let currentYear = new Date().getFullYear();
                    const now = new Date();

                    function renderCalendar(month, year) {
                        const firstDay = new Date(year, month).getDay();
                        const daysInMonth = new Date(year, month + 1, 0).getDate();
                        const daysInPrevMonth = new Date(year, month, 0).getDate();
                        let calendarHTML = '';

                        // Previous month's days
                        for (let i = firstDay - 1; i >= 0; i--) {
                            calendarHTML += `<div class="day-cell inactive">${daysInPrevMonth - i}</div>`;
                        }

                        // Current month's days
                        for (let day = 1; day <= daysInMonth; day++) {
                            const isToday = day === now.getDate() && month === now.getMonth() && year === now.getFullYear();
                            calendarHTML += `<div class="day-cell ${isToday ? 'current-day' : ''}">${day}</div>`;
                        }

                        // Next month's days
                        const remainingCells = 42 - (firstDay + daysInMonth);
                        for (let i = 1; i <= remainingCells; i++) {
                            calendarHTML += `<div class="day-cell inactive">${i}</div>`;
                        }

                        calendarGrid.innerHTML = calendarHTML;
                        calendarMonthYear.textContent = `${new Date(year, month).toLocaleString('default', { month: 'long' })} ${year}`;
                    }

                    function changeMonth(delta) {
                        currentMonth += delta;
                        if (currentMonth < 0) {
                            currentMonth = 11;
                            currentYear -= 1;
                        } else if (currentMonth > 11) {
                            currentMonth = 0;
                            currentYear += 1;
                        }
                        renderCalendar(currentMonth, currentYear);
                    }

                    // Load sound effects
                    const scrollUpSound = new Audio('assets/audio/Scroll Up.mp3');
                    const scrollDownSound = new Audio('assets/audio/Scroll Down.mp3');

                    // Function to play sound
                    function playSound(sound) {
                        sound.currentTime = 0; // Reset to the start
                        sound.play();
                    }

                    // Scroll through months with buttons and wheel
                    prevMonthButton.addEventListener('click', () => {
                        changeMonth(-1);
                        playSound(scrollUpSound);
                    });

                    nextMonthButton.addEventListener('click', () => {
                        changeMonth(1);
                        playSound(scrollDownSound);
                    });

                    document.getElementById('calendarPanel').addEventListener('wheel', function (event) {
                        if (event.deltaY < 0) {
                            changeMonth(-1);
                            playSound(scrollUpSound);
                        } else if (event.deltaY > 0) {
                            changeMonth(1);
                            playSound(scrollDownSound);
                        }
                    });

                    // Go to current date on tap
                    calendarDate.addEventListener('click', () => {
                        currentMonth = now.getMonth();
                        currentYear = now.getFullYear();
                        renderCalendar(currentMonth, currentYear);
                    });

                    // Initial render of the calendar
                    renderCalendar(currentMonth, currentYear);
                });

                document.addEventListener('DOMContentLoaded', function () {
                    const calendarGrid = document.getElementById('calendarGrid');
                    const calendarDate = document.getElementById('calendarDate');
                    const selectedDate = document.getElementById('selectedDate');
                    const eventInput = document.getElementById('eventInput');
                    const noEvents = document.getElementById('noEvents');
                    const toggleAgenda = document.getElementById('toggleAgenda');
                    const toggleText = document.getElementById('toggleText');
                    const toggleArrow = document.getElementById('toggleArrow'); // Arrow span reference
                    const now = new Date();
                    let currentMonth = now.getMonth();
                    let currentYear = now.getFullYear();
                    let isAgendaVisible = true; // Initial state is agenda visible

                    function updateSelectedDate(date) {
                        const dayName = date.toLocaleDateString('en-US', { weekday: 'long' });
                        const day = date.getDate().toString().padStart(2, '0');
                        if (date.toDateString() === now.toDateString()) {
                            selectedDate.textContent = "Today";
                            selectedDate.classList.add('today');
                        } else {
                            selectedDate.textContent = `${dayName} ${day}`;
                            selectedDate.classList.remove('today');
                        }
                    }

                    function handleDayClick(event) {
                        if (event.target.classList.contains('day-cell')) {
                            // Remove 'selected' class from all cells
                            document.querySelectorAll('.calendar-grid .day-cell').forEach(cell => cell.classList.remove('selected'));

                            // Add 'selected' class to the clicked cell
                            event.target.classList.add('selected');

                            // Update selected date
                            const day = parseInt(event.target.textContent, 10);
                            const date = new Date(currentYear, currentMonth, day);
                            updateSelectedDate(date);
                        }
                    }

                    function handleTodayClick() {
                        updateSelectedDate(now);
                        // Remove 'selected' class from all cells
                        document.querySelectorAll('.calendar-grid .day-cell').forEach(cell => cell.classList.remove('selected'));
                    }

                    function renderCalendar(month, year) {
                        const firstDay = new Date(year, month).getDay();
                        const daysInMonth = new Date(year, month + 1, 0).getDate();
                        const daysInPrevMonth = new Date(year, month, 0).getDate();
                        let calendarHTML = '';

                        // Previous month's days
                        for (let i = firstDay - 1; i >= 0; i--) {
                            calendarHTML += `<div class="day-cell inactive">${daysInPrevMonth - i}</div>`;
                        }

                        // Current month's days
                        for (let day = 1; day <= daysInMonth; day++) {
                            const isToday = day === now.getDate() && month === now.getMonth() && year === now.getFullYear();
                            calendarHTML += `<div class="day-cell ${isToday ? 'current-day' : ''}">${day}</div>`;
                        }

                        // Next month's days
                        const remainingCells = 42 - (firstDay + daysInMonth);
                        for (let i = 1; i <= remainingCells; i++) {
                            calendarHTML += `<div class="day-cell inactive">${i}</div>`;
                        }

                        calendarGrid.innerHTML = calendarHTML;
                    }

                    function toggleAgendaVisibility() {
                        isAgendaVisible = !isAgendaVisible;
                        if (isAgendaVisible) {
                            eventInput.classList.remove('fade-hide');
                            noEvents.classList.remove('fade-hide');
                            selectedDate.classList.remove('fade-hide'); // Show selectedDate
                            eventInput.classList.add('fade-show');
                            noEvents.classList.add('fade-show');
                            selectedDate.classList.add('fade-show'); // Show selectedDate
                            toggleText.textContent = 'Hide agenda';
                            toggleArrow.classList.add('show');
                        } else {
                            eventInput.classList.remove('fade-show');
                            noEvents.classList.remove('fade-show');
                            selectedDate.classList.remove('fade-show'); // Hide selectedDate
                            eventInput.classList.add('fade-hide');
                            noEvents.classList.add('fade-hide');
                            selectedDate.classList.add('fade-hide'); // Hide selectedDate
                            toggleText.textContent = 'Show agenda';
                            toggleArrow.classList.remove('show');
                        }
                    }

                    // Initial render of the calendar
                    renderCalendar(currentMonth, currentYear);

                    calendarGrid.addEventListener('click', handleDayClick);
                    calendarDate.addEventListener('click', handleTodayClick);
                    toggleAgenda.addEventListener('click', toggleAgendaVisibility);
                });

                document.addEventListener('DOMContentLoaded', function () {
                    const buttons = document.querySelectorAll('.interactive-icon');
                    const wifiButton = document.querySelector('.interactive-icon img[alt="Wi-Fi"]').closest('.interactive-icon');
                    const airplaneModeButton = document.querySelector('.interactive-icon img[alt="Airplane mode"]').closest('.interactive-icon');
                    const mobileHotspotButton = document.querySelector('.interactive-icon img[alt="Mobile Hotspot"]').closest('.interactive-icon');
                    const wifiPanelContent = document.querySelector('.wifi-panel-content');
                    const wifiPanelNewContent = document.querySelector('.wifi-panel-new-content');
                    const loadingAnimation = document.querySelector('.loading-animation');

                    function showPanelContent() {
                        wifiPanelContent.style.display = 'flex'; // Show panel content
                        wifiPanelNewContent.style.display = 'none'; // Hide no Wi-Fi content
                        loadingAnimation.style.display = 'none'; // Hide loading animation
                    }

                    function hidePanelContent() {
                        wifiPanelContent.style.display = 'none'; // Hide panel content
                        wifiPanelNewContent.style.display = 'none'; // Hide no Wi-Fi content
                        loadingAnimation.style.display = 'flex'; // Show loading animation
                        setTimeout(() => {
                            loadingAnimation.style.display = 'none'; // Hide loading animation after 3 seconds
                            wifiPanelContent.style.display = 'flex'; // Show panel content after loading
                        }, 4000); // 3 seconds delay
                    }

                    function toggleWifi(turnOn) {
                        if (turnOn) {
                            // Check if Airplane Mode is on, and if so, turn it off
                            if (airplaneModeButton.classList.contains('selected')) {
                                toggleAirplaneMode(); // Automatically turn Airplane Mode off
                            }

                            wifiButton.classList.add('selected');
                            console.log("Wi-Fi is turned on.");
                            hidePanelContent(); // Show loading animation initially
                        } else {
                            wifiButton.classList.remove('selected');
                            console.log("Wi-Fi is turned off.");
                            wifiPanelContent.style.display = 'none'; // Ensure panel content is hidden
                            wifiPanelNewContent.style.display = 'block'; // Show no Wi-Fi content
                            loadingAnimation.style.display = 'none'; // Ensure loading animation is hidden
                        }
                    }

                    function toggleAirplaneMode() {
                        if (airplaneModeButton.classList.contains('selected')) {
                            // Turning Airplane Mode off
                            airplaneModeButton.classList.remove('selected');
                            console.log("Airplane Mode is turned off.");
                            toggleWifi(true); // Automatically turn Wi-Fi on
                        } else {
                            // Turning Airplane Mode on
                            airplaneModeButton.classList.add('selected');
                            console.log("Airplane Mode is turned on.");
                            toggleWifi(false); // Turn off Wi-Fi when Airplane Mode is turned on
                        }
                    }

                    function handleMobileHotspot() {
                        console.log("Mobile Hotspot cannot be selected.");
                        mobileHotspotButton.classList.remove('selected');
                        mobileHotspotButton.classList.add('glitch');
                        setTimeout(() => mobileHotspotButton.classList.remove('glitch'), 1000); // Remove glitch effect after 1 second
                    }

                    buttons.forEach(button => {
                        button.addEventListener('click', () => {
                            const imgAltText = button.querySelector('img').alt;

                            if (imgAltText === 'Wi-Fi') {
                                toggleWifi(!wifiButton.classList.contains('selected'));
                            } else if (imgAltText === 'Airplane mode') {
                                toggleAirplaneMode();
                            } else if (imgAltText === 'Mobile Hotspot') {
                                handleMobileHotspot();
                            }
                        });
                    });

                    // Initialize Wi-Fi as selected by default
                    toggleWifi(true);
                });

                document.getElementById('battery-button').addEventListener('click', function () {
                    var batteryImage = document.querySelector('.battery-panel-header img');

                    // Toggle the image and class based on current state
                    if (batteryImage.classList.contains('battery-default')) {
                        batteryImage.src = 'assets/images/Battery-Saver.png';
                        batteryImage.classList.remove('battery-default');
                        batteryImage.classList.add('battery-saver');

                        // Add the filter to dim the page
                        document.body.style.filter = 'brightness(50%)';
                    } else {
                        batteryImage.src = 'assets/images/Battery.png';
                        batteryImage.classList.remove('battery-saver');
                        batteryImage.classList.add('battery-default');

                        // Remove the filter to restore normal brightness
                        document.body.style.filter = 'none';
                    }

                    // Toggle the 'selected' class on the button
                    this.classList.toggle('selected');
                });

                // Desktop Shortcuts Drag and Drop
                let deletedItems = [];

                function isOverlapping(el1, el2) {
                    const r1 = el1.getBoundingClientRect();
                    const r2 = el2.getBoundingClientRect();
                    const cx = r1.left + r1.width / 2;
                    const cy = r1.top + r1.height / 2;
                    return (cx >= r2.left && cx <= r2.right && cy >= r2.top && cy <= r2.bottom);
                }

                function makeDraggable(element) {
                    let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
                    const trashShortcut = document.getElementById('shortcut-trash');
                    const trashIcon = document.getElementById('trash-icon');
                    
                    element.onmousedown = function(e) {
                        if (e.button !== 0 || element === trashShortcut) return;
                        e.stopPropagation();
                        pos3 = e.clientX;
                        pos4 = e.clientY;
                        document.onmouseup = function() {
                            document.onmouseup = null;
                            document.onmousemove = null;
                            element.classList.remove('dragging');
                            if (trashShortcut && isOverlapping(element, trashShortcut)) {
                                element.style.display = 'none';
                                deletedItems.push({
                                    name: element.querySelector('span').textContent,
                                    img: element.querySelector('img').src,
                                    element: element
                                });
                                updateTrashUI();
                            }
                        };
                        document.onmousemove = function(e) {
                            pos1 = pos3 - e.clientX;
                            pos2 = pos4 - e.clientY;
                            pos3 = e.clientX;
                            pos4 = e.clientY;
                            let newTop = element.offsetTop - pos2;
                            let newLeft = element.offsetLeft - pos1;
                            
                            // Bounds check
                            const rect = document.querySelector('.background-image').getBoundingClientRect();
                            if (newTop < 0) newTop = 0;
                            if (newLeft < 0) newLeft = 0;
                            if (newTop + element.offsetHeight > rect.height - 40) newTop = rect.height - 40 - element.offsetHeight;
                            if (newLeft + element.offsetWidth > rect.width) newLeft = rect.width - element.offsetWidth;

                            element.style.top = newTop + "px";
                            element.style.left = newLeft + "px";

                            if (trashShortcut && isOverlapping(element, trashShortcut)) {
                                trashIcon.src = 'assets/images/recycle-bin-full.png';
                            } else if (deletedItems.length === 0) {
                                trashIcon.src = 'assets/images/recycle-bin.png';
                            }
                        };
                        element.classList.add('dragging');
                        element.style.zIndex = "1000";
                    };
                }

                function updateTrashUI() {
                    const trashGrid = document.getElementById('trash-grid');
                    const trashIcon = document.getElementById('trash-icon');
                    
                    trashGrid.innerHTML = '';
                    if (deletedItems.length === 0) {
                        trashIcon.src = 'assets/images/recycle-bin.png';
                    } else {
                        trashIcon.src = 'assets/images/recycle-bin-full.png';
                        deletedItems.forEach((item, index) => {
                            const div = document.createElement('div');
                            div.className = 'deleted-item';
                            div.innerHTML = `
                                <img src="${item.img}" alt="${item.name}">
                                <span>${item.name}</span>
                            `;
                            div.title = "Right click to restore";
                            div.oncontextmenu = (e) => {
                                e.preventDefault();
                                restoreItem(index);
                            };
                            trashGrid.appendChild(div);
                        });
                    }
                }

                function getNextAvailablePosition() {
                    const desktop = document.querySelector('.background-image');
                    const rect = desktop.getBoundingClientRect();
                    const taskbarHeight = 40;
                    const cellWidth = 100;
                    const cellHeight = 110;
                    const cols = Math.floor(rect.width / cellWidth);
                    const rows = Math.floor((rect.height - taskbarHeight) / cellHeight);

                    const shortcuts = Array.from(document.querySelectorAll('.desktop-shortcut')).filter(s => s.style.display !== 'none');
                    
                    // Vertical first arrangement (Windows style)
                    for (let c = 0; c < cols; c++) {
                        for (let r = 0; r < rows; r++) {
                            let x = 20 + (c * cellWidth);
                            let y = 20 + (r * cellHeight);
                            
                            let occupied = false;
                            for (let s of shortcuts) {
                                const sx = parseInt(s.style.left) || 0;
                                const sy = parseInt(s.style.top) || 0;
                                if (Math.abs(sx - x) < 40 && Math.abs(sy - y) < 40) {
                                    occupied = true;
                                    break;
                                }
                            }
                            
                            if (!occupied) return { x, y };
                        }
                    }
                    return { x: 20, y: 20 }; // Fallback
                }

                function restoreItem(index) {
                    const itemData = deletedItems[index];
                    const pos = getNextAvailablePosition();
                    itemData.element.style.left = pos.x + 'px';
                    itemData.element.style.top = pos.y + 'px';
                    itemData.element.style.display = 'flex';
                    deletedItems.splice(index, 1);
                    updateTrashUI();
                }

                function restoreAllItems() {
                    deletedItems.forEach(item => {
                        const pos = getNextAvailablePosition();
                        item.element.style.left = pos.x + 'px';
                        item.element.style.top = pos.y + 'px';
                        item.element.style.display = 'flex';
                    });
                    deletedItems = [];
                    updateTrashUI();
                }

                function emptyTrash() {
                    deletedItems.forEach(item => item.element.remove());
                    deletedItems = [];
                    updateTrashUI();
                }

                (function() {
                    let lastContextX = 0;
                    let lastContextY = 0;
                    
                    document.querySelector('.background-image').addEventListener('contextmenu', function(e) {
                        lastContextX = e.pageX;
                        lastContextY = e.pageY;
                    });

                    const menuNewFolder = document.getElementById('menu-new-folder');
                    const menuNewShortcut = document.getElementById('menu-new-shortcut');

                    if (menuNewFolder) {
                        menuNewFolder.addEventListener('click', function(e) {
                            e.preventDefault();
                            e.stopPropagation();
                            createNewShortcut('folder', lastContextX, lastContextY);
                            document.getElementById('contextMenu').style.display = 'none';
                        });
                    }

                    if (menuNewShortcut) {
                        menuNewShortcut.addEventListener('click', function(e) {
                            e.preventDefault();
                            e.stopPropagation();
                            createNewShortcut('shortcut', lastContextX, lastContextY);
                            document.getElementById('contextMenu').style.display = 'none';
                        });
                    }

                    // Personalize - Change Background
                    const menuPersonalize = document.getElementById('menu-personalize');
                    const bgInput = document.getElementById('bg-input');
                    const backgroundImageContainer = document.querySelector('.background-image');

                    if (menuPersonalize && bgInput) {
                        menuPersonalize.addEventListener('click', function(e) {
                            e.preventDefault();
                            e.stopPropagation();
                            bgInput.click();
                            document.getElementById('contextMenu').style.display = 'none';
                        });

                        bgInput.addEventListener('change', function(e) {
                            const file = e.target.files[0];
                            if (file) {
                                const reader = new FileReader();
                                reader.onload = function(event) {
                                    backgroundImageContainer.style.background = `url('${event.target.result}') no-repeat center center`;
                                    backgroundImageContainer.style.backgroundSize = 'cover';
                                };
                                reader.readAsDataURL(file);
                            }
                        });
                    }

                    function createNewShortcut(type, x, y) {
                        const desktop = document.querySelector('.background-image');
                        const div = document.createElement('div');
                        div.className = 'desktop-shortcut';
                        div.style.position = 'absolute';
                        div.style.left = x + 'px';
                        div.style.top = y + 'px';
                        
                        const img = document.createElement('img');
                        img.src = type === 'folder' ? 'assets/images/Folder.png' : 'assets/images/Shortcut.png';
                        img.alt = type === 'folder' ? 'Folder' : 'Shortcut';
                        
                        const span = document.createElement('span');
                        span.textContent = type === 'folder' ? 'New Folder' : 'New Shortcut';
                        
                        div.appendChild(img);
                        div.appendChild(span);
                        desktop.appendChild(div);
                        
                        makeDraggable(div);
                        
                        span.ondblclick = function(e) {
                            e.stopPropagation();
                            span.contentEditable = true;
                            span.focus();
                            document.execCommand('selectAll', false, null);
                        };

                        span.onkeydown = function(e) {
                            if (e.key === 'Enter') {
                                e.preventDefault();
                                span.contentEditable = false;
                                span.blur();
                            }
                        };
                    }

                    const trashShortcut = document.getElementById('shortcut-trash');
                    if (trashShortcut) {
                        trashShortcut.addEventListener('dblclick', () => {
                            const win = document.getElementById('trash-window');
                            win.style.display = 'flex';
                            win.classList.add('active');
                        });
                    }

                    document.getElementById('restore-all-btn').addEventListener('click', restoreAllItems);
                    document.getElementById('empty-trash-btn').addEventListener('click', emptyTrash);
                    document.getElementById('trash-close').addEventListener('click', () => {
                        document.getElementById('trash-window').style.display = 'none';
                    });

                    function makeTrashDraggable(element) {
                        let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
                        element.onmousedown = function(e) {
                            if (e.button !== 0) return;
                            e.stopPropagation();
                            pos3 = e.clientX;
                            pos4 = e.clientY;
                            document.onmouseup = () => {
                                document.onmouseup = null;
                                document.onmousemove = null;
                                element.classList.remove('dragging');
                            };
                            document.onmousemove = (e) => {
                                pos1 = pos3 - e.clientX;
                                pos2 = pos4 - e.clientY;
                                pos3 = e.clientX;
                                pos4 = e.clientY;
                                element.style.top = (element.offsetTop - pos2) + "px";
                                element.style.left = (element.offsetLeft - pos1) + "px";
                            };
                            element.classList.add('dragging');
                            element.style.zIndex = "3000";
                        };
                    }

                    document.querySelectorAll('.desktop-shortcut').forEach(s => {
                        if (s.id === 'shortcut-trash') makeTrashDraggable(s);
                        else makeDraggable(s);
                    });
                })();

                // Power Modal & Sleep Screen Logic
                (function() {
                    const powerIcon = document.getElementById('power-icon');
                    const powerModal = document.getElementById('powerModal');
                    const sleepScreen = document.getElementById('sleepScreen');
                    const sleepOption = document.getElementById('sleepOption');
                    const shutdownOption = document.getElementById('shutdownOption');
                    const restartOption = document.getElementById('restartOption');
                    const wakeButton = document.getElementById('wakeButton');
                    const startMenu = document.getElementById('startMenu');

                    // Show power modal when clicking power icon
                    if (powerIcon) {
                        powerIcon.addEventListener('click', function(e) {
                            e.stopPropagation();
                            powerModal.classList.add('show');
                        });
                    }

                    // Close power modal when clicking outside
                    if (powerModal) {
                        powerModal.addEventListener('click', function(e) {
                            if (e.target === powerModal) {
                                powerModal.classList.remove('show');
                            }
                        });
                    }

                    // Sleep option
                    if (sleepOption) {
                        sleepOption.addEventListener('click', function() {
                            powerModal.classList.remove('show');
                            // Hide start menu
                            if (startMenu) {
                                startMenu.style.transform = 'translateY(100%)';
                                startMenu.style.opacity = '0';
                                setTimeout(() => { 
                                    startMenu.style.display = 'none';
                                    startMenu.classList.remove('show');
                                }, 300);
                                const windowsIcon = document.querySelector('.windows-icon');
                                if (windowsIcon) windowsIcon.classList.remove('active');
                            }
                            // Show sleep screen
                            setTimeout(() => {
                                sleepScreen.classList.add('show');
                            }, 400);
                        });
                    }

                    // Shutdown option
                    if (shutdownOption) {
                        shutdownOption.addEventListener('click', function() {
                            powerModal.classList.remove('show');
                            // You can add shutdown animation here
                            alert('Shutting down...');
                        });
                    }

                    // Restart option
                    if (restartOption) {
                        restartOption.addEventListener('click', function() {
                            powerModal.classList.remove('show');
                            // You can add restart animation here
                            alert('Restarting...');
                        });
                    }

                    // Wake button
                    if (wakeButton) {
                        wakeButton.addEventListener('click', function() {
                            sleepScreen.classList.remove('show');
                        });
                    }

                    // Click anywhere on sleep screen to wake
                    if (sleepScreen) {
                        sleepScreen.addEventListener('click', function(e) {
                            if (e.target === sleepScreen) {
                                sleepScreen.classList.remove('show');
                            }
                        });
                    }
                })();

                // VS Code Window Logic
                (function() {
                    const vscodeIcon = document.getElementById('vscode-taskbar-icon');
                    const vscodeWindow = document.getElementById('vscode-window');
                    const minimizeBtn = document.getElementById('vscode-minimize');
                    const maximizeBtn = document.getElementById('vscode-maximize');
                    const closeBtn = document.getElementById('vscode-close');

                    let isMaximized = false;
                    let lastWidth = "900px";
                    let lastHeight = "600px";
                    let lastTop = "50px";
                    let lastLeft = "100px";

                    function toggleVSCode(e) {
                        if (e) e.stopPropagation();
                        const isCurrentlyActive = vscodeWindow.classList.contains('active');
                        if (!isCurrentlyActive) {
                            vscodeWindow.classList.add('active');
                            vscodeWindow.style.display = 'flex';
                            vscodeWindow.style.opacity = "0";
                            setTimeout(() => {
                                vscodeWindow.style.transition = "opacity 0.2s ease";
                                vscodeWindow.style.opacity = "1";
                            }, 10);
                        } else {
                            vscodeWindow.classList.remove('active');
                            setTimeout(() => { vscodeWindow.style.display = 'none'; }, 200);
                        }
                    }

                    if (vscodeIcon) {
                        vscodeIcon.addEventListener('click', toggleVSCode);
                    }

                    if (minimizeBtn) {
                        minimizeBtn.addEventListener('click', toggleVSCode);
                    }

                    if (maximizeBtn) {
                        maximizeBtn.addEventListener('click', function(e) {
                            e.stopPropagation();
                            isMaximized = !isMaximized;
                            if (isMaximized) {
                                lastTop = vscodeWindow.style.top;
                                lastLeft = vscodeWindow.style.left;
                                lastWidth = vscodeWindow.style.width;
                                lastHeight = vscodeWindow.style.height;
                                vscodeWindow.classList.add('maximized');
                                maximizeBtn.querySelector('i').classList.replace('fa-square', 'fa-clone');
                            } else {
                                vscodeWindow.classList.remove('maximized');
                                maximizeBtn.querySelector('i').classList.replace('fa-clone', 'fa-square');
                            }
                        });
                    }

                    if (closeBtn) {
                        closeBtn.addEventListener('click', function(e) {
                            e.stopPropagation();
                            vscodeWindow.classList.remove('active');
                            setTimeout(() => { vscodeWindow.style.display = 'none'; }, 200);
                        });
                    }

                    if (vscodeWindow) {
                        makeWindowDraggable(vscodeWindow);
                    }
                })();

                // Global function for making windows draggable
                function makeWindowDraggable(win) {
                    const header = win.querySelector('.window-header');
                    let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
                    
                    if (!header) return;

                    header.onmousedown = dragMouseDown;

                    function dragMouseDown(e) {
                        // Disable drag when maximized
                        if (win.classList.contains('maximized')) return;
                        
                        e = e || window.event;
                        e.preventDefault();
                        pos3 = e.clientX;
                        pos4 = e.clientY;
                        document.onmouseup = closeDragElement;
                        document.onmousemove = elementDrag;
                        
                        // Bring to front when dragging
                        if (!win.classList.contains('maximized')) {
                            if (typeof WindowManager !== 'undefined') {
                                WindowManager.bringToFront(win);
                            } else {
                                win.style.zIndex = "3000";
                            }
                        }
                    }

                    function elementDrag(e) {
                        e = e || window.event;
                        e.preventDefault();
                        pos1 = pos3 - e.clientX;
                        pos2 = pos4 - e.clientY;
                        pos3 = e.clientX;
                        pos4 = e.clientY;
                        win.style.top = (win.offsetTop - pos2) + "px";
                        win.style.left = (win.offsetLeft - pos1) + "px";
                    }

                    function closeDragElement() {
                        document.onmouseup = null;
                        document.onmousemove = null;
                    }
                }

                // WindowManager for Multiple Instances
                const WindowManager = {
                    instances: {
                        vscode: [],
                        notepad: [],
                        sticky: [],
                        cmd: []
                    },
                    zIndexCounter: 1000,
                    positionOffset: 30,
                    
                    createWindow(appType, color) {
                        const instanceId = `${appType}-${Date.now()}`;
                        const offset = this.instances[appType].length * this.positionOffset;
                        
                        let windowHTML = '';
                        
                        switch(appType) {
                            case 'vscode':
                                windowHTML = this.createVSCodeWindow(instanceId, offset);
                                break;
                            case 'notepad':
                                windowHTML = this.createNotepadWindow(instanceId, offset);
                                break;
                            case 'sticky':
                                windowHTML = this.createStickyWindow(instanceId, offset, color || '#fff7d1');
                                break;
                            case 'cmd':
                                windowHTML = this.createCMDWindow(instanceId, offset);
                                break;
                        }
                        
                        // Insert window into DOM
                        document.body.insertAdjacentHTML('beforeend', windowHTML);
                        
                        const windowElement = document.getElementById(instanceId);
                        this.instances[appType].push({
                            id: instanceId,
                            element: windowElement,
                            isMinimized: false,
                            isMaximized: false
                        });
                        
                        // Setup window functionality
                        this.setupWindowControls(instanceId, appType);
                        makeWindowDraggable(windowElement);
                        this.bringToFront(windowElement);
                        
                        // Show window
                        windowElement.style.display = 'flex';
                        setTimeout(() => {
                            windowElement.style.opacity = '1';
                        }, 10);
                        
                        this.updateTaskbarIcon(appType);
                        
                        return instanceId;
                    },
                    
                    createVSCodeWindow(id, offset) {
                        return `
                        <div class="window" id="${id}" style="width: 800px; height: 600px; left: ${100 + offset}px; top: ${50 + offset}px; opacity: 0; transition: opacity 0.2s;">
                            <div class="window-header" style="background-color: #2d2d30; border-bottom: 1px solid #1e1e1e;">
                                <div class="window-title" style="color: #fff;">
                                    <img src="assets/images/Visual Studio Code.svg" alt="VS Code" style="width: 16px; height: 16px;">
                                    <span>index.html - Visual Studio Code</span>
                                </div>
                                <div class="window-controls">
                                    <div class="control-btn minimize" data-action="minimize"><i class="fas fa-minus"></i></div>
                                    <div class="control-btn maximize" data-action="maximize"><i class="far fa-square"></i></div>
                                    <div class="control-btn close" data-action="close"><i class="fas fa-times"></i></div>
                                </div>
                            </div>
                            <div class="window-body">
                                <div class="vscode-sidebar">
                                    <i class="far fa-copy" style="color: #fff;"></i>
                                    <i class="fas fa-search"></i>
                                    <i class="fas fa-code-branch"></i>
                                    <i class="fas fa-th-large"></i>
                                </div>
                                <div class="vscode-explorer">
                                    <div style="font-weight: bold; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px;">Explorer</div>
                                    <div style="display: flex; align-items: center; gap: 5px;">
                                        <i class="fas fa-chevron-down"></i>
                                        <span style="font-weight: bold;">WINDOWS 10</span>
                                    </div>
                                    <div style="padding-left: 20px; margin-top: 5px; color: #51a147;">
                                        <i class="fab fa-html5" style="margin-right: 5px; color: #e34c26;"></i> index.html
                                    </div>
                                    <div style="padding-left: 20px; margin-top: 5px;">
                                        <i class="fas fa-folder" style="margin-right: 5px; color: #dcb67a;"></i> assets
                                    </div>
                                </div>
                                <div class="vscode-editor">
                                    <div class="vscode-code" contenteditable="true" spellcheck="false"><span class="syntax-comment">&lt;!-- Welcome to VS Code Simulator --&gt;</span>
<span class="syntax-bracket">&lt;</span><span class="syntax-tag">html</span><span class="syntax-bracket">&gt;</span>
  <span class="syntax-bracket">&lt;</span><span class="syntax-tag">body</span><span class="syntax-bracket">&gt;</span>
    <span class="syntax-bracket">&lt;</span><span class="syntax-tag">h1</span><span class="syntax-bracket">&gt;</span><span class="syntax-text">Hello, World!</span><span class="syntax-bracket">&lt;/</span><span class="syntax-tag">h1</span><span class="syntax-bracket">&gt;</span>
  <span class="syntax-bracket">&lt;/</span><span class="syntax-tag">body</span><span class="syntax-bracket">&gt;</span>
<span class="syntax-bracket">&lt;/</span><span class="syntax-tag">html</span><span class="syntax-bracket">&gt;</span></div>
                                </div>
                            </div>
                        </div>`;
                    },
                    
                    createNotepadWindow(id, offset) {
                        return `
                        <div class="window" id="${id}" style="width: 600px; height: 400px; left: ${150 + offset}px; top: ${80 + offset}px; background-color: #fff; opacity: 0; transition: opacity 0.2s;">
                            <div class="window-header" style="background-color: #fff; border-bottom: 1px solid #ddd;">
                                <div class="window-title" style="color: #000;">
                                    <img src="assets/images/Notepad.webp" alt="Notepad" style="width: 16px; height: 16px;">
                                    <span>Notepad</span>
                                </div>
                                <div class="window-controls">
                                    <div class="control-btn minimize" data-action="minimize" style="color: #000;"><i class="fas fa-minus"></i></div>
                                    <div class="control-btn maximize" data-action="maximize" style="color: #000;"><i class="far fa-square"></i></div>
                                    <div class="control-btn close" data-action="close" style="color: #000;"><i class="fas fa-times"></i></div>
                                </div>
                            </div>
                            <div class="window-body">
                                <div class="vscode-editor" style="background-color: #fff; overflow: hidden;">
                                    <textarea spellcheck="false" style="color: #000; font-family: 'Consolas', sans-serif; overflow: hidden;"></textarea>
                                </div>
                            </div>
                        </div>`;
                    },
                    
                    createStickyWindow(id, offset, color) {
                        // Default color if not provided
                        if (!color) {
                            color = '#fff7d1';
                        }
                        
                        const headerColor = this.getStickyHeaderColor(color);
                        return `
                        <div class="window sticky-note" id="${id}" style="left: ${200 + offset}px; top: ${120 + offset}px; opacity: 0; transition: opacity 0.2s; background-color: ${color};">
                            <div class="window-header" style="background-color: ${headerColor};">
                                <div class="window-title">
                                    <i class="fas fa-plus" data-action="add-note" style="margin-right: 15px; cursor: pointer;" title="New note"></i>
                                    <span>Sticky Notes</span>
                                </div>
                                <div class="window-controls">
                                    <div class="control-btn close" data-action="close"><i class="fas fa-times"></i></div>
                                </div>
                            </div>
                            <div class="sticky-color-picker" data-picker="${id}">
                                <div class="color-option color-yellow" data-color="#fff7d1"></div>
                                <div class="color-option color-blue" data-color="#d1e7ff"></div>
                                <div class="color-option color-green" data-color="#d1ffd7"></div>
                                <div class="color-option color-pink" data-color="#ffd1e7"></div>
                                <div class="color-option color-purple" data-color="#e7d1ff"></div>
                                <div class="color-option color-orange" data-color="#ffe7d1"></div>
                            </div>
                            <div class="window-body">
                                <div class="vscode-editor" style="background-color: ${color}; overflow: hidden;">
                                    <textarea spellcheck="false" placeholder="Take a note..." style="background-color: ${color}; overflow: hidden;"></textarea>
                                </div>
                            </div>
                        </div>`;
                    },
                    
                    createCMDWindow(id, offset) {
                        return `
                        <div class="window" id="${id}" style="width: 700px; height: 500px; left: ${250 + offset}px; top: ${150 + offset}px; background-color: #0c0c0c; opacity: 0; transition: opacity 0.2s;">
                            <div class="window-header" style="background-color: #2d2d30;">
                                <div class="window-title">
                                    <img src="assets/images/Command Prompt.png" alt="Command Prompt" style="width: 16px; height: 16px;">
                                    <span>Command Prompt</span>
                                </div>
                                <div class="window-controls">
                                    <div class="control-btn minimize" data-action="minimize">&#8212;</div>
                                    <div class="control-btn maximize" data-action="maximize">&#9744;</div>
                                    <div class="control-btn close" data-action="close">&#10005;</div>
                                </div>
                            </div>
                            <div class="window-body" style="padding: 15px; background-color: #0c0c0c; color: #fff; font-family: 'Consolas', 'Courier New', monospace; font-size: 16px; line-height: 1.8; overflow-y: auto;">
                                <pre style="margin: 0; font-family: inherit; font-size: inherit; color: inherit;">Microsoft Windows [Version 10.0.19044.1234]
(c) Microsoft Corporation. All rights reserved.

C:\\Users\\boss><span class="cmd-cursor" style="background-color: #fff; color: #0c0c0c; padding: 0 4px; margin-left: 2px; animation: blink 1s infinite;">_</span></pre>
                            </div>
                        </div>`;
                    },
                    
                    setupWindowControls(windowId, appType) {
                        const win = document.getElementById(windowId);
                        const minimize = win.querySelector('[data-action="minimize"]');
                        const maximize = win.querySelector('[data-action="maximize"]');
                        const close = win.querySelector('[data-action="close"]');
                        
                        let isMaximized = false;
                        
                        // Click to focus
                        win.addEventListener('mousedown', () => {
                            this.bringToFront(win);
                        });
                        
                        // Minimize
                        if (minimize) {
                            minimize.addEventListener('click', (e) => {
                                e.stopPropagation();
                                win.style.opacity = '0';
                                setTimeout(() => {
                                    win.style.display = 'none';
                                }, 200);
                                this.updateInstanceState(appType, windowId, 'isMinimized', true);
                                this.updateTaskbarIcon(appType);
                            });
                        }
                        
                        // Maximize
                        if (maximize) {
                            maximize.addEventListener('click', (e) => {
                                e.stopPropagation();
                                isMaximized = !isMaximized;
                                if (isMaximized) {
                                    win.classList.add('maximized');
                                    const icon = maximize.querySelector('i');
                                    if (icon) {
                                        icon.classList.replace('fa-square', 'fa-clone');
                                    }
                                } else {
                                    win.classList.remove('maximized');
                                    const icon = maximize.querySelector('i');
                                    if (icon) {
                                        icon.classList.replace('fa-clone', 'fa-square');
                                    }
                                }
                                this.updateInstanceState(appType, windowId, 'isMaximized', isMaximized);
                            });
                        }
                        
                        // Close
                        if (close) {
                            close.addEventListener('click', (e) => {
                                e.stopPropagation();
                                win.style.opacity = '0';
                                setTimeout(() => {
                                    win.remove();
                                    this.removeInstance(appType, windowId);
                                    this.updateTaskbarIcon(appType);
                                }, 200);
                            });
                        }
                        
                        // Sticky Note specific: Add note button
                        if (appType === 'sticky') {
                            const addBtn = win.querySelector('[data-action="add-note"]');
                            const colorPicker = win.querySelector('.sticky-color-picker');
                            
                            if (addBtn && colorPicker) {
                                addBtn.addEventListener('click', (e) => {
                                    e.stopPropagation();
                                    colorPicker.classList.toggle('show');
                                });
                                
                                // Handle color selection
                                const colorOptions = colorPicker.querySelectorAll('.color-option');
                                colorOptions.forEach(option => {
                                    option.addEventListener('click', (e) => {
                                        e.stopPropagation();
                                        const selectedColor = option.getAttribute('data-color');
                                        WindowManager.createWindow('sticky', selectedColor);
                                        colorPicker.classList.remove('show');
                                    });
                                });
                                
                                // Close color picker when clicking outside
                                document.addEventListener('click', (e) => {
                                    if (!colorPicker.contains(e.target) && !addBtn.contains(e.target)) {
                                        colorPicker.classList.remove('show');
                                    }
                                });
                            }
                        }
                    },
                    
                    bringToFront(windowElement) {
                        this.zIndexCounter++;
                        // Keep z-index below taskbar (10000)
                        if (this.zIndexCounter >= 9999) {
                            this.zIndexCounter = 1000;
                        }
                        windowElement.style.zIndex = this.zIndexCounter;
                    },
                    
                    updateInstanceState(appType, instanceId, property, value) {
                        const instance = this.instances[appType].find(inst => inst.id === instanceId);
                        if (instance) {
                            instance[property] = value;
                        }
                    },
                    
                    removeInstance(appType, instanceId) {
                        this.instances[appType] = this.instances[appType].filter(inst => inst.id !== instanceId);
                    },
                    
                    getStickyHeaderColor(bgColor) {
                        // Default to yellow if no color provided
                        if (!bgColor) {
                            bgColor = '#fff7d1';
                        }
                        
                        // Convert hex to RGB and darken by 10%
                        const hex = bgColor.replace('#', '');
                        const r = parseInt(hex.substr(0, 2), 16);
                        const g = parseInt(hex.substr(2, 2), 16);
                        const b = parseInt(hex.substr(4, 2), 16);
                        
                        const darkenedR = Math.max(0, Math.floor(r * 0.9));
                        const darkenedG = Math.max(0, Math.floor(g * 0.9));
                        const darkenedB = Math.max(0, Math.floor(b * 0.9));
                        
                        return `rgb(${darkenedR}, ${darkenedG}, ${darkenedB})`;
                    },
                    
                    updateTaskbarIcon(appType) {
                        const iconMap = {
                            vscode: 'vscode-taskbar-icon',
                            notepad: 'notepad-taskbar-icon',
                            sticky: 'sticky-taskbar-icon',
                            cmd: 'cmd-taskbar-icon'
                        };
                        
                        const icon = document.getElementById(iconMap[appType]);
                        if (icon) {
                            const visibleInstances = this.instances[appType].filter(inst => !inst.isMinimized);
                            if (visibleInstances.length > 0 || this.instances[appType].length > 0) {
                                icon.classList.add('active');
                            } else {
                                icon.classList.remove('active');
                            }
                            
                            // Add multiple-instances indicator
                            if (this.instances[appType].length > 1) {
                                icon.classList.add('multiple-instances');
                            } else {
                                icon.classList.remove('multiple-instances');
                            }
                        }
                    },
                    
                    toggleWindows(appType) {
                        const instances = this.instances[appType];
                        const anyVisible = instances.some(inst => inst.element.style.display !== 'none');
                        
                        if (anyVisible) {
                            // Hide all
                            instances.forEach(inst => {
                                inst.element.style.opacity = '0';
                                setTimeout(() => {
                                    inst.element.style.display = 'none';
                                }, 200);
                                inst.isMinimized = true;
                            });
                        } else {
                            // Show all
                            instances.forEach(inst => {
                                inst.element.style.display = 'flex';
                                setTimeout(() => {
                                    inst.element.style.opacity = '1';
                                }, 10);
                                inst.isMinimized = false;
                                this.bringToFront(inst.element);
                            });
                        }
                        this.updateTaskbarIcon(appType);
                    }
                };

                // Notepad & Sticky Notes Logic
                (function() {
                    function setupApp(iconId, windowId, minimizeId, maximizeId, closeId) {
                        const icon = document.getElementById(iconId);
                        const win = document.getElementById(windowId);
                        const minimize = document.getElementById(minimizeId);
                        const maximize = document.getElementById(maximizeId);
                        const close = document.getElementById(closeId);
                        
                        let isMaximized = false;

                        function toggle() {
                            const isCurrentlyActive = win.classList.contains('active');
                            if (!isCurrentlyActive) {
                                win.classList.add('active');
                                win.style.display = 'flex';
                                win.style.opacity = "0";
                                setTimeout(() => {
                                    win.style.transition = "opacity 0.2s ease";
                                    win.style.opacity = "1";
                                }, 10);
                            } else {
                                win.classList.remove('active');
                                setTimeout(() => { win.style.display = 'none'; }, 200);
                            }
                        }

                        if (icon) icon.addEventListener('click', toggle);
                        if (minimize) minimize.addEventListener('click', toggle);
                        if (close) close.addEventListener('click', function(e) {
                            e.stopPropagation();
                            win.classList.remove('active');
                            setTimeout(() => { win.style.display = 'none'; }, 200);
                        });

                        if (maximize) {
                            maximize.addEventListener('click', function(e) {
                                e.stopPropagation();
                                isMaximized = !isMaximized;
                                if (isMaximized) {
                                    win.classList.add('maximized');
                                    maximize.querySelector('i').classList.replace('fa-square', 'fa-clone');
                                } else {
                                    win.classList.remove('maximized');
                                    maximize.querySelector('i').classList.replace('fa-clone', 'fa-square');
                                }
                            });
                        }

                        // Make draggable
                        const header = win.querySelector('.window-header');
                        let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
                        if (header) {
                            header.onmousedown = function(e) {
                                if (win.classList.contains('maximized')) return;
                                e = e || window.event;
                                e.preventDefault();
                                pos3 = e.clientX;
                                pos4 = e.clientY;
                                document.onmouseup = () => {
                                    document.onmouseup = null;
                                    document.onmousemove = null;
                                };
                                document.onmousemove = (e) => {
                                    e = e || window.event;
                                    e.preventDefault();
                                    pos1 = pos3 - e.clientX;
                                    pos2 = pos4 - e.clientY;
                                    pos3 = e.clientX;
                                    pos4 = e.clientY;
                                    win.style.top = (win.offsetTop - pos2) + "px";
                                    win.style.left = (win.offsetLeft - pos1) + "px";
                                };
                                win.style.zIndex = "3000";
                            }
                        }
                    }

                    // Original setupApp calls - commented out for multiple instance support
                    // setupApp('notepad-taskbar-icon', 'notepad-window', 'notepad-minimize', 'notepad-maximize', 'notepad-close');
                    // setupApp('sticky-taskbar-icon', 'sticky-window', null, null, 'sticky-close');
                    setupApp('explorer-taskbar-icon', 'explorer-window', 'explorer-minimize', 'explorer-maximize', 'explorer-close');
                    // setupApp('cmd-taskbar-icon', 'cmd-window', 'cmd-minimize', 'cmd-maximize', 'cmd-close');

                    // Multiple Instance Taskbar Handlers using WindowManager
                    const vscodeTaskbarIcon = document.getElementById('vscode-taskbar-icon');
                    const notepadTaskbarIcon = document.getElementById('notepad-taskbar-icon');
                    const stickyTaskbarIcon = document.getElementById('sticky-taskbar-icon');
                    const cmdTaskbarIcon = document.getElementById('cmd-taskbar-icon');

                    if (vscodeTaskbarIcon) {
                        vscodeTaskbarIcon.addEventListener('click', function() {
                            if (WindowManager.instances.vscode.length === 0) {
                                WindowManager.createWindow('vscode');
                            } else {
                                WindowManager.toggleWindows('vscode');
                            }
                        });
                    }

                    if (notepadTaskbarIcon) {
                        notepadTaskbarIcon.addEventListener('click', function() {
                            if (WindowManager.instances.notepad.length === 0) {
                                WindowManager.createWindow('notepad');
                            } else {
                                WindowManager.toggleWindows('notepad');
                            }
                        });
                    }

                    if (stickyTaskbarIcon) {
                        stickyTaskbarIcon.addEventListener('click', function() {
                            if (WindowManager.instances.sticky.length === 0) {
                                WindowManager.createWindow('sticky');
                            } else {
                                WindowManager.toggleWindows('sticky');
                            }
                        });
                    }

                    if (cmdTaskbarIcon) {
                        cmdTaskbarIcon.addEventListener('click', function() {
                            if (WindowManager.instances.cmd.length === 0) {
                                WindowManager.createWindow('cmd');
                            } else {
                                WindowManager.toggleWindows('cmd');
                            }
                        });
                    }

                    // Paint window controls (no taskbar icon)
                    (function() {
                        const win = document.getElementById('paint-window');
                        const minimize = document.getElementById('paint-minimize');
                        const maximize = document.getElementById('paint-maximize');
                        const close = document.getElementById('paint-close');
                        let isMaximized = false;
                        
                        if (minimize) {
                            minimize.addEventListener('click', function(e) {
                                e.stopPropagation();
                                win.classList.remove('active');
                                setTimeout(() => { win.style.display = 'none'; }, 200);
                            });
                        }
                        
                        if (maximize) {
                            maximize.addEventListener('click', function(e) {
                                e.stopPropagation();
                                isMaximized = !isMaximized;
                                if (isMaximized) {
                                    win.classList.add('maximized');
                                    maximize.querySelector('i').classList.replace('fa-square', 'fa-clone');
                                } else {
                                    win.classList.remove('maximized');
                                    maximize.querySelector('i').classList.replace('fa-clone', 'fa-square');
                                }
                            });
                        }
                        
                        if (close) {
                            close.addEventListener('click', function(e) {
                                e.stopPropagation();
                                win.classList.remove('active');
                                setTimeout(() => { win.style.display = 'none'; }, 200);
                            });
                        }
                        
                        // Make draggable
                        const header = win.querySelector('.window-header');
                        let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
                        if (header) {
                            header.onmousedown = function(e) {
                                if (win.classList.contains('maximized')) return;
                                e = e || window.event;
                                e.preventDefault();
                                pos3 = e.clientX;
                                pos4 = e.clientY;
                                document.onmouseup = () => {
                                    document.onmouseup = null;
                                    document.onmousemove = null;
                                };
                                document.onmousemove = (e) => {
                                    e = e || window.event;
                                    e.preventDefault();
                                    pos1 = pos3 - e.clientX;
                                    pos2 = pos4 - e.clientY;
                                    pos3 = e.clientX;
                                    pos4 = e.clientY;
                                    win.style.top = (win.offsetTop - pos2) + "px";
                                    win.style.left = (win.offsetLeft - pos1) + "px";
                                };
                                win.style.zIndex = "3000";
                            }
                        }
                    })();

                    // Calculator window controls (no taskbar icon)
                    (function() {
                        const win = document.getElementById('calculator-window');
                        const minimize = document.getElementById('calculator-minimize');
                        const close = document.getElementById('calculator-close');
                        
                        if (minimize) {
                            minimize.addEventListener('click', function(e) {
                                e.stopPropagation();
                                win.classList.remove('active');
                                setTimeout(() => { win.style.display = 'none'; }, 200);
                            });
                        }
                        
                        if (close) {
                            close.addEventListener('click', function(e) {
                                e.stopPropagation();
                                win.classList.remove('active');
                                setTimeout(() => { win.style.display = 'none'; }, 200);
                            });
                        }
                        
                        // Make draggable
                        const header = win.querySelector('.window-header');
                        let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
                        if (header) {
                            header.onmousedown = function(e) {
                                e = e || window.event;
                                e.preventDefault();
                                pos3 = e.clientX;
                                pos4 = e.clientY;
                                document.onmouseup = () => {
                                    document.onmouseup = null;
                                    document.onmousemove = null;
                                };
                                document.onmousemove = (e) => {
                                    e = e || window.event;
                                    e.preventDefault();
                                    pos1 = pos3 - e.clientX;
                                    pos2 = pos4 - e.clientY;
                                    pos3 = e.clientX;
                                    pos4 = e.clientY;
                                    win.style.top = (win.offsetTop - pos2) + "px";
                                    win.style.left = (win.offsetLeft - pos1) + "px";
                                };
                                win.style.zIndex = "3000";
                            }
                        }
                    })();

                    // Calculator functionality
                    (function() {
                        const display = document.getElementById('calc-display');
                        const expression = document.getElementById('calc-expression');
                        let currentValue = '0';
                        let previousValue = '';
                        let operation = null;
                        let shouldResetDisplay = false;

                        function updateDisplay() {
                            display.textContent = currentValue;
                        }

                        function updateExpression() {
                            if (previousValue && operation) {
                                const operatorSymbol = operation === '*' ? '×' : operation === '/' ? '÷' : operation === '-' ? '−' : operation;
                                expression.textContent = `${previousValue} ${operatorSymbol}`;
                            } else {
                                expression.textContent = '';
                            }
                        }

                        // Number buttons
                        document.querySelectorAll('.calc-number').forEach(btn => {
                            btn.addEventListener('click', function() {
                                const number = this.getAttribute('data-number');
                                
                                if (shouldResetDisplay) {
                                    currentValue = number;
                                    shouldResetDisplay = false;
                                } else {
                                    if (number === '.' && currentValue.includes('.')) return;
                                    currentValue = currentValue === '0' && number !== '.' ? number : currentValue + number;
                                }
                                updateDisplay();
                            });

                            // Hover effect
                            btn.addEventListener('mouseenter', function() {
                                this.style.backgroundColor = '#e5e5e5';
                            });
                            btn.addEventListener('mouseleave', function() {
                                this.style.backgroundColor = this.classList.contains('calc-number') ? '#fff' : '#f3f3f3';
                            });
                        });

                        // Operator buttons
                        document.querySelectorAll('.calc-operator').forEach(btn => {
                            btn.addEventListener('click', function() {
                                const op = this.getAttribute('data-operator');
                                
                                if (operation && !shouldResetDisplay) {
                                    calculate();
                                }
                                
                                previousValue = currentValue;
                                operation = op;
                                shouldResetDisplay = true;
                                updateExpression();
                            });

                            // Hover effect
                            btn.addEventListener('mouseenter', function() {
                                this.style.backgroundColor = '#e5e5e5';
                            });
                            btn.addEventListener('mouseleave', function() {
                                this.style.backgroundColor = '#f3f3f3';
                            });
                        });

                        // Function buttons (C, backspace)
                        document.querySelectorAll('.calc-func').forEach(btn => {
                            btn.addEventListener('click', function() {
                                const action = this.getAttribute('data-action');
                                
                                if (action === 'clear') {
                                    currentValue = '0';
                                    previousValue = '';
                                    operation = null;
                                    expression.textContent = '';
                                } else if (action === 'backspace') {
                                    currentValue = currentValue.length > 1 ? currentValue.slice(0, -1) : '0';
                                }
                                updateDisplay();
                            });

                            // Hover effect
                            btn.addEventListener('mouseenter', function() {
                                this.style.backgroundColor = '#e5e5e5';
                            });
                            btn.addEventListener('mouseleave', function() {
                                this.style.backgroundColor = '#f3f3f3';
                            });
                        });

                        // Equals button
                        document.querySelector('.calc-equals').addEventListener('click', function() {
                            if (operation) {
                                calculate();
                                previousValue = '';
                                operation = null;
                                expression.textContent = '';
                                shouldResetDisplay = true;
                            }
                        });

                        // Hover effect for equals button
                        document.querySelector('.calc-equals').addEventListener('mouseenter', function() {
                            this.style.backgroundColor = '#006cbd';
                        });
                        document.querySelector('.calc-equals').addEventListener('mouseleave', function() {
                            this.style.backgroundColor = '#0078d4';
                        });

                        function calculate() {
                            const prev = parseFloat(previousValue);
                            const current = parseFloat(currentValue);
                            
                            if (isNaN(prev) || isNaN(current)) return;
                            
                            let result;
                            switch (operation) {
                                case '+':
                                    result = prev + current;
                                    break;
                                case '-':
                                    result = prev - current;
                                    break;
                                case '*':
                                    result = prev * current;
                                    break;
                                case '/':
                                    result = current !== 0 ? prev / current : 'Error';
                                    break;
                            }
                            
                            currentValue = result.toString();
                            updateDisplay();
                        }
                    })();

                    // Calculator app launchers from search/menu/library
                    const topAppCalculator = document.getElementById('top-app-calculator');
                    const searchAppCalculator = document.getElementById('search-app-calculator');
                    const libraryAppCalculator = document.getElementById('app-library-calculator');
                    
                    if (topAppCalculator) {
                        topAppCalculator.addEventListener('click', function() {
                            const win = document.getElementById('calculator-window');
                            if (win) {
                                win.classList.add('active');
                                win.style.display = 'flex';
                            }
                            // Hide start menu and search panel
                            const startMenu = document.getElementById('start-menu');
                            const searchPanel = document.querySelector('.search-panel');
                            if (startMenu) {
                                startMenu.style.transform = 'translateY(100%)';
                                startMenu.style.opacity = '0';
                                setTimeout(() => { startMenu.style.display = 'none'; }, 300);
                            }
                            if (searchPanel && searchPanel.style.display === 'block') {
                                searchPanel.style.display = 'none';
                            }
                        });
                    }
                    
                    if (searchAppCalculator) {
                        searchAppCalculator.addEventListener('click', function() {
                            const win = document.getElementById('calculator-window');
                            if (win) {
                                win.classList.add('active');
                                win.style.display = 'flex';
                            }
                            // Hide search panel
                            const searchPanel = document.querySelector('.search-panel');
                            if (searchPanel && searchPanel.style.display === 'block') {
                                searchPanel.style.display = 'none';
                            }
                        });
                    }
                    
                    if (libraryAppCalculator) {
                        libraryAppCalculator.addEventListener('click', function() {
                            const win = document.getElementById('calculator-window');
                            if (win) {
                                win.classList.add('active');
                                win.style.display = 'flex';
                            }
                            // Hide start menu
                            const startMenu = document.getElementById('startMenu');
                            if (startMenu && startMenu.classList.contains('show')) {
                                startMenu.style.transform = 'translateY(100%)';
                                startMenu.style.opacity = '0';
                                setTimeout(() => { startMenu.style.display = 'none'; }, 300);
                                startMenu.classList.remove('show');
                                const windowsIcon = document.querySelector('.windows-icon');
                                if (windowsIcon) windowsIcon.classList.remove('active');
                            }
                        });
                    }

                    // Desktop shortcut listeners
                    const notepadShortcut = document.getElementById('shortcut-notepad');
                    const stickyShortcut = document.getElementById('shortcut-sticky');
                    const chromeShortcut = document.getElementById('shortcut-chrome');
                    const pcShortcut = document.getElementById('shortcut-pc');
                    const cmdShortcut = document.getElementById('shortcut-cmd');
                    const vscodeShortcut = document.getElementById('shortcut-vscode');
                    const paintShortcut = document.getElementById('shortcut-paint');

                    
                    if (notepadShortcut) {
                        const openNotepad = () => {
                            WindowManager.createWindow('notepad');
                        };
                        notepadShortcut.addEventListener('dblclick', openNotepad);
                        makeDraggable(notepadShortcut);
                    }

                    
                    if (stickyShortcut) {
                        const openSticky = () => {
                            WindowManager.createWindow('sticky');
                        };
                        stickyShortcut.addEventListener('dblclick', openSticky);
                        makeDraggable(stickyShortcut);
                    }


                    if (chromeShortcut) {
                        const openChrome = () => {
                            const win = document.getElementById('chrome-window');
                            if (win) {
                                win.classList.add('active');
                                win.style.display = 'flex';
                            }
                        };
                        chromeShortcut.addEventListener('dblclick', openChrome);
                        makeDraggable(chromeShortcut);
                    }


                    if (pcShortcut) {
                        const openExplorer = () => {
                            const win = document.getElementById('explorer-window');
                            if (win) {
                                win.classList.add('active');
                                win.style.display = 'flex';
                            }
                        };
                        pcShortcut.addEventListener('dblclick', openExplorer);
                        makeDraggable(pcShortcut);
                    }


                    if (cmdShortcut) {
                        const openCmd = () => {
                            WindowManager.createWindow('cmd');
                        };
                        cmdShortcut.addEventListener('dblclick', openCmd);
                        makeDraggable(cmdShortcut);
                    }


                    if (vscodeShortcut) {
                        const openVSCode = () => {
                            WindowManager.createWindow('vscode');
                        };
                        vscodeShortcut.addEventListener('dblclick', openVSCode);
                        makeDraggable(vscodeShortcut);
                    }

                    if (paintShortcut) {
                        const openPaint = () => {
                            const win = document.getElementById('paint-window');
                            win.classList.add('active');
                            win.style.display = 'flex';
                        };
                        paintShortcut.addEventListener('dblclick', openPaint);
                        makeDraggable(paintShortcut);
                    }

                    // Shortcut Context Menu Logic
                    (function() {
                        const shortcutMenu = document.getElementById('shortcutContextMenu');
                        let currentShortcut = null;

                        // Add context menu to all shortcuts
                        const shortcuts = [notepadShortcut, stickyShortcut, chromeShortcut, pcShortcut, cmdShortcut, vscodeShortcut, paintShortcut];
                        
                        shortcuts.forEach(shortcut => {
                            if (shortcut) {
                                shortcut.addEventListener('contextmenu', function(e) {
                                    e.preventDefault();
                                    e.stopPropagation();
                                    
                                    currentShortcut = shortcut;
                                    
                                    // Position the menu
                                    shortcutMenu.style.left = e.pageX + 'px';
                                    shortcutMenu.style.top = e.pageY + 'px';
                                    shortcutMenu.style.display = 'block';
                                    
                                    // Hide desktop context menu if visible
                                    const desktopMenu = document.getElementById('contextMenu');
                                    if (desktopMenu) {
                                        desktopMenu.style.display = 'none';
                                    }
                                });
                            }
                        });

                        // Handle menu actions
                        document.getElementById('menu-shortcut-open')?.addEventListener('click', function() {
                            if (currentShortcut) {
                                currentShortcut.click();
                            }
                            shortcutMenu.style.display = 'none';
                        });

                        document.getElementById('menu-shortcut-delete')?.addEventListener('click', function() {
                            if (currentShortcut) {
                                currentShortcut.style.display = 'none';
                                const trashIcon = document.getElementById('trash-icon');
                                if (trashIcon) {
                                    trashIcon.src = 'assets/images/recycle-bin-full.png';
                                }
                                deletedItems.push({
                                    name: currentShortcut.querySelector('span').textContent,
                                    img: currentShortcut.querySelector('img').src,
                                    element: currentShortcut
                                });
                                updateTrashUI();
                            }
                            shortcutMenu.style.display = 'none';
                        });

                        document.getElementById('menu-shortcut-rename')?.addEventListener('click', function() {
                            if (currentShortcut) {
                                const span = currentShortcut.querySelector('span');
                                const oldName = span.textContent;
                                const input = document.createElement('input');
                                input.type = 'text';
                                input.value = oldName;
                                input.style.cssText = 'width: 100%; background: rgba(255,255,255,0.9); color: #000; border: 1px solid #0078d7; padding: 2px; font-size: 11px; text-align: center;';
                                
                                span.replaceWith(input);
                                input.focus();
                                input.select();
                                
                                const finishRename = () => {
                                    const newSpan = document.createElement('span');
                                    newSpan.textContent = input.value || oldName;
                                    newSpan.style.cssText = 'font-size: 11px; text-align: center; text-shadow: 1px 1px 2px black; pointer-events: none; width: 100%; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;';
                                    input.replaceWith(newSpan);
                                };
                                
                                input.addEventListener('blur', finishRename);
                                input.addEventListener('keypress', function(e) {
                                    if (e.key === 'Enter') {
                                        finishRename();
                                    }
                                });
                            }
                            shortcutMenu.style.display = 'none';
                        });

                        document.getElementById('menu-shortcut-properties')?.addEventListener('click', function() {
                            if (currentShortcut) {
                                alert('Properties: ' + currentShortcut.querySelector('span').textContent);
                            }
                            shortcutMenu.style.display = 'none';
                        });

                        document.getElementById('menu-shortcut-pin')?.addEventListener('click', function() {
                            if (currentShortcut) {
                                alert('Pinned to taskbar: ' + currentShortcut.querySelector('span').textContent);
                            }
                            shortcutMenu.style.display = 'none';
                        });

                        // Hide menu when clicking elsewhere
                        document.addEventListener('click', function() {
                            shortcutMenu.style.display = 'none';
                        });
                    })();

                    
                    // Chrome Specific Logic (Address bar)
                    (function() {
                        const addressInput = document.getElementById('chrome-address-input');
                        const iframe = document.getElementById('chrome-iframe');
                        
                        if (addressInput && iframe) {
                            addressInput.addEventListener('keypress', function(e) {
                                if (e.key === 'Enter') {
                                    let url = addressInput.value.trim();
                                    if (!url && url === '') return;
                                    if (!url.startsWith('http://') && !url.startsWith('https://')) {
                                        url = 'https://www.google.com/search?q=' + encodeURIComponent(url) + '&igu=1';
                                    }
                                    iframe.src = url;
                                }
                            });
                        }
                        setupApp('chrome-taskbar-icon', 'chrome-window', 'chrome-minimize', 'chrome-maximize', 'chrome-close');
                    })();
                })();

                // Taskbar Icon Drag and Drop Reordering
                (function() {
                    const taskbar = document.querySelector('.taskbar');
                    const appIcons = taskbar.querySelectorAll('.apps-icon');
                    
                    let draggedElement = null;
                    let draggedIndex = -1;
                    
                    appIcons.forEach((icon, index) => {
                        icon.setAttribute('draggable', 'true');
                        icon.style.cursor = 'grab';
                        
                        icon.addEventListener('dragstart', function(e) {
                            draggedElement = this;
                            draggedIndex = Array.from(appIcons).indexOf(this);
                            this.style.opacity = '0.5';
                            this.style.cursor = 'grabbing';
                            e.dataTransfer.effectAllowed = 'move';
                        });
                        
                        icon.addEventListener('dragend', function(e) {
                            this.style.opacity = '1';
                            this.style.cursor = 'grab';
                            draggedElement = null;
                            draggedIndex = -1;
                        });
                        
                        icon.addEventListener('dragover', function(e) {
                            e.preventDefault();
                            e.dataTransfer.dropEffect = 'move';
                            
                            if (draggedElement && draggedElement !== this) {
                                const currentIndex = Array.from(appIcons).indexOf(this);
                                
                                // Visual feedback
                                if (currentIndex > draggedIndex) {
                                    this.style.marginLeft = '5px';
                                } else {
                                    this.style.marginLeft = '-5px';
                                }
                            }
                        });
                        
                        icon.addEventListener('dragleave', function(e) {
                            this.style.marginLeft = '';
                        });
                        
                        icon.addEventListener('drop', function(e) {
                            e.preventDefault();
                            this.style.marginLeft = '';
                            
                            if (draggedElement && draggedElement !== this) {
                                const currentIndex = Array.from(appIcons).indexOf(this);
                                
                                // Swap positions
                                if (draggedIndex < currentIndex) {
                                    this.parentNode.insertBefore(draggedElement, this.nextSibling);
                                } else {
                                    this.parentNode.insertBefore(draggedElement, this);
                                }
                            }
                        });
                    });
                })();

                // Taskbar Icon Context Menu
                (function() {
                    const taskbarIconMenu = document.getElementById('taskbarIconContextMenu');
                    const appIcons = document.querySelectorAll('.apps-icon');
                    let currentTaskbarIcon = null;
                    
                    // Map icon IDs to window IDs
                    const iconWindowMap = {
                        'explorer-taskbar-icon': 'explorer-window',
                        'chrome-taskbar-icon': 'chrome-window',
                        'vscode-taskbar-icon': 'vscode-window',
                        'notepad-taskbar-icon': 'notepad-window',
                        'sticky-taskbar-icon': 'sticky-window'
                    };
                    
                    appIcons.forEach(icon => {
                        icon.addEventListener('contextmenu', function(e) {
                            e.preventDefault();
                            e.stopPropagation();
                            
                            currentTaskbarIcon = this;
                            
                            // Position the menu
                            taskbarIconMenu.style.left = e.pageX + 'px';
                            taskbarIconMenu.style.top = (e.pageY - 80) + 'px'; // Above the taskbar
                            taskbarIconMenu.style.display = 'block';
                            
                            // Hide other menus
                            const desktopMenu = document.getElementById('contextMenu');
                            const shortcutMenu = document.getElementById('shortcutContextMenu');
                            const taskbarMenu = document.getElementById('taskbarContextMenu');
                            if (desktopMenu) desktopMenu.style.display = 'none';
                            if (shortcutMenu) shortcutMenu.style.display = 'none';
                            if (taskbarMenu) taskbarMenu.style.display = 'none';
                        });
                    });
                    
                    // Close window action
                    document.getElementById('menu-taskbar-close')?.addEventListener('click', function() {
                        if (currentTaskbarIcon) {
                            const iconId = currentTaskbarIcon.id;
                            
                            // Handle multiple instance apps
                            const multiInstanceApps = {
                                'vscode-taskbar-icon': 'vscode',
                                'notepad-taskbar-icon': 'notepad',
                                'sticky-taskbar-icon': 'sticky',
                                'cmd-taskbar-icon': 'cmd'
                            };
                            
                            if (multiInstanceApps[iconId]) {
                                const appType = multiInstanceApps[iconId];
                                // Close all instances
                                WindowManager.instances[appType].forEach(inst => {
                                    inst.element.style.opacity = '0';
                                    setTimeout(() => {
                                        inst.element.remove();
                                    }, 200);
                                });
                                WindowManager.instances[appType] = [];
                                WindowManager.updateTaskbarIcon(appType);
                            } else {
                                // Handle single instance apps
                                const windowId = iconWindowMap[iconId];
                                if (windowId) {
                                    const window = document.getElementById(windowId);
                                    if (window) {
                                        window.classList.remove('active');
                                        window.style.display = 'none';
                                    }
                                }
                            }
                        }
                        taskbarIconMenu.style.display = 'none';
                    });
                    
                    // Unpin from taskbar action
                    document.getElementById('menu-taskbar-unpin')?.addEventListener('click', function() {
                        if (currentTaskbarIcon) {
                            // Close associated window first
                            const iconId = currentTaskbarIcon.id;
                            const windowId = iconWindowMap[iconId];
                            
                            if (windowId) {
                                const window = document.getElementById(windowId);
                                if (window) {
                                    window.classList.remove('active');
                                    window.style.display = 'none';
                                }
                            }
                            
                            // Remove icon from taskbar
                            currentTaskbarIcon.style.display = 'none';
                        }
                        taskbarIconMenu.style.display = 'none';
                    });
                    
                    // Hide menu when clicking elsewhere
                    document.addEventListener('click', function() {
                        taskbarIconMenu.style.display = 'none';
                    });
                    
                    // Double Space Spam Sticky Notes Easter Egg
                    (function() {
                        const randomColors = [
                            '#fff7d1', '#d1e7ff', '#d1ffd7', '#ffd1e7', '#e7d1ff', '#ffe7d1',
                            '#ffe4e1', '#f0e68c', '#e0ffff', '#ffe4b5', '#ffdab9', '#ffb6c1',
                            '#ffa07a', '#f08080', '#cd5c5c', '#ff6b6b', '#ff8c94', '#ffa5b0',
                            '#ffcc99', '#ffddaa', '#ffffcc', '#ccffcc', '#ccffff', '#ccccff',
                            '#ffccff', '#e6ccff', '#d4a5a5', '#ffcccb', '#fff5ee', '#faf0e6',
                            '#d3f8e2', '#e4c1f9', '#f694c1', '#ede7b1', '#a9def9', '#ff99c8',
                            '#fcf6bd', '#d0f4de', '#a9def9', '#e4c1f9', '#fec5bb', '#fcd5ce',
                            '#b8e8fc', '#b6e2d3', '#e5eaf5', '#fad2e1', '#bee1e6', '#f1c0e8'
                        ];
                        
                        let lastSpaceTime = 0;
                        const doubleSpaceThreshold = 400; // milliseconds
                        
                        window.addEventListener('keydown', function(e) {
                            // Only trigger if Space is pressed and not typing in input fields
                            const isInInput = e.target.tagName === 'INPUT' || 
                                            e.target.tagName === 'TEXTAREA' || 
                                            e.target.isContentEditable;
                            
                            if (e.key === ' ' && !isInInput) {
                                const currentTime = Date.now();
                                
                                if (currentTime - lastSpaceTime < doubleSpaceThreshold && lastSpaceTime !== 0) {
                                    // Double space detected! Spam sticky notes
                                    e.preventDefault();
                                    console.log('Creating spam sticky notes!');
                                    
                                    // Create 40 random sticky notes
                                    const numNotes = 40;
                                    const maxWidth = window.innerWidth - 320; // 300px sticky width + 20px margin
                                    const maxHeight = window.innerHeight - 380; // 300px sticky height + 80px buffer
                                    
                                    for (let i = 0; i < numNotes; i++) {
                                        setTimeout(() => {
                                            const randomColor = randomColors[Math.floor(Math.random() * randomColors.length)];
                                            
                                            // Create sticky with random position
                                            const randomX = Math.floor(Math.random() * Math.max(10, maxWidth)) + 10;
                                            const randomY = Math.floor(Math.random() * Math.max(50, maxHeight)) + 50;
                                            
                                            // Use WindowManager but override position
                                            const instanceId = `sticky-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
                                            const stickyHTML = WindowManager.createStickyWindow(instanceId, 0, randomColor);
                                            
                                            // Insert and modify position
                                            document.body.insertAdjacentHTML('beforeend', stickyHTML);
                                            const stickyElement = document.getElementById(instanceId);
                                            
                                            if (stickyElement) {
                                                stickyElement.style.left = randomX + 'px';
                                                stickyElement.style.top = randomY + 'px';
                                                stickyElement.style.display = 'flex';
                                                
                                                // Add to WindowManager tracking
                                                WindowManager.instances.sticky.push({
                                                    id: instanceId,
                                                    element: stickyElement,
                                                    isMinimized: false,
                                                    isMaximized: false
                                                });
                                                
                                                // Setup controls
                                                WindowManager.setupWindowControls(instanceId, 'sticky');
                                                
                                                // Show with fade-in
                                                setTimeout(() => {
                                                    stickyElement.style.opacity = '1';
                                                }, 10);
                                                
                                                // Make draggable
                                                if (typeof makeWindowDraggable === 'function') {
                                                    makeWindowDraggable(stickyElement);
                                                }
                                            }
                                        }, i * 30); // Stagger creation by 30ms each
                                    }
                                    
                                    // Update taskbar icon after all notes created
                                    setTimeout(() => {
                                        WindowManager.updateTaskbarIcon('sticky');
                                    }, numNotes * 30 + 100);
                                    
                                    lastSpaceTime = 0; // Reset
                                } else {
                                    lastSpaceTime = currentTime;
                                }
                            }
                        });
                    })();
                })();
            </script>
</body>

</html>
